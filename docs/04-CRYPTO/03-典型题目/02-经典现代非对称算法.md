# 经典现代非对称算法

算法原理：mod 运算是不可逆的，或者说很难逆转

## RSA加密算法

算法原理：

```
1.生成一对质数p、q，计算n = p * q
2.计算n的欧拉函数 φ(n) = (p-1) * (q-1)，记作m
3.找到一个数字e，与m互质
4.计算e在mod m域上的逆元，记为d
5.(n,e)为公钥，(n,d)为私钥
```

加密： 密文=明文^e mod n

解密： 明文=密文^e mod n

## DH算法

Diffie - Hellman 密钥交换协议，是一个不安全的秘钥共享网络协议，无法避免中间人攻击。

算法原理：假设Ali和Bob需要相互通信并共享密钥

```
1.Ali和Bob有一对共享参数P、G（公钥），此信息可以被任何人识别。
2.Ali自己先生成一个随机数A（Ali的私钥），并不将A告诉任何人。
3.Bob自己先生成一个随机数B（Bob的私钥），并不将B告诉任何人。
4.Ali计算 $G^A mod P$ 的值传递给Bob，Bob计算 G^B mod P 的值传递给Ali
5.Ali将Bob传递的值 ^A mod P ，Bob将Ali传递的值 ^B mod P，此时二人获得的数字都为 S=G^{A*B} mod P
6.二者可以利用S对一串明文进行加密
```

## DHE算法

static DH算法（已经被废弃）：通讯的双方中，一方的私钥是静态的，每次密钥协商的时候有一方的私钥都有一样的，一般是服务器方固定，a不变，客户端的私钥随机生成。

hacker可以截获海量密钥协商过程中的数据，容纳后计算出会话密钥，进而之前截获的加密数据会被破解

DHE算法（现在常用的）：E指ephemeral（临时性的），每次服务器的私钥也是随机生成；缺点是算法计算性能不佳，需要进行大量乘法运算

## ECC算法

椭圆曲线基本公式： y^2=x^3+ax+b

加法运算：取两个点A和点B确定一条直线（如果相切，则A=B，取切线），相交曲线于第三点，关于x轴的对称点为点C，称为一次椭圆曲线上的加法运算

```
1.Alice生成一个私钥a和一个公钥G，计算得到公钥 A= a · G，表示G这个点进行运算a次
2.Bob接收公钥，得到G、A，生成一个私钥b，计算得到公钥 B= b · G
3.最终密钥=a · B=b · A = a · b · G
```

## ECDHE算法（unfixed）

在DHE算法的基础上利用了ECC椭圆曲线特性，可以用更少的计算量计算出公钥及其最终会话的密钥

1.Ali和Bob事先商量好用哪种椭圆曲线(a,b)及其曲线上的基点(G),这两个参数都是公开的
2.Ali和Bob各自随机生成一个随机数作为私钥d，令基点G进行d次运算得到点Q，此时Ali的公钥为Q1，Bob的公钥为Q2
3.待补充

## 习题

[攻防世界]easy_ECC

```txt
已知椭圆曲线加密Ep(a,b)参数为
p = 15424654874903
a = 16546484
b = 4548674875
G(6478678675,5636379357093)
私钥为
k = 546768
求公钥K(x,y)
10951795347874930624
```

使用离线工具即可

![](asserts\image-20231028235024343.png)

再计算Rx和Ry的加和即为flag

![](asserts\image-20231028235205511.png)