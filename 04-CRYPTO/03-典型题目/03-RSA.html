
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="NISA Wiki 是 NISA 的知识库，旨在总结网络安全领域的知识和经验。">
      
      
        <meta name="author" content="NISA">
      
      
        <link rel="canonical" href="https://wiki.fjnusec.cn/04-CRYPTO/03-%E5%85%B8%E5%9E%8B%E9%A2%98%E7%9B%AE/03-RSA.html">
      
      
        <link rel="prev" href="02-%E7%BB%8F%E5%85%B8%E7%8E%B0%E4%BB%A3%E9%9D%9E%E5%AF%B9%E7%A7%B0%E7%AE%97%E6%B3%95.html">
      
      
        <link rel="next" href="../../05-RE/index.html">
      
      
      <link rel="icon" href="../../assets/NISA_LOGO.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>RSA - NISA Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
        <script src="https://unpkg.com/iframe-worker/shim"></script>
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#rsa" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="https://www.fjnusec.cn/" title="NISA Wiki" class="md-header__button md-logo" aria-label="NISA Wiki" data-md-component="logo">
      
  <img src="../../assets/NISA_LOGO.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NISA Wiki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              RSA
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="关闭切换亮暗模式"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="关闭切换亮暗模式" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="切换到暗黑模式"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="切换到暗黑模式" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 2c-1.05 0-2.05.16-3 .46 4.06 1.27 7 5.04 7 9.54s-2.94 8.27-7 9.54c.95.3 1.95.46 3 .46a10 10 0 0 0 10-10A10 10 0 0 0 9 2"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="切换到亮色模式"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="切换到亮色模式" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-2.69L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/FJNU-NISA/NISA-Wiki" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    FJNU-NISA/NISA-Wiki
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../index.html" class="md-tabs__link">
        
  
  
    
  
  00 简介

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../01-QUICK%20START/index.html" class="md-tabs__link">
          
  
  
    
  
  01 QUICK START

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../02-WEB/index.html" class="md-tabs__link">
          
  
  
    
  
  02 WEB

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../03-MISC/index.html" class="md-tabs__link">
          
  
  
    
  
  03 MISC

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../index.html" class="md-tabs__link">
          
  
  
    
  
  04 CRYPTO

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../05-RE/index.html" class="md-tabs__link">
          
  
  
    
  
  05 RE

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../06-PWN/index.html" class="md-tabs__link">
          
  
  
    
  
  06 PWN

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../07-%E6%B8%97%E9%80%8F/index.html" class="md-tabs__link">
          
  
  
    
  
  07 渗透

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../08-SRC/index.html" class="md-tabs__link">
          
  
  
    
  
  08 SRC

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../09-%E8%BF%90%E7%BB%B4/index.html" class="md-tabs__link">
          
  
  
    
  
  09 运维

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../10-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/index.html" class="md-tabs__link">
          
  
  
    
  
  10 应急响应

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../11-IOT/index.html" class="md-tabs__link">
          
  
  
    
  
  11 IOT

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../12-FORENSIC/index.html" class="md-tabs__link">
          
  
  
    
  
  12 FORENSIC

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../13-%E5%8C%BA%E5%9D%97%E9%93%BE/index.html" class="md-tabs__link">
          
  
  
    
  
  13 区块链

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://www.fjnusec.cn/" title="NISA Wiki" class="md-nav__button md-logo" aria-label="NISA Wiki" data-md-component="logo">
      
  <img src="../../assets/NISA_LOGO.svg" alt="logo">

    </a>
    NISA Wiki
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/FJNU-NISA/NISA-Wiki" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    FJNU-NISA/NISA-Wiki
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    00 简介
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../01-QUICK%20START/index.html" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    01 QUICK START
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../02-WEB/index.html" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    02 WEB
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../03-MISC/index.html" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    03 MISC
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    04 CRYPTO
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            04 CRYPTO
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../00-%E6%B5%8B%E8%AF%95%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    00 测试基本功能
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_2" id="__nav_5_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            00 测试基本功能
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../00-%E6%B5%8B%E8%AF%95%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD/%E6%B5%8B%E8%AF%95%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD/01-%E6%B5%8B%E8%AF%95markdown%E5%8A%9F%E8%83%BD.html" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    测试基本功能
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../01-%E5%AF%86%E7%A0%81%E5%AD%A6%E5%A4%A7%E8%87%B4%E5%AD%A6%E4%BA%9B%E4%BB%80%E4%B9%88/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    01 密码学大致学些什么
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_3" id="__nav_5_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            01 密码学大致学些什么
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-%E5%AF%86%E7%A0%81%E5%AD%A6%E5%A4%A7%E8%87%B4%E5%AD%A6%E4%BA%9B%E4%BB%80%E4%B9%88/01-%E5%AF%86%E7%A0%81%E5%AD%A6%E9%80%9A%E7%94%A8%E5%9F%BA%E7%A1%80.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    密码学通用基础
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-%E5%AF%86%E7%A0%81%E5%AD%A6%E5%A4%A7%E8%87%B4%E5%AD%A6%E4%BA%9B%E4%BB%80%E4%B9%88/02-CTF%E4%B8%AD%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CTF中的密码学
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-%E5%AF%86%E7%A0%81%E5%AD%A6%E5%A4%A7%E8%87%B4%E5%AD%A6%E4%BA%9B%E4%BB%80%E4%B9%88/03-%E5%AF%86%E7%A0%81%E5%AD%A6%E7%A7%91%E7%A0%94%E6%96%B9%E5%90%91.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    密码学科研方向
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../02-SageMath%E7%AE%80%E8%A6%81%E6%95%99%E7%A8%8B/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    02 SageMath简要教程
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_4" id="__nav_5_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            02 SageMath简要教程
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-SageMath%E7%AE%80%E8%A6%81%E6%95%99%E7%A8%8B/01-%E9%AB%98%E7%89%88%E6%9C%ACSageMath%E5%AE%89%E8%A3%85%E4%BB%A5%E5%8F%8Aflatter%E9%85%8D%E7%BD%AE.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    高版本SageMath安装以及flatter配置
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-SageMath%E7%AE%80%E8%A6%81%E6%95%99%E7%A8%8B/02-SageMath%E7%AE%80%E4%BB%8B.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SageMath简介
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_5" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    03 典型题目
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_5" id="__nav_5_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            03 典型题目
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="01-%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    古典密码
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="02-%E7%BB%8F%E5%85%B8%E7%8E%B0%E4%BB%A3%E9%9D%9E%E5%AF%B9%E7%A7%B0%E7%AE%97%E6%B3%95.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    经典现代非对称算法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    RSA
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="03-RSA.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    RSA
    
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      一些简单题目，来热热身
    </span>
  </a>
  
    <nav class="md-nav" aria-label="一些简单题目，来热热身">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#n" class="md-nav__link">
    <span class="md-ellipsis">
      暴力破解n
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#baby_rsa" class="md-nav__link">
    <span class="md-ellipsis">
      Baby_RSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crt_rsa" class="md-nav__link">
    <span class="md-ellipsis">
      Crt_RSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#embryorsa" class="md-nav__link">
    <span class="md-ellipsis">
      EmbryoRSA
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#buuctf-rsa" class="md-nav__link">
    <span class="md-ellipsis">
      BUUCTF题库-RSA
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BUUCTF题库-RSA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rsarsa-p-q-e-cm" class="md-nav__link">
    <span class="md-ellipsis">
      rsarsa 已知p q e c，求m
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsa-p-q-e-d" class="md-nav__link">
    <span class="md-ellipsis">
      RSA 已知p q e ，求d
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsa1-dpdq" class="md-nav__link">
    <span class="md-ellipsis">
      RSA1 已知dp,dq
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsa2-dp" class="md-nav__link">
    <span class="md-ellipsis">
      RSA2 dp泄露
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsa3" class="md-nav__link">
    <span class="md-ellipsis">
      RSA3 共膜攻击
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsa_1" class="md-nav__link">
    <span class="md-ellipsis">
      RSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsaroll" class="md-nav__link">
    <span class="md-ellipsis">
      rsaroll
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dangerous-rsa" class="md-nav__link">
    <span class="md-ellipsis">
      Dangerous RSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsa2" class="md-nav__link">
    <span class="md-ellipsis">
      rsa2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rsa_2" class="md-nav__link">
    <span class="md-ellipsis">
      一些比赛中的 RSA 相关题目
    </span>
  </a>
  
    <nav class="md-nav" aria-label="一些比赛中的 RSA 相关题目">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#guet-ctf2019babyrsa" class="md-nav__link">
    <span class="md-ellipsis">
      [GUET-CTF2019]BabyRSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buuctfafctf2018rsa" class="md-nav__link">
    <span class="md-ellipsis">
      [BUUCTF·AFCTF2018]可怜的RSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ctfshownoeasyrsa" class="md-nav__link">
    <span class="md-ellipsis">
      [CTFshow元旦水友赛]NOeasyRSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ctfshownoeasyrsa_1" class="md-nav__link">
    <span class="md-ellipsis">
      [CTFshow元旦水友赛]NOeasyRSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ctfshow" class="md-nav__link">
    <span class="md-ellipsis">
      [CTFshow元旦水友赛]哪位师傅知道这个是什么密码啊？
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buuctfgwctf2019babyrsa" class="md-nav__link">
    <span class="md-ellipsis">
      [BUUCTF·GWCTF2019]BabyRSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nssctf-round16-basicpr" class="md-nav__link">
    <span class="md-ellipsis">
      [NSSCTF Round#16 Basic]pr
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isctf2023" class="md-nav__link">
    <span class="md-ellipsis">
      [isctf2023]七七的欧拉
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isctf2023signin" class="md-nav__link">
    <span class="md-ellipsis">
      [isctf2023]signin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isctf2023easy_aes" class="md-nav__link">
    <span class="md-ellipsis">
      [isctf2023]Easy_AES
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nssctf-round16-basicbreak" class="md-nav__link">
    <span class="md-ellipsis">
      [NSSCTF Round#16 Basic]break
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buuctfnctf2019babyrsa" class="md-nav__link">
    <span class="md-ellipsis">
      [BUUCTF·NCTF2019]babyRSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buuctfafctf2018" class="md-nav__link">
    <span class="md-ellipsis">
      [BUUCTF·AFCTF2018]你能看出这是什么加密么
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buuctfroarctf2019rsa" class="md-nav__link">
    <span class="md-ellipsis">
      [BUUCTF·RoarCTF2019]RSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buuctfroarctf2019babyrsa" class="md-nav__link">
    <span class="md-ellipsis">
      [BUUCTF·RoarCTF2019]babyRSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buuctfbjdctf2020rsa_output" class="md-nav__link">
    <span class="md-ellipsis">
      [BUUCTF·BJDCTF2020]rsa_output
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buuctfsamemod" class="md-nav__link">
    <span class="md-ellipsis">
      [BUUCTF]SameMod
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buuctfbjdctf2020easyrsa" class="md-nav__link">
    <span class="md-ellipsis">
      [BUUCTF·BJDCTF2020]easyrsa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wieners-attack" class="md-nav__link">
    <span class="md-ellipsis">
      维纳攻击（Wiener's Attack）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#legendre" class="md-nav__link">
    <span class="md-ellipsis">
      Legendre理论
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easy_aes" class="md-nav__link">
    <span class="md-ellipsis">
      Easy_AES
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isctf20231zrsa" class="md-nav__link">
    <span class="md-ellipsis">
      [ISCTF2023]1zRSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polarctf2023basecrypto" class="md-nav__link">
    <span class="md-ellipsis">
      [PolarCTF网络安全2023冬季]base（CRYPTO）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nctf2019childrsa" class="md-nav__link">
    <span class="md-ellipsis">
      [NCTF2019]childRSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hdctf2019bbbbbbrsa" class="md-nav__link">
    <span class="md-ellipsis">
      [HDCTF2019]bbbbbbrsa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsa4" class="md-nav__link">
    <span class="md-ellipsis">
      RSA4
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsa4_1" class="md-nav__link">
    <span class="md-ellipsis">
      RSA4
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bjdctf2020rsa" class="md-nav__link">
    <span class="md-ellipsis">
      [BJDCTF2020]RSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hdctf2019basic-rsa" class="md-nav__link">
    <span class="md-ellipsis">
      [HDCTF2019]basic rsa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buuctfrsa5" class="md-nav__link">
    <span class="md-ellipsis">
      [BUUCTF]RSA5
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2020-you_raise_me_up" class="md-nav__link">
    <span class="md-ellipsis">
      [网鼎杯 2020 青龙组]you_raise_me_up
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wustctf2020" class="md-nav__link">
    <span class="md-ellipsis">
      [WUSTCTF2020]大数计算
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#npuctf2020ezrsa" class="md-nav__link">
    <span class="md-ellipsis">
      [NPUCTF2020]EzRSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wustctf2020dp_leaking_1s_very_dangerous" class="md-nav__link">
    <span class="md-ellipsis">
      [WUSTCTF2020]dp_leaking_1s_very_d@angerous
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inshack2017rsa16m" class="md-nav__link">
    <span class="md-ellipsis">
      [INSHack2017]rsa16m
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsa-what" class="md-nav__link">
    <span class="md-ellipsis">
      RSA &amp; what
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#actf2020crypto-aes" class="md-nav__link">
    <span class="md-ellipsis">
      [ACTF新生赛2020]crypto-aes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inshack2019yet-another-rsa-challenge-part-1" class="md-nav__link">
    <span class="md-ellipsis">
      [INSHack2019]Yet Another RSA Challenge - Part 1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#npuctf2020" class="md-nav__link">
    <span class="md-ellipsis">
      [NPUCTF2020]认清形势，建立信心
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mrctf2020babyrsa" class="md-nav__link">
    <span class="md-ellipsis">
      [MRCTF2020]babyRSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mrctf2020easy_rsa" class="md-nav__link">
    <span class="md-ellipsis">
      [MRCTF2020]Easy_RSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#npuctf2020_1" class="md-nav__link">
    <span class="md-ellipsis">
      [NPUCTF2020]共 模 攻 击
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xnuca2018warmup" class="md-nav__link">
    <span class="md-ellipsis">
      [XNUCA2018]Warmup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#afctf2018" class="md-nav__link">
    <span class="md-ellipsis">
      [#AFCTF2018]花开藏宝地
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsa-what_1" class="md-nav__link">
    <span class="md-ellipsis">
      RSA &amp; what
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../05-RE/index.html" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    05 RE
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../06-PWN/index.html" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    06 PWN
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../07-%E6%B8%97%E9%80%8F/index.html" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    07 渗透
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../08-SRC/index.html" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    08 SRC
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../09-%E8%BF%90%E7%BB%B4/index.html" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    09 运维
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../10-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/index.html" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    10 应急响应
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../11-IOT/index.html" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    11 IOT
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../12-FORENSIC/index.html" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    12 FORENSIC
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../13-%E5%8C%BA%E5%9D%97%E9%93%BE/index.html" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    13 区块链
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      一些简单题目，来热热身
    </span>
  </a>
  
    <nav class="md-nav" aria-label="一些简单题目，来热热身">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#n" class="md-nav__link">
    <span class="md-ellipsis">
      暴力破解n
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#baby_rsa" class="md-nav__link">
    <span class="md-ellipsis">
      Baby_RSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crt_rsa" class="md-nav__link">
    <span class="md-ellipsis">
      Crt_RSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#embryorsa" class="md-nav__link">
    <span class="md-ellipsis">
      EmbryoRSA
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#buuctf-rsa" class="md-nav__link">
    <span class="md-ellipsis">
      BUUCTF题库-RSA
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BUUCTF题库-RSA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rsarsa-p-q-e-cm" class="md-nav__link">
    <span class="md-ellipsis">
      rsarsa 已知p q e c，求m
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsa-p-q-e-d" class="md-nav__link">
    <span class="md-ellipsis">
      RSA 已知p q e ，求d
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsa1-dpdq" class="md-nav__link">
    <span class="md-ellipsis">
      RSA1 已知dp,dq
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsa2-dp" class="md-nav__link">
    <span class="md-ellipsis">
      RSA2 dp泄露
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsa3" class="md-nav__link">
    <span class="md-ellipsis">
      RSA3 共膜攻击
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsa_1" class="md-nav__link">
    <span class="md-ellipsis">
      RSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsaroll" class="md-nav__link">
    <span class="md-ellipsis">
      rsaroll
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dangerous-rsa" class="md-nav__link">
    <span class="md-ellipsis">
      Dangerous RSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsa2" class="md-nav__link">
    <span class="md-ellipsis">
      rsa2
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rsa_2" class="md-nav__link">
    <span class="md-ellipsis">
      一些比赛中的 RSA 相关题目
    </span>
  </a>
  
    <nav class="md-nav" aria-label="一些比赛中的 RSA 相关题目">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#guet-ctf2019babyrsa" class="md-nav__link">
    <span class="md-ellipsis">
      [GUET-CTF2019]BabyRSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buuctfafctf2018rsa" class="md-nav__link">
    <span class="md-ellipsis">
      [BUUCTF·AFCTF2018]可怜的RSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ctfshownoeasyrsa" class="md-nav__link">
    <span class="md-ellipsis">
      [CTFshow元旦水友赛]NOeasyRSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ctfshownoeasyrsa_1" class="md-nav__link">
    <span class="md-ellipsis">
      [CTFshow元旦水友赛]NOeasyRSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ctfshow" class="md-nav__link">
    <span class="md-ellipsis">
      [CTFshow元旦水友赛]哪位师傅知道这个是什么密码啊？
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buuctfgwctf2019babyrsa" class="md-nav__link">
    <span class="md-ellipsis">
      [BUUCTF·GWCTF2019]BabyRSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nssctf-round16-basicpr" class="md-nav__link">
    <span class="md-ellipsis">
      [NSSCTF Round#16 Basic]pr
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isctf2023" class="md-nav__link">
    <span class="md-ellipsis">
      [isctf2023]七七的欧拉
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isctf2023signin" class="md-nav__link">
    <span class="md-ellipsis">
      [isctf2023]signin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isctf2023easy_aes" class="md-nav__link">
    <span class="md-ellipsis">
      [isctf2023]Easy_AES
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nssctf-round16-basicbreak" class="md-nav__link">
    <span class="md-ellipsis">
      [NSSCTF Round#16 Basic]break
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buuctfnctf2019babyrsa" class="md-nav__link">
    <span class="md-ellipsis">
      [BUUCTF·NCTF2019]babyRSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buuctfafctf2018" class="md-nav__link">
    <span class="md-ellipsis">
      [BUUCTF·AFCTF2018]你能看出这是什么加密么
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buuctfroarctf2019rsa" class="md-nav__link">
    <span class="md-ellipsis">
      [BUUCTF·RoarCTF2019]RSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buuctfroarctf2019babyrsa" class="md-nav__link">
    <span class="md-ellipsis">
      [BUUCTF·RoarCTF2019]babyRSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buuctfbjdctf2020rsa_output" class="md-nav__link">
    <span class="md-ellipsis">
      [BUUCTF·BJDCTF2020]rsa_output
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buuctfsamemod" class="md-nav__link">
    <span class="md-ellipsis">
      [BUUCTF]SameMod
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buuctfbjdctf2020easyrsa" class="md-nav__link">
    <span class="md-ellipsis">
      [BUUCTF·BJDCTF2020]easyrsa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wieners-attack" class="md-nav__link">
    <span class="md-ellipsis">
      维纳攻击（Wiener's Attack）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#legendre" class="md-nav__link">
    <span class="md-ellipsis">
      Legendre理论
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easy_aes" class="md-nav__link">
    <span class="md-ellipsis">
      Easy_AES
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isctf20231zrsa" class="md-nav__link">
    <span class="md-ellipsis">
      [ISCTF2023]1zRSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#polarctf2023basecrypto" class="md-nav__link">
    <span class="md-ellipsis">
      [PolarCTF网络安全2023冬季]base（CRYPTO）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nctf2019childrsa" class="md-nav__link">
    <span class="md-ellipsis">
      [NCTF2019]childRSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hdctf2019bbbbbbrsa" class="md-nav__link">
    <span class="md-ellipsis">
      [HDCTF2019]bbbbbbrsa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsa4" class="md-nav__link">
    <span class="md-ellipsis">
      RSA4
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsa4_1" class="md-nav__link">
    <span class="md-ellipsis">
      RSA4
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bjdctf2020rsa" class="md-nav__link">
    <span class="md-ellipsis">
      [BJDCTF2020]RSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hdctf2019basic-rsa" class="md-nav__link">
    <span class="md-ellipsis">
      [HDCTF2019]basic rsa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#buuctfrsa5" class="md-nav__link">
    <span class="md-ellipsis">
      [BUUCTF]RSA5
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2020-you_raise_me_up" class="md-nav__link">
    <span class="md-ellipsis">
      [网鼎杯 2020 青龙组]you_raise_me_up
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wustctf2020" class="md-nav__link">
    <span class="md-ellipsis">
      [WUSTCTF2020]大数计算
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#npuctf2020ezrsa" class="md-nav__link">
    <span class="md-ellipsis">
      [NPUCTF2020]EzRSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wustctf2020dp_leaking_1s_very_dangerous" class="md-nav__link">
    <span class="md-ellipsis">
      [WUSTCTF2020]dp_leaking_1s_very_d@angerous
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inshack2017rsa16m" class="md-nav__link">
    <span class="md-ellipsis">
      [INSHack2017]rsa16m
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsa-what" class="md-nav__link">
    <span class="md-ellipsis">
      RSA &amp; what
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#actf2020crypto-aes" class="md-nav__link">
    <span class="md-ellipsis">
      [ACTF新生赛2020]crypto-aes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inshack2019yet-another-rsa-challenge-part-1" class="md-nav__link">
    <span class="md-ellipsis">
      [INSHack2019]Yet Another RSA Challenge - Part 1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#npuctf2020" class="md-nav__link">
    <span class="md-ellipsis">
      [NPUCTF2020]认清形势，建立信心
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mrctf2020babyrsa" class="md-nav__link">
    <span class="md-ellipsis">
      [MRCTF2020]babyRSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mrctf2020easy_rsa" class="md-nav__link">
    <span class="md-ellipsis">
      [MRCTF2020]Easy_RSA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#npuctf2020_1" class="md-nav__link">
    <span class="md-ellipsis">
      [NPUCTF2020]共 模 攻 击
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xnuca2018warmup" class="md-nav__link">
    <span class="md-ellipsis">
      [XNUCA2018]Warmup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#afctf2018" class="md-nav__link">
    <span class="md-ellipsis">
      [#AFCTF2018]花开藏宝地
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rsa-what_1" class="md-nav__link">
    <span class="md-ellipsis">
      RSA &amp; what
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="rsa">RSA<a class="headerlink" href="#rsa" title="Permanent link">&para;</a></h1>
<p>（部分内容未分类完全，但基本可供阅读学习）</p>
<h2 id="_1">一些简单题目，来热热身<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<h3 id="n">暴力破解n<a class="headerlink" href="#n" title="Permanent link">&para;</a></h3>
<p>1.使用 <a href="http://www.factordb.com/index.php">在线工具</a>分解大质数</p>
<p>2.使用拓欧得到私钥d</p>
<div class="language-py highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos="1 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">exgcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos="2 "></span></a>    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><a href="#__codelineno-0-3"><span class="linenos" data-linenos="3 "></span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><a href="#__codelineno-0-4"><span class="linenos" data-linenos="4 "></span></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><a href="#__codelineno-0-5"><span class="linenos" data-linenos="5 "></span></a>        <span class="n">gcd</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ex</span><span class="p">(</span><span class="n">b</span> <span class="o">%</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><a href="#__codelineno-0-6"><span class="linenos" data-linenos="6 "></span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">gcd</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span> <span class="o">//</span> <span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</code></pre></div>
<p>3.计算flag bytes_to_long后的变量m</p>
<div class="language-py highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><a href="#__codelineno-1-1"><span class="linenos" data-linenos="1 "></span></a><span class="n">m</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span> <span class="n">c</span> <span class="p">,</span> <span class="n">d</span> <span class="p">,</span> <span class="n">n</span> <span class="p">)</span>
</code></pre></div>
<p>4.将整数m转化为字符串flag</p>
<div class="language-py highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><a href="#__codelineno-2-1"><span class="linenos" data-linenos="1 "></span></a><span class="n">m</span> <span class="o">=</span> <span class="mi">11604008605541818712966720001582142618375831382642459409129147724359509689501272522137152998605953387230762300554700585488547840790592562824581160993059033</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a><a href="#__codelineno-2-2"><span class="linenos" data-linenos="2 "></span></a>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a><a href="#__codelineno-2-3"><span class="linenos" data-linenos="3 "></span></a><span class="c1"># 将整数转化为字节串</span>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a><a href="#__codelineno-2-4"><span class="linenos" data-linenos="4 "></span></a><span class="n">flag</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">((</span><span class="n">m</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span> <span class="o">//</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;big&#39;</span><span class="p">)</span>
<a id="__codelineno-2-5" name="__codelineno-2-5"></a><a href="#__codelineno-2-5"><span class="linenos" data-linenos="5 "></span></a>
<a id="__codelineno-2-6" name="__codelineno-2-6"></a><a href="#__codelineno-2-6"><span class="linenos" data-linenos="6 "></span></a><span class="c1"># 输出字节串</span>
<a id="__codelineno-2-7" name="__codelineno-2-7"></a><a href="#__codelineno-2-7"><span class="linenos" data-linenos="7 "></span></a><span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</code></pre></div>
<h3 id="baby_rsa">Baby_RSA<a class="headerlink" href="#baby_rsa" title="Permanent link">&para;</a></h3>
<p>因为 c = ( m ^ e ) % n</p>
<p>所以 c = ( m ^ e ) - k * n , 其中 k∈ N*</p>
<p>题目已知 c , e , n，求m；且 c 和 n 都是比较大的数，相对接近。</p>
<p>故可以枚举 k 的值，得到m的值</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><a href="#__codelineno-3-1"><span class="linenos" data-linenos=" 1 "></span></a>def solve( c , e , n ):
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><a href="#__codelineno-3-2"><span class="linenos" data-linenos=" 2 "></span></a>    k = 0
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><a href="#__codelineno-3-3"><span class="linenos" data-linenos=" 3 "></span></a>    while 1:
<a id="__codelineno-3-4" name="__codelineno-3-4"></a><a href="#__codelineno-3-4"><span class="linenos" data-linenos=" 4 "></span></a>        m = c + k * n
<a id="__codelineno-3-5" name="__codelineno-3-5"></a><a href="#__codelineno-3-5"><span class="linenos" data-linenos=" 5 "></span></a>        result , check = gmpy2.iroot(m, e)#求大整数x开n次根,result是返回的结果，check来判断是否正常返回
<a id="__codelineno-3-6" name="__codelineno-3-6"></a><a href="#__codelineno-3-6"><span class="linenos" data-linenos=" 6 "></span></a>        if check == 1:
<a id="__codelineno-3-7" name="__codelineno-3-7"></a><a href="#__codelineno-3-7"><span class="linenos" data-linenos=" 7 "></span></a>            return check
<a id="__codelineno-3-8" name="__codelineno-3-8"></a><a href="#__codelineno-3-8"><span class="linenos" data-linenos=" 8 "></span></a>        k += 1
<a id="__codelineno-3-9" name="__codelineno-3-9"></a><a href="#__codelineno-3-9"><span class="linenos" data-linenos=" 9 "></span></a>m = solve( c , e , n )
<a id="__codelineno-3-10" name="__codelineno-3-10"></a><a href="#__codelineno-3-10"><span class="linenos" data-linenos="10 "></span></a>print(long_to_bytes(m))
</code></pre></div>
<h3 id="crt_rsa">Crt_RSA<a class="headerlink" href="#crt_rsa" title="Permanent link">&para;</a></h3>
<p>n是两个大质数的乘积，因为数太大而导致解密缓慢</p>
<p>使用中国剩余定理可以帮助优化解密过程，将<code>模幂运算</code>分解为<code>对不同模数的模幂运算</code>，从而降低复杂度</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><a href="#__codelineno-4-1"><span class="linenos" data-linenos="1 "></span></a>e = 3
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><a href="#__codelineno-4-2"><span class="linenos" data-linenos="2 "></span></a>n = [n1,n2,n3]
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><a href="#__codelineno-4-3"><span class="linenos" data-linenos="3 "></span></a>c = [c1,c2,c3]
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><a href="#__codelineno-4-4"><span class="linenos" data-linenos="4 "></span></a>M, mod = crt(n, c)#M是CRT的结果，即合并多个RSA模数后得到的结果
<a id="__codelineno-4-5" name="__codelineno-4-5"></a><a href="#__codelineno-4-5"><span class="linenos" data-linenos="5 "></span></a>m, check = gmpy2.iroot(M, e)
<a id="__codelineno-4-6" name="__codelineno-4-6"></a><a href="#__codelineno-4-6"><span class="linenos" data-linenos="6 "></span></a>print(long_to_bytes(m))
</code></pre></div>
<h3 id="embryorsa">EmbryoRSA<a class="headerlink" href="#embryorsa" title="Permanent link">&para;</a></h3>
<p>1.计算n和φ(n)</p>
<div class="language-py highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><a href="#__codelineno-5-1"><span class="linenos" data-linenos="1 "></span></a><span class="n">n</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><a href="#__codelineno-5-2"><span class="linenos" data-linenos="2 "></span></a><span class="n">pn</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<p>2.使用扩展欧几里德算法找到d</p>
<div class="language-py highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><a href="#__codelineno-6-1"><span class="linenos" data-linenos="1 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">extended_gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><a href="#__codelineno-6-2"><span class="linenos" data-linenos="2 "></span></a>    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><a href="#__codelineno-6-3"><span class="linenos" data-linenos="3 "></span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><a href="#__codelineno-6-4"><span class="linenos" data-linenos="4 "></span></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a><a href="#__codelineno-6-5"><span class="linenos" data-linenos="5 "></span></a>        <span class="n">gcd</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">extended_gcd</span><span class="p">(</span><span class="n">b</span> <span class="o">%</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<a id="__codelineno-6-6" name="__codelineno-6-6"></a><a href="#__codelineno-6-6"><span class="linenos" data-linenos="6 "></span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">gcd</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span> <span class="o">//</span> <span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</code></pre></div>
<p>3.得到私钥d</p>
<div class="language-py highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><a href="#__codelineno-7-1"><span class="linenos" data-linenos="1 "></span></a><span class="n">gcd</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">extended_gcd</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">phi_n</span><span class="p">)</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a><a href="#__codelineno-7-2"><span class="linenos" data-linenos="2 "></span></a><span class="n">d</span> <span class="o">=</span> <span class="n">x</span> <span class="o">%</span> <span class="n">pn</span>
</code></pre></div>
<p>4.得到flag</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a><a href="#__codelineno-8-1"><span class="linenos" data-linenos="1 "></span></a>m = pow( c , d , n )
<a id="__codelineno-8-2" name="__codelineno-8-2"></a><a href="#__codelineno-8-2"><span class="linenos" data-linenos="2 "></span></a>print( ans )
<a id="__codelineno-8-3" name="__codelineno-8-3"></a><a href="#__codelineno-8-3"><span class="linenos" data-linenos="3 "></span></a>flag = m.to_bytes((m.bit_length() + 7) // 8, &#39;big&#39;)
<a id="__codelineno-8-4" name="__codelineno-8-4"></a><a href="#__codelineno-8-4"><span class="linenos" data-linenos="4 "></span></a>print(flag)
</code></pre></div>
<p>RSA算法</p>
<p>生成秘钥</p>
<p>1.准备两个大质数p和q，将他们相乘得到n=pq</p>
<p>2.m=φ(n)=(p-1)(q-1)
3.找一个数e满足 gcd(m,e) = 1
4.ed mod m = 1（计算e在mod m下的逆元，记为d）
5.(n,e)为公钥，(n,d)为私钥</p>
<p>RSA秘钥生成代码</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><a href="#__codelineno-9-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="n">p</span> <span class="o">=</span> <span class="mi">1000000007</span>
<a id="__codelineno-9-2" name="__codelineno-9-2"></a><a href="#__codelineno-9-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="n">q</span> <span class="o">=</span> <span class="mi">1000000009</span>
<a id="__codelineno-9-3" name="__codelineno-9-3"></a><a href="#__codelineno-9-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="n">e</span> <span class="o">=</span> <span class="mi">65521</span>
<a id="__codelineno-9-4" name="__codelineno-9-4"></a><a href="#__codelineno-9-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="n">n</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>
<a id="__codelineno-9-5" name="__codelineno-9-5"></a><a href="#__codelineno-9-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-9-6" name="__codelineno-9-6"></a><a href="#__codelineno-9-6"><span class="linenos" data-linenos=" 6 "></span></a>
<a id="__codelineno-9-7" name="__codelineno-9-7"></a><a href="#__codelineno-9-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">extended_gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<a id="__codelineno-9-8" name="__codelineno-9-8"></a><a href="#__codelineno-9-8"><span class="linenos" data-linenos=" 8 "></span></a>    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-9-9" name="__codelineno-9-9"></a><a href="#__codelineno-9-9"><span class="linenos" data-linenos=" 9 "></span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-9-10" name="__codelineno-9-10"></a><a href="#__codelineno-9-10"><span class="linenos" data-linenos="10 "></span></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-9-11" name="__codelineno-9-11"></a><a href="#__codelineno-9-11"><span class="linenos" data-linenos="11 "></span></a>        <span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">extended_gcd</span><span class="p">(</span><span class="n">b</span> <span class="o">%</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<a id="__codelineno-9-12" name="__codelineno-9-12"></a><a href="#__codelineno-9-12"><span class="linenos" data-linenos="12 "></span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span> <span class="o">//</span> <span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<a id="__codelineno-9-13" name="__codelineno-9-13"></a><a href="#__codelineno-9-13"><span class="linenos" data-linenos="13 "></span></a>
<a id="__codelineno-9-14" name="__codelineno-9-14"></a><a href="#__codelineno-9-14"><span class="linenos" data-linenos="14 "></span></a><span class="k">def</span><span class="w"> </span><span class="nf">mod_inverse</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<a id="__codelineno-9-15" name="__codelineno-9-15"></a><a href="#__codelineno-9-15"><span class="linenos" data-linenos="15 "></span></a>    <span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">extended_gcd</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<a id="__codelineno-9-16" name="__codelineno-9-16"></a><a href="#__codelineno-9-16"><span class="linenos" data-linenos="16 "></span></a>    <span class="k">if</span> <span class="n">g</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-9-17" name="__codelineno-9-17"></a><a href="#__codelineno-9-17"><span class="linenos" data-linenos="17 "></span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The modular inverse does not exist&quot;</span><span class="p">)</span>
<a id="__codelineno-9-18" name="__codelineno-9-18"></a><a href="#__codelineno-9-18"><span class="linenos" data-linenos="18 "></span></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-9-19" name="__codelineno-9-19"></a><a href="#__codelineno-9-19"><span class="linenos" data-linenos="19 "></span></a>        <span class="k">return</span> <span class="n">x</span> <span class="o">%</span> <span class="n">m</span>
<a id="__codelineno-9-20" name="__codelineno-9-20"></a><a href="#__codelineno-9-20"><span class="linenos" data-linenos="20 "></span></a>
<a id="__codelineno-9-21" name="__codelineno-9-21"></a><a href="#__codelineno-9-21"><span class="linenos" data-linenos="21 "></span></a><span class="n">d</span> <span class="o">=</span> <span class="n">mod_inverse</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<a id="__codelineno-9-22" name="__codelineno-9-22"></a><a href="#__codelineno-9-22"><span class="linenos" data-linenos="22 "></span></a>
<a id="__codelineno-9-23" name="__codelineno-9-23"></a><a href="#__codelineno-9-23"><span class="linenos" data-linenos="23 "></span></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;公钥是(</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<a id="__codelineno-9-24" name="__codelineno-9-24"></a><a href="#__codelineno-9-24"><span class="linenos" data-linenos="24 "></span></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;私钥是(</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</code></pre></div>
<p>RSA加密代码</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><a href="#__codelineno-10-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Util.number</span><span class="w"> </span><span class="kn">import</span> <span class="n">bytes_to_long</span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a><a href="#__codelineno-10-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="c1">#from Cryptodome.Util.number import bytes_to_long</span>
<a id="__codelineno-10-3" name="__codelineno-10-3"></a><a href="#__codelineno-10-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-10-4" name="__codelineno-10-4"></a><a href="#__codelineno-10-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;hello world&#39;</span>
<a id="__codelineno-10-5" name="__codelineno-10-5"></a><a href="#__codelineno-10-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="n">flag_bytes</span> <span class="o">=</span> <span class="n">flag</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>  <span class="c1"># 将字符串转换为字节数组</span>
<a id="__codelineno-10-6" name="__codelineno-10-6"></a><a href="#__codelineno-10-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">flag_bytes</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">)</span>  <span class="c1"># 使用big-endian字节序</span>
<a id="__codelineno-10-7" name="__codelineno-10-7"></a><a href="#__codelineno-10-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="n">n</span> <span class="o">=</span> <span class="mi">77</span>
<a id="__codelineno-10-8" name="__codelineno-10-8"></a><a href="#__codelineno-10-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="n">e</span> <span class="o">=</span> <span class="mi">17</span>
<a id="__codelineno-10-9" name="__codelineno-10-9"></a><a href="#__codelineno-10-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="n">y</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<a id="__codelineno-10-10" name="__codelineno-10-10"></a><a href="#__codelineno-10-10"><span class="linenos" data-linenos="10 "></span></a><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</code></pre></div>
<p>RSA解密代码</p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><a href="#__codelineno-11-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="n">y</span> <span class="o">=</span> <span class="mi">27</span>
<a id="__codelineno-11-2" name="__codelineno-11-2"></a><a href="#__codelineno-11-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="n">n</span> <span class="o">=</span> <span class="mi">77</span>
<a id="__codelineno-11-3" name="__codelineno-11-3"></a><a href="#__codelineno-11-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="n">d</span> <span class="o">=</span> <span class="mi">53</span>
<a id="__codelineno-11-4" name="__codelineno-11-4"></a><a href="#__codelineno-11-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="n">e</span> <span class="o">=</span> <span class="mi">17</span>
<a id="__codelineno-11-5" name="__codelineno-11-5"></a><a href="#__codelineno-11-5"><span class="linenos" data-linenos=" 5 "></span></a>
<a id="__codelineno-11-6" name="__codelineno-11-6"></a><a href="#__codelineno-11-6"><span class="linenos" data-linenos=" 6 "></span></a>
<a id="__codelineno-11-7" name="__codelineno-11-7"></a><a href="#__codelineno-11-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="c1"># 解密密文</span>
<a id="__codelineno-11-8" name="__codelineno-11-8"></a><a href="#__codelineno-11-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="n">x</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<a id="__codelineno-11-9" name="__codelineno-11-9"></a><a href="#__codelineno-11-9"><span class="linenos" data-linenos=" 9 "></span></a>
<a id="__codelineno-11-10" name="__codelineno-11-10"></a><a href="#__codelineno-11-10"><span class="linenos" data-linenos="10 "></span></a><span class="c1"># 将解密后的整数转换为字节数组</span>
<a id="__codelineno-11-11" name="__codelineno-11-11"></a><a href="#__codelineno-11-11"><span class="linenos" data-linenos="11 "></span></a><span class="n">flag_bytes</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span> <span class="o">//</span> <span class="mi">8</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">)</span>
<a id="__codelineno-11-12" name="__codelineno-11-12"></a><a href="#__codelineno-11-12"><span class="linenos" data-linenos="12 "></span></a>
<a id="__codelineno-11-13" name="__codelineno-11-13"></a><a href="#__codelineno-11-13"><span class="linenos" data-linenos="13 "></span></a><span class="c1"># 将字节数组转换为字符串</span>
<a id="__codelineno-11-14" name="__codelineno-11-14"></a><a href="#__codelineno-11-14"><span class="linenos" data-linenos="14 "></span></a><span class="n">flag</span> <span class="o">=</span> <span class="n">flag_bytes</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<a id="__codelineno-11-15" name="__codelineno-11-15"></a><a href="#__codelineno-11-15"><span class="linenos" data-linenos="15 "></span></a>
<a id="__codelineno-11-16" name="__codelineno-11-16"></a><a href="#__codelineno-11-16"><span class="linenos" data-linenos="16 "></span></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;解密后的明文:&quot;</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
</code></pre></div>
<p>出现的问题</p>
<p>1.<code>pip install pycryptodome</code>报错</p>
<p><code>pip install --user pycryptodome</code></p>
<p>（ChatGPT解决）</p>
<hr />
<h2 id="buuctf-rsa">BUUCTF题库-RSA<a class="headerlink" href="#buuctf-rsa" title="Permanent link">&para;</a></h2>
<p>此后这部分的题目，均来自BUUOJ</p>
<p><strong>在此篇wp中，统一规定，p和q表示两个大质数，他们的乘积记作n，n的欧拉函数φ(n)，公钥是(n,e)，私钥是(n,d)，明文是m，密文是c，满足</strong><code>c = m^e mod n</code> <code>m = c^d mod n</code></p>
<h3 id="rsarsa-p-q-e-cm">rsarsa 已知p q e c，求m<a class="headerlink" href="#rsarsa-p-q-e-cm" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><a href="#__codelineno-12-1"><span class="linenos" data-linenos=" 1 "></span></a>import gmpy2
<a id="__codelineno-12-2" name="__codelineno-12-2"></a><a href="#__codelineno-12-2"><span class="linenos" data-linenos=" 2 "></span></a>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a><a href="#__codelineno-12-3"><span class="linenos" data-linenos=" 3 "></span></a>p =  9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483
<a id="__codelineno-12-4" name="__codelineno-12-4"></a><a href="#__codelineno-12-4"><span class="linenos" data-linenos=" 4 "></span></a>q =  11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407
<a id="__codelineno-12-5" name="__codelineno-12-5"></a><a href="#__codelineno-12-5"><span class="linenos" data-linenos=" 5 "></span></a>e =  65537
<a id="__codelineno-12-6" name="__codelineno-12-6"></a><a href="#__codelineno-12-6"><span class="linenos" data-linenos=" 6 "></span></a>c =  83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034
<a id="__codelineno-12-7" name="__codelineno-12-7"></a><a href="#__codelineno-12-7"><span class="linenos" data-linenos=" 7 "></span></a>
<a id="__codelineno-12-8" name="__codelineno-12-8"></a><a href="#__codelineno-12-8"><span class="linenos" data-linenos=" 8 "></span></a>n = p * q
<a id="__codelineno-12-9" name="__codelineno-12-9"></a><a href="#__codelineno-12-9"><span class="linenos" data-linenos=" 9 "></span></a>phi = (p-1) * (q-1)
<a id="__codelineno-12-10" name="__codelineno-12-10"></a><a href="#__codelineno-12-10"><span class="linenos" data-linenos="10 "></span></a>d = gmpy2.invert(e,phi)
<a id="__codelineno-12-11" name="__codelineno-12-11"></a><a href="#__codelineno-12-11"><span class="linenos" data-linenos="11 "></span></a>flag = pow( c , d , n )
<a id="__codelineno-12-12" name="__codelineno-12-12"></a><a href="#__codelineno-12-12"><span class="linenos" data-linenos="12 "></span></a>
<a id="__codelineno-12-13" name="__codelineno-12-13"></a><a href="#__codelineno-12-13"><span class="linenos" data-linenos="13 "></span></a>print(flag)
</code></pre></div>
<p>flag{5577446633554466577768879988}</p>
<h3 id="rsa-p-q-e-d">RSA 已知p q e ，求d<a class="headerlink" href="#rsa-p-q-e-d" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><a href="#__codelineno-13-1"><span class="linenos" data-linenos=" 1 "></span></a>import gmpy2
<a id="__codelineno-13-2" name="__codelineno-13-2"></a><a href="#__codelineno-13-2"><span class="linenos" data-linenos=" 2 "></span></a>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a><a href="#__codelineno-13-3"><span class="linenos" data-linenos=" 3 "></span></a>p=473398607161
<a id="__codelineno-13-4" name="__codelineno-13-4"></a><a href="#__codelineno-13-4"><span class="linenos" data-linenos=" 4 "></span></a>q=4511491
<a id="__codelineno-13-5" name="__codelineno-13-5"></a><a href="#__codelineno-13-5"><span class="linenos" data-linenos=" 5 "></span></a>e=17
<a id="__codelineno-13-6" name="__codelineno-13-6"></a><a href="#__codelineno-13-6"><span class="linenos" data-linenos=" 6 "></span></a>phi = (p-1) * (q-1)
<a id="__codelineno-13-7" name="__codelineno-13-7"></a><a href="#__codelineno-13-7"><span class="linenos" data-linenos=" 7 "></span></a>
<a id="__codelineno-13-8" name="__codelineno-13-8"></a><a href="#__codelineno-13-8"><span class="linenos" data-linenos=" 8 "></span></a>d = pow( e , phi-2 , phi )#m非质数，不能用费马小定理
<a id="__codelineno-13-9" name="__codelineno-13-9"></a><a href="#__codelineno-13-9"><span class="linenos" data-linenos=" 9 "></span></a>print(d)#错误答案
<a id="__codelineno-13-10" name="__codelineno-13-10"></a><a href="#__codelineno-13-10"><span class="linenos" data-linenos="10 "></span></a>
<a id="__codelineno-13-11" name="__codelineno-13-11"></a><a href="#__codelineno-13-11"><span class="linenos" data-linenos="11 "></span></a>d = gmpy2.invert( e , phi )
<a id="__codelineno-13-12" name="__codelineno-13-12"></a><a href="#__codelineno-13-12"><span class="linenos" data-linenos="12 "></span></a>print(d)
</code></pre></div>
<p>flag{125631357777427553}</p>
<h3 id="rsa1-dpdq">RSA1 已知dp,dq<a class="headerlink" href="#rsa1-dpdq" title="Permanent link">&para;</a></h3>
<p>已知p q dp dq c</p>
<p><code>dp = d % ( p - 1 ) , dq = d % ( q - 1 )</code></p>
<p><code>m1 = y^dp mod p , m2 = y^dq mod q</code></p>
<p><code>m = ( ( m2 - m1 ) * Inv( invert( q , p ) ) % p ) * q + m2</code></p>
<p><strong>证明</strong></p>
<p><img alt="" src="asserts\RSA1.jpg" /></p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><a href="#__codelineno-14-1"><span class="linenos" data-linenos=" 1 "></span></a>import gmpy2
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><a href="#__codelineno-14-2"><span class="linenos" data-linenos=" 2 "></span></a>from Crypto.Util.number import long_to_bytes
<a id="__codelineno-14-3" name="__codelineno-14-3"></a><a href="#__codelineno-14-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a><a href="#__codelineno-14-4"><span class="linenos" data-linenos=" 4 "></span></a>p = 8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229 
<a id="__codelineno-14-5" name="__codelineno-14-5"></a><a href="#__codelineno-14-5"><span class="linenos" data-linenos=" 5 "></span></a>q = 12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469 
<a id="__codelineno-14-6" name="__codelineno-14-6"></a><a href="#__codelineno-14-6"><span class="linenos" data-linenos=" 6 "></span></a>dp = 6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929 
<a id="__codelineno-14-7" name="__codelineno-14-7"></a><a href="#__codelineno-14-7"><span class="linenos" data-linenos=" 7 "></span></a>dq = 783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041 
<a id="__codelineno-14-8" name="__codelineno-14-8"></a><a href="#__codelineno-14-8"><span class="linenos" data-linenos=" 8 "></span></a>c = 24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852
<a id="__codelineno-14-9" name="__codelineno-14-9"></a><a href="#__codelineno-14-9"><span class="linenos" data-linenos=" 9 "></span></a>
<a id="__codelineno-14-10" name="__codelineno-14-10"></a><a href="#__codelineno-14-10"><span class="linenos" data-linenos="10 "></span></a>m1 = pow( c , dp , p )
<a id="__codelineno-14-11" name="__codelineno-14-11"></a><a href="#__codelineno-14-11"><span class="linenos" data-linenos="11 "></span></a>m2 = pow( c , dq , q )
<a id="__codelineno-14-12" name="__codelineno-14-12"></a><a href="#__codelineno-14-12"><span class="linenos" data-linenos="12 "></span></a>m = (((m2-m1) * gmpy2.invert( q , p ) ) % p ) * q + m2
<a id="__codelineno-14-13" name="__codelineno-14-13"></a><a href="#__codelineno-14-13"><span class="linenos" data-linenos="13 "></span></a>
<a id="__codelineno-14-14" name="__codelineno-14-14"></a><a href="#__codelineno-14-14"><span class="linenos" data-linenos="14 "></span></a>print( long_to_bytes(m) )
</code></pre></div>
<p>flag{W31c0m3_70_Ch1n470wn}</p>
<h3 id="rsa2-dp">RSA2 dp泄露<a class="headerlink" href="#rsa2-dp" title="Permanent link">&para;</a></h3>
<p>已知e , n , c , dp</p>
<p><strong>证明</strong></p>
<p><img alt="" src="asserts\RSA2.jpg" /></p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><a href="#__codelineno-15-1"><span class="linenos" data-linenos=" 1 "></span></a>import gmpy2
<a id="__codelineno-15-2" name="__codelineno-15-2"></a><a href="#__codelineno-15-2"><span class="linenos" data-linenos=" 2 "></span></a>from Crypto.Util.number import long_to_bytes
<a id="__codelineno-15-3" name="__codelineno-15-3"></a><a href="#__codelineno-15-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-15-4" name="__codelineno-15-4"></a><a href="#__codelineno-15-4"><span class="linenos" data-linenos=" 4 "></span></a>e = 65537
<a id="__codelineno-15-5" name="__codelineno-15-5"></a><a href="#__codelineno-15-5"><span class="linenos" data-linenos=" 5 "></span></a>n = 248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113
<a id="__codelineno-15-6" name="__codelineno-15-6"></a><a href="#__codelineno-15-6"><span class="linenos" data-linenos=" 6 "></span></a>dp = 905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657
<a id="__codelineno-15-7" name="__codelineno-15-7"></a><a href="#__codelineno-15-7"><span class="linenos" data-linenos=" 7 "></span></a>c = 140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751
<a id="__codelineno-15-8" name="__codelineno-15-8"></a><a href="#__codelineno-15-8"><span class="linenos" data-linenos=" 8 "></span></a>
<a id="__codelineno-15-9" name="__codelineno-15-9"></a><a href="#__codelineno-15-9"><span class="linenos" data-linenos=" 9 "></span></a>for i in range( 1 , e ):
<a id="__codelineno-15-10" name="__codelineno-15-10"></a><a href="#__codelineno-15-10"><span class="linenos" data-linenos="10 "></span></a>    if (dp*e-1)%i == 0:#判断p存在
<a id="__codelineno-15-11" name="__codelineno-15-11"></a><a href="#__codelineno-15-11"><span class="linenos" data-linenos="11 "></span></a>        if n%(((dp*e-1)//i)+1) == 0 :#p可以把n整除
<a id="__codelineno-15-12" name="__codelineno-15-12"></a><a href="#__codelineno-15-12"><span class="linenos" data-linenos="12 "></span></a>            p = (dp*e-1)//i+1
<a id="__codelineno-15-13" name="__codelineno-15-13"></a><a href="#__codelineno-15-13"><span class="linenos" data-linenos="13 "></span></a>            q = n // p
<a id="__codelineno-15-14" name="__codelineno-15-14"></a><a href="#__codelineno-15-14"><span class="linenos" data-linenos="14 "></span></a>            phi = (p-1) * (q-1)
<a id="__codelineno-15-15" name="__codelineno-15-15"></a><a href="#__codelineno-15-15"><span class="linenos" data-linenos="15 "></span></a>            d = gmpy2.invert(e,phi)
<a id="__codelineno-15-16" name="__codelineno-15-16"></a><a href="#__codelineno-15-16"><span class="linenos" data-linenos="16 "></span></a>            m = pow( c , d , n )
<a id="__codelineno-15-17" name="__codelineno-15-17"></a><a href="#__codelineno-15-17"><span class="linenos" data-linenos="17 "></span></a>
<a id="__codelineno-15-18" name="__codelineno-15-18"></a><a href="#__codelineno-15-18"><span class="linenos" data-linenos="18 "></span></a>print( long_to_bytes(m) )
</code></pre></div>
<p>flag{wow_leaking_dp_breaks_rsa?_98924743502}</p>
<h3 id="rsa3">RSA3 共膜攻击<a class="headerlink" href="#rsa3" title="Permanent link">&para;</a></h3>
<p>已知n,c1,e1,c2,e2</p>
<p><strong>证明</strong></p>
<p><img alt="" src="asserts\RSA3.jpg" /></p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a><a href="#__codelineno-16-1"><span class="linenos" data-linenos=" 1 "></span></a>from gmpy2 import invert
<a id="__codelineno-16-2" name="__codelineno-16-2"></a><a href="#__codelineno-16-2"><span class="linenos" data-linenos=" 2 "></span></a>from Crypto.Util.number import long_to_bytes
<a id="__codelineno-16-3" name="__codelineno-16-3"></a><a href="#__codelineno-16-3"><span class="linenos" data-linenos=" 3 "></span></a>n=22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801
<a id="__codelineno-16-4" name="__codelineno-16-4"></a><a href="#__codelineno-16-4"><span class="linenos" data-linenos=" 4 "></span></a>c1=22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361
<a id="__codelineno-16-5" name="__codelineno-16-5"></a><a href="#__codelineno-16-5"><span class="linenos" data-linenos=" 5 "></span></a>e1=11187289
<a id="__codelineno-16-6" name="__codelineno-16-6"></a><a href="#__codelineno-16-6"><span class="linenos" data-linenos=" 6 "></span></a>c2=18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397
<a id="__codelineno-16-7" name="__codelineno-16-7"></a><a href="#__codelineno-16-7"><span class="linenos" data-linenos=" 7 "></span></a>e2=9647291
<a id="__codelineno-16-8" name="__codelineno-16-8"></a><a href="#__codelineno-16-8"><span class="linenos" data-linenos=" 8 "></span></a>
<a id="__codelineno-16-9" name="__codelineno-16-9"></a><a href="#__codelineno-16-9"><span class="linenos" data-linenos=" 9 "></span></a>def exgcd( a , b ):
<a id="__codelineno-16-10" name="__codelineno-16-10"></a><a href="#__codelineno-16-10"><span class="linenos" data-linenos="10 "></span></a>    if a == 0:
<a id="__codelineno-16-11" name="__codelineno-16-11"></a><a href="#__codelineno-16-11"><span class="linenos" data-linenos="11 "></span></a>        return ( b , 0 , 1)
<a id="__codelineno-16-12" name="__codelineno-16-12"></a><a href="#__codelineno-16-12"><span class="linenos" data-linenos="12 "></span></a>    else:
<a id="__codelineno-16-13" name="__codelineno-16-13"></a><a href="#__codelineno-16-13"><span class="linenos" data-linenos="13 "></span></a>        g , y , x = exgcd( b%a , a )
<a id="__codelineno-16-14" name="__codelineno-16-14"></a><a href="#__codelineno-16-14"><span class="linenos" data-linenos="14 "></span></a>        return ( g , x-(b//a)*y , y )
<a id="__codelineno-16-15" name="__codelineno-16-15"></a><a href="#__codelineno-16-15"><span class="linenos" data-linenos="15 "></span></a>
<a id="__codelineno-16-16" name="__codelineno-16-16"></a><a href="#__codelineno-16-16"><span class="linenos" data-linenos="16 "></span></a>judge , s1 , s2 = exgcd( e1 , e2 )
<a id="__codelineno-16-17" name="__codelineno-16-17"></a><a href="#__codelineno-16-17"><span class="linenos" data-linenos="17 "></span></a>
<a id="__codelineno-16-18" name="__codelineno-16-18"></a><a href="#__codelineno-16-18"><span class="linenos" data-linenos="18 "></span></a>if s1 &lt; 0:
<a id="__codelineno-16-19" name="__codelineno-16-19"></a><a href="#__codelineno-16-19"><span class="linenos" data-linenos="19 "></span></a>    s1 = - s1
<a id="__codelineno-16-20" name="__codelineno-16-20"></a><a href="#__codelineno-16-20"><span class="linenos" data-linenos="20 "></span></a>    c1 = invert( c1 , n )
<a id="__codelineno-16-21" name="__codelineno-16-21"></a><a href="#__codelineno-16-21"><span class="linenos" data-linenos="21 "></span></a>elif s2 &lt; 0:
<a id="__codelineno-16-22" name="__codelineno-16-22"></a><a href="#__codelineno-16-22"><span class="linenos" data-linenos="22 "></span></a>    s2 = - s2
<a id="__codelineno-16-23" name="__codelineno-16-23"></a><a href="#__codelineno-16-23"><span class="linenos" data-linenos="23 "></span></a>    c2 = invert( c2 , n )
<a id="__codelineno-16-24" name="__codelineno-16-24"></a><a href="#__codelineno-16-24"><span class="linenos" data-linenos="24 "></span></a>m = pow( c1 , s1 , n ) * pow( c2 , s2 , n ) % n
<a id="__codelineno-16-25" name="__codelineno-16-25"></a><a href="#__codelineno-16-25"><span class="linenos" data-linenos="25 "></span></a>
<a id="__codelineno-16-26" name="__codelineno-16-26"></a><a href="#__codelineno-16-26"><span class="linenos" data-linenos="26 "></span></a>print( long_to_bytes(m) )
</code></pre></div>
<p>flag{49d91077a1abcb14f1a9d546c80be9ef}</p>
<h3 id="rsa_1">RSA<a class="headerlink" href="#rsa_1" title="Permanent link">&para;</a></h3>
<p>将pub.key用记事本打开得到公钥</p>
<p>使用公钥解析网站进行解析http://www.hiencode.com/pub_asys.html</p>
<p><img alt="" src="asserts\image-20231102112308672.png" /></p>
<p>n不是特别大，使用在线网站进行大质数分解http://www.factordb.com/</p>
<p><img alt="" src="asserts\image-20231102112439195.png" /></p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a><a href="#__codelineno-17-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import long_to_bytes
<a id="__codelineno-17-2" name="__codelineno-17-2"></a><a href="#__codelineno-17-2"><span class="linenos" data-linenos=" 2 "></span></a>from gmpy2 import invert
<a id="__codelineno-17-3" name="__codelineno-17-3"></a><a href="#__codelineno-17-3"><span class="linenos" data-linenos=" 3 "></span></a>import rsa
<a id="__codelineno-17-4" name="__codelineno-17-4"></a><a href="#__codelineno-17-4"><span class="linenos" data-linenos=" 4 "></span></a>
<a id="__codelineno-17-5" name="__codelineno-17-5"></a><a href="#__codelineno-17-5"><span class="linenos" data-linenos=" 5 "></span></a>p = 285960468890451637935629440372639283459
<a id="__codelineno-17-6" name="__codelineno-17-6"></a><a href="#__codelineno-17-6"><span class="linenos" data-linenos=" 6 "></span></a>q = 304008741604601924494328155975272418463
<a id="__codelineno-17-7" name="__codelineno-17-7"></a><a href="#__codelineno-17-7"><span class="linenos" data-linenos=" 7 "></span></a>e = 65537
<a id="__codelineno-17-8" name="__codelineno-17-8"></a><a href="#__codelineno-17-8"><span class="linenos" data-linenos=" 8 "></span></a>n = p * q
<a id="__codelineno-17-9" name="__codelineno-17-9"></a><a href="#__codelineno-17-9"><span class="linenos" data-linenos=" 9 "></span></a>phi = (p-1) * (q-1)
<a id="__codelineno-17-10" name="__codelineno-17-10"></a><a href="#__codelineno-17-10"><span class="linenos" data-linenos="10 "></span></a>d = invert( e , phi )
<a id="__codelineno-17-11" name="__codelineno-17-11"></a><a href="#__codelineno-17-11"><span class="linenos" data-linenos="11 "></span></a>
<a id="__codelineno-17-12" name="__codelineno-17-12"></a><a href="#__codelineno-17-12"><span class="linenos" data-linenos="12 "></span></a>key = rsa.PrivateKey(n,e,d,q,p)#私钥包含(n,e,d,p,q)
<a id="__codelineno-17-13" name="__codelineno-17-13"></a><a href="#__codelineno-17-13"><span class="linenos" data-linenos="13 "></span></a>with open(&quot;C:\\Users\\coper\\Downloads\\0eaf8d6c-3fe5-4549-9e81-94ac42535e7b\\flag.enc&quot;,&quot;rb&quot;) as f:  #以二进制读模式，读取密文  
<a id="__codelineno-17-14" name="__codelineno-17-14"></a><a href="#__codelineno-17-14"><span class="linenos" data-linenos="14 "></span></a>    f = f.read()
<a id="__codelineno-17-15" name="__codelineno-17-15"></a><a href="#__codelineno-17-15"><span class="linenos" data-linenos="15 "></span></a>    print(rsa.decrypt(f,key))# f:公钥加密结果  key:私钥
</code></pre></div>
<h3 id="rsaroll">rsaroll<a class="headerlink" href="#rsaroll" title="Permanent link">&para;</a></h3>
<p>对一个文件中的多个密文进行解密</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a><a href="#__codelineno-18-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import long_to_bytes
<a id="__codelineno-18-2" name="__codelineno-18-2"></a><a href="#__codelineno-18-2"><span class="linenos" data-linenos=" 2 "></span></a>from gmpy2 import invert
<a id="__codelineno-18-3" name="__codelineno-18-3"></a><a href="#__codelineno-18-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-18-4" name="__codelineno-18-4"></a><a href="#__codelineno-18-4"><span class="linenos" data-linenos=" 4 "></span></a>p = 18443
<a id="__codelineno-18-5" name="__codelineno-18-5"></a><a href="#__codelineno-18-5"><span class="linenos" data-linenos=" 5 "></span></a>q = 49891
<a id="__codelineno-18-6" name="__codelineno-18-6"></a><a href="#__codelineno-18-6"><span class="linenos" data-linenos=" 6 "></span></a>e = 19
<a id="__codelineno-18-7" name="__codelineno-18-7"></a><a href="#__codelineno-18-7"><span class="linenos" data-linenos=" 7 "></span></a>n = p * q
<a id="__codelineno-18-8" name="__codelineno-18-8"></a><a href="#__codelineno-18-8"><span class="linenos" data-linenos=" 8 "></span></a>phi = (p-1) * (q-1)
<a id="__codelineno-18-9" name="__codelineno-18-9"></a><a href="#__codelineno-18-9"><span class="linenos" data-linenos=" 9 "></span></a>d = invert( e , phi )
<a id="__codelineno-18-10" name="__codelineno-18-10"></a><a href="#__codelineno-18-10"><span class="linenos" data-linenos="10 "></span></a>
<a id="__codelineno-18-11" name="__codelineno-18-11"></a><a href="#__codelineno-18-11"><span class="linenos" data-linenos="11 "></span></a>flag = []
<a id="__codelineno-18-12" name="__codelineno-18-12"></a><a href="#__codelineno-18-12"><span class="linenos" data-linenos="12 "></span></a>with open(&quot;C:\\Users\\coper\\Downloads\\02c01a13-3a86-47de-8648-f03328a5e5d8\\RsaRoll\\data.txt&quot;,&quot;r&quot;) as f:  #以二进制读模式，读取密文  
<a id="__codelineno-18-13" name="__codelineno-18-13"></a><a href="#__codelineno-18-13"><span class="linenos" data-linenos="13 "></span></a>    for line in f.readlines():
<a id="__codelineno-18-14" name="__codelineno-18-14"></a><a href="#__codelineno-18-14"><span class="linenos" data-linenos="14 "></span></a>        line = line.strip(&#39;\n&#39;)
<a id="__codelineno-18-15" name="__codelineno-18-15"></a><a href="#__codelineno-18-15"><span class="linenos" data-linenos="15 "></span></a>        flag.append(chr(pow(int(line),d,n)))
<a id="__codelineno-18-16" name="__codelineno-18-16"></a><a href="#__codelineno-18-16"><span class="linenos" data-linenos="16 "></span></a>for i in flag:
<a id="__codelineno-18-17" name="__codelineno-18-17"></a><a href="#__codelineno-18-17"><span class="linenos" data-linenos="17 "></span></a>    print(i,end=&#39;&#39;)
</code></pre></div>
<p>flag{13212je2ue28fy71w8u87y31r78eu1e2}</p>
<h3 id="dangerous-rsa">Dangerous RSA<a class="headerlink" href="#dangerous-rsa" title="Permanent link">&para;</a></h3>
<p>低加密指数攻击。条件：e非常小（python太tm神奇了）</p>
<p><code>c = m^e % n</code></p>
<p>1.<code>m^e &lt; n</code>时，<code>c = m^e</code>
2.<code>m^e &gt; n</code>时，<code>c = m^e - k*n</code>，即 <code>m^e = k*n+C</code>。对k进行爆破，只要k满足 k*n+C能开e次方根就可以</p>
<p>gmpy2库中iroot(a,b) 表示对a开b次方根，返回第一个数表示答案，第二个数表示是不是整数</p>
<p>运行时发现n的数值中多一个'L'，不是16进制，删掉即可获得flag</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a><a href="#__codelineno-19-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import long_to_bytes
<a id="__codelineno-19-2" name="__codelineno-19-2"></a><a href="#__codelineno-19-2"><span class="linenos" data-linenos=" 2 "></span></a>import gmpy2
<a id="__codelineno-19-3" name="__codelineno-19-3"></a><a href="#__codelineno-19-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-19-4" name="__codelineno-19-4"></a><a href="#__codelineno-19-4"><span class="linenos" data-linenos=" 4 "></span></a>n = 0x52d483c27cd806550fbe0e37a61af2e7cf5e0efb723dfc81174c918a27627779b21fa3c851e9e94188eaee3d5cd6f752406a43fbecb53e80836ff1e185d3ccd7782ea846c2e91a7b0808986666e0bdadbfb7bdd65670a589a4d2478e9adcafe97c6ee23614bcb2ecc23580f4d2e3cc1ecfec25c50da4bc754dde6c8bfd8d1fc16956c74d8e9196046a01dc9f3024e11461c294f29d7421140732fedacac97b8fe50999117d27943c953f18c4ff4f8c258d839764078d4b6ef6e8591e0ff5563b31a39e6374d0d41c8c46921c25e5904a817ef8e39e5c9b71225a83269693e0b7e3218fc5e5a1e8412ba16e588b3d6ac536dce39fcdfce81eec79979ea6872793
<a id="__codelineno-19-5" name="__codelineno-19-5"></a><a href="#__codelineno-19-5"><span class="linenos" data-linenos=" 5 "></span></a>c = 0x10652cdfaa6b63f6d7bd1109da08181e500e5643f5b240a9024bfa84d5f2cac9310562978347bb232d63e7289283871efab83d84ff5a7b64a94a79d34cfbd4ef121723ba1f663e514f83f6f01492b4e13e1bb4296d96ea5a353d3bf2edd2f449c03c4a3e995237985a596908adc741f32365
<a id="__codelineno-19-6" name="__codelineno-19-6"></a><a href="#__codelineno-19-6"><span class="linenos" data-linenos=" 6 "></span></a>e = 0x3
<a id="__codelineno-19-7" name="__codelineno-19-7"></a><a href="#__codelineno-19-7"><span class="linenos" data-linenos=" 7 "></span></a>k = 0
<a id="__codelineno-19-8" name="__codelineno-19-8"></a><a href="#__codelineno-19-8"><span class="linenos" data-linenos=" 8 "></span></a>
<a id="__codelineno-19-9" name="__codelineno-19-9"></a><a href="#__codelineno-19-9"><span class="linenos" data-linenos=" 9 "></span></a>while 1:
<a id="__codelineno-19-10" name="__codelineno-19-10"></a><a href="#__codelineno-19-10"><span class="linenos" data-linenos="10 "></span></a>    flag = gmpy2.iroot( c+k*n , e )
<a id="__codelineno-19-11" name="__codelineno-19-11"></a><a href="#__codelineno-19-11"><span class="linenos" data-linenos="11 "></span></a>    if flag[1] == True:
<a id="__codelineno-19-12" name="__codelineno-19-12"></a><a href="#__codelineno-19-12"><span class="linenos" data-linenos="12 "></span></a>        print( long_to_bytes(flag[0]) )
<a id="__codelineno-19-13" name="__codelineno-19-13"></a><a href="#__codelineno-19-13"><span class="linenos" data-linenos="13 "></span></a>        break
<a id="__codelineno-19-14" name="__codelineno-19-14"></a><a href="#__codelineno-19-14"><span class="linenos" data-linenos="14 "></span></a>    k = k + 1
</code></pre></div>
<p>flag{25df8caf006ee5db94d48144c33b2c3b}</p>
<h3 id="rsa2">rsa2<a class="headerlink" href="#rsa2" title="Permanent link">&para;</a></h3>
<p>只有公钥，都很大</p>
<p>RSAwienerHacker离线工具进行破解</p>
<p><img alt="" src="asserts\image-20231107090130789.png" /></p>
<p>hashlib在python3上运行不了，得用python2</p>
<p><img alt="" src="asserts\image-20231107091049789.png" /></p>
<p>flag{47bf28da384590448e0b0d23909a25a4}</p>
<h2 id="rsa_2">一些比赛中的 RSA 相关题目<a class="headerlink" href="#rsa_2" title="Permanent link">&para;</a></h2>
<h3 id="guet-ctf2019babyrsa">[GUET-CTF2019]BabyRSA<a class="headerlink" href="#guet-ctf2019babyrsa" title="Permanent link">&para;</a></h3>
<p>p + q = x , (p+1)*(q+1) = y</p>
<p>y=(p+1)*(q+1)=p*q+p+q+1=n+x+1</p>
<p>n=y-x-1</p>
<p><img alt="" src="asserts\image-20231111213325734.png" /></p>
<p>flag{cc7490e-78ab-11e9-b422-8ba97e5da1fd}</p>
<h3 id="buuctfafctf2018rsa">[BUUCTF·AFCTF2018]可怜的RSA<a class="headerlink" href="#buuctfafctf2018rsa" title="Permanent link">&para;</a></h3>
<p>public.key:</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1"></a><a href="#__codelineno-20-1"><span class="linenos" data-linenos="1 "></span></a>-----BEGIN PUBLIC KEY-----
<a id="__codelineno-20-2" name="__codelineno-20-2"></a><a href="#__codelineno-20-2"><span class="linenos" data-linenos="2 "></span></a>MIIBJDANBgkqhkiG9w0BAQEFAAOCAREAMIIBDAKCAQMlsYv184kJfRcjeGa7Uc/4
<a id="__codelineno-20-3" name="__codelineno-20-3"></a><a href="#__codelineno-20-3"><span class="linenos" data-linenos="3 "></span></a>3pIkU3SevEA7CZXJfA44bUbBYcrf93xphg2uR5HCFM+Eh6qqnybpIKl3g0kGA4rv
<a id="__codelineno-20-4" name="__codelineno-20-4"></a><a href="#__codelineno-20-4"><span class="linenos" data-linenos="4 "></span></a>tcMIJ9/PP8npdpVE+U4Hzf4IcgOaOmJiEWZ4smH7LWudMlOekqFTs2dWKbqzlC59
<a id="__codelineno-20-5" name="__codelineno-20-5"></a><a href="#__codelineno-20-5"><span class="linenos" data-linenos="5 "></span></a>NeMPfu9avxxQ15fQzIjhvcz9GhLqb373XDcn298ueA80KK6Pek+3qJ8YSjZQMrFT
<a id="__codelineno-20-6" name="__codelineno-20-6"></a><a href="#__codelineno-20-6"><span class="linenos" data-linenos="6 "></span></a>+EJehFdQ6yt6vALcFc4CB1B6qVCGO7hICngCjdYpeZRNbGM/r6ED5Nsozof1oMbt
<a id="__codelineno-20-7" name="__codelineno-20-7"></a><a href="#__codelineno-20-7"><span class="linenos" data-linenos="7 "></span></a>Si8mZEJ/Vlx3gathkUVtlxx/+jlScjdM7AFV5fkRidt0LkwosDoPoRz/sDFz0qTM
<a id="__codelineno-20-8" name="__codelineno-20-8"></a><a href="#__codelineno-20-8"><span class="linenos" data-linenos="8 "></span></a>5q5TAgMBAAE=
<a id="__codelineno-20-9" name="__codelineno-20-9"></a><a href="#__codelineno-20-9"><span class="linenos" data-linenos="9 "></span></a>-----END PUBLIC KEY-----
</code></pre></div>
<p>flag.enc:</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a><a href="#__codelineno-21-1"><span class="linenos" data-linenos="1 "></span></a>GVd1d3viIXFfcHapEYuo5fAvIiUS83adrtMW/MgPwxVBSl46joFCQ1plcnlDGfL19K/3PvChV6n5QGohzfVyz2Z5GdTlaknxvHDUGf5HCukokyPwK/1EYU7NzrhGE7J5jPdi0Aj7xi/Odxy0hGMgpaBLd/nL3N8O6i9pc4Gg3O8soOlciBG/6/xdfN3SzSStMYIN8nfZZMSq3xDDvz4YB7TcTBh4ik4wYhuC77gmT+HWOv5gLTNQ3EkZs5N3EAopy11zHNYU80yv1jtFGcluNPyXYttU5qU33jcp0Wuznac+t+AZHeSQy5vk8DyWorSGMiS+J4KNqSVlDs12EqXEqqJ0uA==
</code></pre></div>
<hr />
<p>读取public.key</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1"></a><a href="#__codelineno-22-1"><span class="linenos" data-linenos="1 "></span></a>from Crypto.PublicKey import RSA
<a id="__codelineno-22-2" name="__codelineno-22-2"></a><a href="#__codelineno-22-2"><span class="linenos" data-linenos="2 "></span></a>f = open(&#39;public.key&#39;, &#39;rb&#39;).read()
<a id="__codelineno-22-3" name="__codelineno-22-3"></a><a href="#__codelineno-22-3"><span class="linenos" data-linenos="3 "></span></a>pub = RSA.importKey(f)
<a id="__codelineno-22-4" name="__codelineno-22-4"></a><a href="#__codelineno-22-4"><span class="linenos" data-linenos="4 "></span></a>n = pub.n
<a id="__codelineno-22-5" name="__codelineno-22-5"></a><a href="#__codelineno-22-5"><span class="linenos" data-linenos="5 "></span></a>e = pub.e
<a id="__codelineno-22-6" name="__codelineno-22-6"></a><a href="#__codelineno-22-6"><span class="linenos" data-linenos="6 "></span></a>print(n, &#39;\n&#39;, e)
</code></pre></div>
<p>得到的n进行分解</p>
<p><img alt="" src="asserts\image-20240107221027950.png" /></p>
<p>编写脚本即可解密</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1"></a><a href="#__codelineno-23-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.PublicKey import RSA
<a id="__codelineno-23-2" name="__codelineno-23-2"></a><a href="#__codelineno-23-2"><span class="linenos" data-linenos=" 2 "></span></a>from Crypto.Cipher import PKCS1_OAEP
<a id="__codelineno-23-3" name="__codelineno-23-3"></a><a href="#__codelineno-23-3"><span class="linenos" data-linenos=" 3 "></span></a>from base64 import b64decode
<a id="__codelineno-23-4" name="__codelineno-23-4"></a><a href="#__codelineno-23-4"><span class="linenos" data-linenos=" 4 "></span></a>import libnum
<a id="__codelineno-23-5" name="__codelineno-23-5"></a><a href="#__codelineno-23-5"><span class="linenos" data-linenos=" 5 "></span></a>import gmpy2
<a id="__codelineno-23-6" name="__codelineno-23-6"></a><a href="#__codelineno-23-6"><span class="linenos" data-linenos=" 6 "></span></a>
<a id="__codelineno-23-7" name="__codelineno-23-7"></a><a href="#__codelineno-23-7"><span class="linenos" data-linenos=" 7 "></span></a>e = 65537
<a id="__codelineno-23-8" name="__codelineno-23-8"></a><a href="#__codelineno-23-8"><span class="linenos" data-linenos=" 8 "></span></a>p = 3133337
<a id="__codelineno-23-9" name="__codelineno-23-9"></a><a href="#__codelineno-23-9"><span class="linenos" data-linenos=" 9 "></span></a>q = 25478326064937419292200172136399497719081842914528228316455906211693118321971399936004729134841162974144246271486439695786036588117424611881955950996219646807378822278285638261582099108339438949573034101215141156156408742843820048066830863814362379885720395082318462850002901605689761876319151147352730090957556940842144299887394678743607766937828094478336401159449035878306853716216548374273462386508307367713112073004011383418967894930554067582453248981022011922883374442736848045920676341361871231787163441467533076890081721882179369168787287724769642665399992556052144845878600126283968890273067575342061776244939
<a id="__codelineno-23-10" name="__codelineno-23-10"></a><a href="#__codelineno-23-10"><span class="linenos" data-linenos="10 "></span></a>n = p * q
<a id="__codelineno-23-11" name="__codelineno-23-11"></a><a href="#__codelineno-23-11"><span class="linenos" data-linenos="11 "></span></a>phi = (p-1)*(q-1)
<a id="__codelineno-23-12" name="__codelineno-23-12"></a><a href="#__codelineno-23-12"><span class="linenos" data-linenos="12 "></span></a>d = int(gmpy2.invert( e , phi ))#这一步一定要转成int，不然mpz会报错
<a id="__codelineno-23-13" name="__codelineno-23-13"></a><a href="#__codelineno-23-13"><span class="linenos" data-linenos="13 "></span></a>
<a id="__codelineno-23-14" name="__codelineno-23-14"></a><a href="#__codelineno-23-14"><span class="linenos" data-linenos="14 "></span></a>key_info = RSA.construct((n, e, d, p, q))
<a id="__codelineno-23-15" name="__codelineno-23-15"></a><a href="#__codelineno-23-15"><span class="linenos" data-linenos="15 "></span></a>key = RSA.importKey(key_info.exportKey())
<a id="__codelineno-23-16" name="__codelineno-23-16"></a><a href="#__codelineno-23-16"><span class="linenos" data-linenos="16 "></span></a>key = PKCS1_OAEP.new(key)
<a id="__codelineno-23-17" name="__codelineno-23-17"></a><a href="#__codelineno-23-17"><span class="linenos" data-linenos="17 "></span></a>f = open(&#39;flag.enc&#39;, &#39;r&#39;).read()
<a id="__codelineno-23-18" name="__codelineno-23-18"></a><a href="#__codelineno-23-18"><span class="linenos" data-linenos="18 "></span></a>c = b64decode(f)
<a id="__codelineno-23-19" name="__codelineno-23-19"></a><a href="#__codelineno-23-19"><span class="linenos" data-linenos="19 "></span></a>flag = key.decrypt(c)
<a id="__codelineno-23-20" name="__codelineno-23-20"></a><a href="#__codelineno-23-20"><span class="linenos" data-linenos="20 "></span></a>print(flag)
</code></pre></div>
<p>flag:<code>flag{R54_|5_$0_B0rin9}</code></p>
<h3 id="ctfshownoeasyrsa">[CTFshow元旦水友赛]NOeasyRSA<a class="headerlink" href="#ctfshownoeasyrsa" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1"></a><a href="#__codelineno-24-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import long_to_bytes
<a id="__codelineno-24-2" name="__codelineno-24-2"></a><a href="#__codelineno-24-2"><span class="linenos" data-linenos=" 2 "></span></a>from Crypto.Util.strxor import strxor
<a id="__codelineno-24-3" name="__codelineno-24-3"></a><a href="#__codelineno-24-3"><span class="linenos" data-linenos=" 3 "></span></a>from random import randint
<a id="__codelineno-24-4" name="__codelineno-24-4"></a><a href="#__codelineno-24-4"><span class="linenos" data-linenos=" 4 "></span></a>from flag import FLAG
<a id="__codelineno-24-5" name="__codelineno-24-5"></a><a href="#__codelineno-24-5"><span class="linenos" data-linenos=" 5 "></span></a>
<a id="__codelineno-24-6" name="__codelineno-24-6"></a><a href="#__codelineno-24-6"><span class="linenos" data-linenos=" 6 "></span></a>def f(x, n):  
<a id="__codelineno-24-7" name="__codelineno-24-7"></a><a href="#__codelineno-24-7"><span class="linenos" data-linenos=" 7 "></span></a>    return (pow(u,n,p)*x + v*(1-pow(u,n,p))*pow(1-u, -1, p)) % p  
<a id="__codelineno-24-8" name="__codelineno-24-8"></a><a href="#__codelineno-24-8"><span class="linenos" data-linenos=" 8 "></span></a>
<a id="__codelineno-24-9" name="__codelineno-24-9"></a><a href="#__codelineno-24-9"><span class="linenos" data-linenos=" 9 "></span></a>p = 97201997431130462639713476119411091922677381239967611061717766639853376871260165905989218335681560177626304205941143288128749532327607316527719299945637260643711897738116821179208534292854942631428531228316344113303402450588666012800739695018334321748049518585617428717505851025279186520225325765864212731597
<a id="__codelineno-24-10" name="__codelineno-24-10"></a><a href="#__codelineno-24-10"><span class="linenos" data-linenos="10 "></span></a>u = 14011530787746260724685809284106528245188320623672333581950055679051366424425259006994945665868546765648275822501035229606171697373122374288934559593175958252416643298136731105775907857798815936190074350794406666922357841091849449562922724459876362600203284195621546769313749721476449207319566681142955460891977927184371401451946649848065952527323468939007868874410618846898618148752279316070498097254384228565132693552949206926391461108714034141321700284318834819732949544823937032615318011463993204345644038210938407875147446570896826729265366024224612406740371824999201173579640264979086368843819069035017648357042
<a id="__codelineno-24-11" name="__codelineno-24-11"></a><a href="#__codelineno-24-11"><span class="linenos" data-linenos="11 "></span></a>v = 16560637729264127314502582188855146263038095275553321912067588804088156431664370603746929023264744622682435376065011098909463163865218610904571775751705336266271206718700427773757241393847274601309127403955317959981271158685681135990095066557078560050980575698278958401980987514566688310172721963092100285717921465575782434632190913355536291988686994429739581469633462010143996998589435537178075521590880467628369030177392034117774853431604525531066071844562073814187461299329339694285509725214674761990940902460186665127466202741989052293452290042871514149972640901432877318075354158973805495004367245286709191395753
<a id="__codelineno-24-12" name="__codelineno-24-12"></a><a href="#__codelineno-24-12"><span class="linenos" data-linenos="12 "></span></a>w = 30714296289538837760400431621661767909419746909959905820574067592409316977551664652203146506867115455464665524418603262821119202980897986798059489126166547078057148348119365709992892615014626003313040730934533283339617856938614948620116906770806796378275546490794161777851252745862081462799572448648587153412425374338967601487603800379070501278705056791472269999767679535887678042527423534392867454254712641029797659150392148648565421400107500607994226410206105774620083214215531253544274444448346065590895353139670885420838370607181375842930315910289979440845957719622069769102831263579510660283634808483329218819353
<a id="__codelineno-24-13" name="__codelineno-24-13"></a><a href="#__codelineno-24-13"><span class="linenos" data-linenos="13 "></span></a>a = randint(0, 2**2048)
<a id="__codelineno-24-14" name="__codelineno-24-14"></a><a href="#__codelineno-24-14"><span class="linenos" data-linenos="14 "></span></a>b = randint(0, 2**2048)
<a id="__codelineno-24-15" name="__codelineno-24-15"></a><a href="#__codelineno-24-15"><span class="linenos" data-linenos="15 "></span></a>A = f(w, a)
<a id="__codelineno-24-16" name="__codelineno-24-16"></a><a href="#__codelineno-24-16"><span class="linenos" data-linenos="16 "></span></a>B = f(w, b)
<a id="__codelineno-24-17" name="__codelineno-24-17"></a><a href="#__codelineno-24-17"><span class="linenos" data-linenos="17 "></span></a>key = long_to_bytes(f(B, a))[:len(FLAG)]
<a id="__codelineno-24-18" name="__codelineno-24-18"></a><a href="#__codelineno-24-18"><span class="linenos" data-linenos="18 "></span></a>enc = strxor(FLAG, key)
<a id="__codelineno-24-19" name="__codelineno-24-19"></a><a href="#__codelineno-24-19"><span class="linenos" data-linenos="19 "></span></a>print(f&quot;{A = }&quot;)
<a id="__codelineno-24-20" name="__codelineno-24-20"></a><a href="#__codelineno-24-20"><span class="linenos" data-linenos="20 "></span></a>print(f&quot;{B = }&quot;)
<a id="__codelineno-24-21" name="__codelineno-24-21"></a><a href="#__codelineno-24-21"><span class="linenos" data-linenos="21 "></span></a>print(f&quot;{enc = }&quot;)
<a id="__codelineno-24-22" name="__codelineno-24-22"></a><a href="#__codelineno-24-22"><span class="linenos" data-linenos="22 "></span></a>
<a id="__codelineno-24-23" name="__codelineno-24-23"></a><a href="#__codelineno-24-23"><span class="linenos" data-linenos="23 "></span></a>&quot;&quot;&quot;
<a id="__codelineno-24-24" name="__codelineno-24-24"></a><a href="#__codelineno-24-24"><span class="linenos" data-linenos="24 "></span></a>A = 19000912802080599027672447674783518419279033741329820736608320648294849832904652704615322546923683308427498322653162857743332527479657555691849627174691056234736228204031597391109766621450008024310365149769851160904834246087493085291270515883474521052340305802461028930107070785434600793548735004323108063823
<a id="__codelineno-24-25" name="__codelineno-24-25"></a><a href="#__codelineno-24-25"><span class="linenos" data-linenos="25 "></span></a>B = 73344156869667785951629011239443984128961974188783039136848369309843181351498207375582387449307849089511875560536212143659712959631858144127598424003355287131145957594729789310869405545587664999655457134475561514111282513273352679348722584469527242626837672035004800949907749224093056447758969518003237425788
<a id="__codelineno-24-26" name="__codelineno-24-26"></a><a href="#__codelineno-24-26"><span class="linenos" data-linenos="26 "></span></a>enc = b&#39;\xfd\xc1\xb7\x9d&quot;$\xc2\xb0\xb5\xee\xf89\xa4V\x8e\x17\x01K9\xbc.\x92=\x85\x80\xd4\x03\xefAl&quot;\xbd\x8b\xcdL\xb5\xa3!&#39;
<a id="__codelineno-24-27" name="__codelineno-24-27"></a><a href="#__codelineno-24-27"><span class="linenos" data-linenos="27 "></span></a>&quot;&quot;&quot;
</code></pre></div>
<hr />
<p>只要思想不滑坡，这题就是推推式子（呜呜呜我自己做的时候把抄错好几个数死活调不出来呜呜...）</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1"></a><a href="#__codelineno-25-1"><span class="linenos" data-linenos=" 1 "></span></a>import gmpy2
<a id="__codelineno-25-2" name="__codelineno-25-2"></a><a href="#__codelineno-25-2"><span class="linenos" data-linenos=" 2 "></span></a>from Crypto.Util.number import long_to_bytes
<a id="__codelineno-25-3" name="__codelineno-25-3"></a><a href="#__codelineno-25-3"><span class="linenos" data-linenos=" 3 "></span></a>from Crypto.Util.strxor import strxor
<a id="__codelineno-25-4" name="__codelineno-25-4"></a><a href="#__codelineno-25-4"><span class="linenos" data-linenos=" 4 "></span></a>
<a id="__codelineno-25-5" name="__codelineno-25-5"></a><a href="#__codelineno-25-5"><span class="linenos" data-linenos=" 5 "></span></a>p = 97201997431130462639713476119411091922677381239967611061717766639853376871260165905989218335681560177626304205941143288128749532327607316527719299945637260643711897738116821179208534292854942631428531228316344113303402450588666012800739695018334321748049518585617428717505851025279186520225325765864212731597
<a id="__codelineno-25-6" name="__codelineno-25-6"></a><a href="#__codelineno-25-6"><span class="linenos" data-linenos=" 6 "></span></a>u = 14011530787746260724685809284106528245188320623672333581950055679051366424425259006994945665868546765648275822501035229606171697373122374288934559593175958252416643298136731105775907857798815936190074350794406666922357841091849449562922724459876362600203284195621546769313749721476449207319566681142955460891977927184371401451946649848065952527323468939007868874410618846898618148752279316070498097254384228565132693552949206926391461108714034141321700284318834819732949544823937032615318011463993204345644038210938407875147446570896826729265366024224612406740371824999201173579640264979086368843819069035017648357042
<a id="__codelineno-25-7" name="__codelineno-25-7"></a><a href="#__codelineno-25-7"><span class="linenos" data-linenos=" 7 "></span></a>v = 16560637729264127314502582188855146263038095275553321912067588804088156431664370603746929023264744622682435376065011098909463163865218610904571775751705336266271206718700427773757241393847274601309127403955317959981271158685681135990095066557078560050980575698278958401980987514566688310172721963092100285717921465575782434632190913355536291988686994429739581469633462010143996998589435537178075521590880467628369030177392034117774853431604525531066071844562073814187461299329339694285509725214674761990940902460186665127466202741989052293452290042871514149972640901432877318075354158973805495004367245286709191395753
<a id="__codelineno-25-8" name="__codelineno-25-8"></a><a href="#__codelineno-25-8"><span class="linenos" data-linenos=" 8 "></span></a>w = 30714296289538837760400431621661767909419746909959905820574067592409316977551664652203146506867115455464665524418603262821119202980897986798059489126166547078057148348119365709992892615014626003313040730934533283339617856938614948620116906770806796378275546490794161777851252745862081462799572448648587153412425374338967601487603800379070501278705056791472269999767679535887678042527423534392867454254712641029797659150392148648565421400107500607994226410206105774620083214215531253544274444448346065590895353139670885420838370607181375842930315910289979440845957719622069769102831263579510660283634808483329218819353
<a id="__codelineno-25-9" name="__codelineno-25-9"></a><a href="#__codelineno-25-9"><span class="linenos" data-linenos=" 9 "></span></a>A = 19000912802080599027672447674783518419279033741329820736608320648294849832904652704615322546923683308427498322653162857743332527479657555691849627174691056234736228204031597391109766621450008024310365149769851160904834246087493085291270515883474521052340305802461028930107070785434600793548735004323108063823
<a id="__codelineno-25-10" name="__codelineno-25-10"></a><a href="#__codelineno-25-10"><span class="linenos" data-linenos="10 "></span></a>B = 73344156869667785951629011239443984128961974188783039136848369309843181351498207375582387449307849089511875560536212143659712959631858144127598424003355287131145957594729789310869405545587664999655457134475561514111282513273352679348722584469527242626837672035004800949907749224093056447758969518003237425788
<a id="__codelineno-25-11" name="__codelineno-25-11"></a><a href="#__codelineno-25-11"><span class="linenos" data-linenos="11 "></span></a>enc = b&#39;\xfd\xc1\xb7\x9d&quot;$\xc2\xb0\xb5\xee\xf89\xa4V\x8e\x17\x01K9\xbc.\x92=\x85\x80\xd4\x03\xefAl&quot;\xbd\x8b\xcdL\xb5\xa3!&#39;
<a id="__codelineno-25-12" name="__codelineno-25-12"></a><a href="#__codelineno-25-12"><span class="linenos" data-linenos="12 "></span></a>
<a id="__codelineno-25-13" name="__codelineno-25-13"></a><a href="#__codelineno-25-13"><span class="linenos" data-linenos="13 "></span></a>ua = ((u-1)*A+v)*gmpy2.invert((u-1)*w+v,p) % p
<a id="__codelineno-25-14" name="__codelineno-25-14"></a><a href="#__codelineno-25-14"><span class="linenos" data-linenos="14 "></span></a>key = (ua * B + v * ( 1 - ua ) * gmpy2.invert( 1-u , p ) ) % p
<a id="__codelineno-25-15" name="__codelineno-25-15"></a><a href="#__codelineno-25-15"><span class="linenos" data-linenos="15 "></span></a>flag = strxor( enc , long_to_bytes(key)[:len(enc)] )
<a id="__codelineno-25-16" name="__codelineno-25-16"></a><a href="#__codelineno-25-16"><span class="linenos" data-linenos="16 "></span></a>print( flag )
</code></pre></div>
<p>flag:<code>ctfshow{This_Is_Really_Not_So_Smooth!}</code></p>
<p>问题：为什么取负运算在模域上对值没有改变</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1"></a><a href="#__codelineno-26-1"><span class="linenos" data-linenos="1 "></span></a>ua = ((u-1)*A+v)*gmpy2.invert((u-1)*w+v,p) % p
<a id="__codelineno-26-2" name="__codelineno-26-2"></a><a href="#__codelineno-26-2"><span class="linenos" data-linenos="2 "></span></a>ub = ((A*((1-u))-v) * gmpy2.invert(w*(1-u)-v,p)) % p
<a id="__codelineno-26-3" name="__codelineno-26-3"></a><a href="#__codelineno-26-3"><span class="linenos" data-linenos="3 "></span></a>assert ua == ub
</code></pre></div>
<p>通过yafu计算，p是质数</p>
<p><img alt="" src="asserts\image-20240109134635922.png" /></p>
<p>回答：因为有逆元，是分式；分子分母同时取负，值不变</p>
<h3 id="ctfshownoeasyrsa_1">[CTFshow元旦水友赛]NOeasyRSA<a class="headerlink" href="#ctfshownoeasyrsa_1" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1"></a><a href="#__codelineno-27-1"><span class="linenos" data-linenos=" 1 "></span></a>import random
<a id="__codelineno-27-2" name="__codelineno-27-2"></a><a href="#__codelineno-27-2"><span class="linenos" data-linenos=" 2 "></span></a>from hashlib import md5
<a id="__codelineno-27-3" name="__codelineno-27-3"></a><a href="#__codelineno-27-3"><span class="linenos" data-linenos=" 3 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-27-4" name="__codelineno-27-4"></a><a href="#__codelineno-27-4"><span class="linenos" data-linenos=" 4 "></span></a>from flag import flag
<a id="__codelineno-27-5" name="__codelineno-27-5"></a><a href="#__codelineno-27-5"><span class="linenos" data-linenos=" 5 "></span></a>
<a id="__codelineno-27-6" name="__codelineno-27-6"></a><a href="#__codelineno-27-6"><span class="linenos" data-linenos=" 6 "></span></a>def get_state(kbits, k):
<a id="__codelineno-27-7" name="__codelineno-27-7"></a><a href="#__codelineno-27-7"><span class="linenos" data-linenos=" 7 "></span></a>    seed = [(random.getrandbits(kbits) &gt;&gt; k) &amp; 0xfffffff for i in range(624)]
<a id="__codelineno-27-8" name="__codelineno-27-8"></a><a href="#__codelineno-27-8"><span class="linenos" data-linenos=" 8 "></span></a>    state = (3, tuple(seed + [0]), None)
<a id="__codelineno-27-9" name="__codelineno-27-9"></a><a href="#__codelineno-27-9"><span class="linenos" data-linenos=" 9 "></span></a>    return state
<a id="__codelineno-27-10" name="__codelineno-27-10"></a><a href="#__codelineno-27-10"><span class="linenos" data-linenos="10 "></span></a>
<a id="__codelineno-27-11" name="__codelineno-27-11"></a><a href="#__codelineno-27-11"><span class="linenos" data-linenos="11 "></span></a>
<a id="__codelineno-27-12" name="__codelineno-27-12"></a><a href="#__codelineno-27-12"><span class="linenos" data-linenos="12 "></span></a>def give_gift(kbits, num):
<a id="__codelineno-27-13" name="__codelineno-27-13"></a><a href="#__codelineno-27-13"><span class="linenos" data-linenos="13 "></span></a>    gift = [random.getrandbits(kbits) for i in range(num)]
<a id="__codelineno-27-14" name="__codelineno-27-14"></a><a href="#__codelineno-27-14"><span class="linenos" data-linenos="14 "></span></a>    e = random.getrandbits(7)
<a id="__codelineno-27-15" name="__codelineno-27-15"></a><a href="#__codelineno-27-15"><span class="linenos" data-linenos="15 "></span></a>    l_num = num - e
<a id="__codelineno-27-16" name="__codelineno-27-16"></a><a href="#__codelineno-27-16"><span class="linenos" data-linenos="16 "></span></a>    s_box = list(range(num))
<a id="__codelineno-27-17" name="__codelineno-27-17"></a><a href="#__codelineno-27-17"><span class="linenos" data-linenos="17 "></span></a>    random.shuffle(s_box)
<a id="__codelineno-27-18" name="__codelineno-27-18"></a><a href="#__codelineno-27-18"><span class="linenos" data-linenos="18 "></span></a>    l_gift = [gift[i] for i in s_box[:l_num]]
<a id="__codelineno-27-19" name="__codelineno-27-19"></a><a href="#__codelineno-27-19"><span class="linenos" data-linenos="19 "></span></a>    return (l_gift, s_box[:l_num], e)
<a id="__codelineno-27-20" name="__codelineno-27-20"></a><a href="#__codelineno-27-20"><span class="linenos" data-linenos="20 "></span></a>
<a id="__codelineno-27-21" name="__codelineno-27-21"></a><a href="#__codelineno-27-21"><span class="linenos" data-linenos="21 "></span></a>
<a id="__codelineno-27-22" name="__codelineno-27-22"></a><a href="#__codelineno-27-22"><span class="linenos" data-linenos="22 "></span></a>def enc_flag(state, e):
<a id="__codelineno-27-23" name="__codelineno-27-23"></a><a href="#__codelineno-27-23"><span class="linenos" data-linenos="23 "></span></a>    key = bytes_to_long(md5(long_to_bytes(state[1][e])).digest())
<a id="__codelineno-27-24" name="__codelineno-27-24"></a><a href="#__codelineno-27-24"><span class="linenos" data-linenos="24 "></span></a>    enc = bytes_to_long(flag) ^ key
<a id="__codelineno-27-25" name="__codelineno-27-25"></a><a href="#__codelineno-27-25"><span class="linenos" data-linenos="25 "></span></a>    return enc
<a id="__codelineno-27-26" name="__codelineno-27-26"></a><a href="#__codelineno-27-26"><span class="linenos" data-linenos="26 "></span></a>
<a id="__codelineno-27-27" name="__codelineno-27-27"></a><a href="#__codelineno-27-27"><span class="linenos" data-linenos="27 "></span></a>
<a id="__codelineno-27-28" name="__codelineno-27-28"></a><a href="#__codelineno-27-28"><span class="linenos" data-linenos="28 "></span></a>kbits, k, num = random.randrange(64), random.randrange(16), random.randrange(400, 600)
<a id="__codelineno-27-29" name="__codelineno-27-29"></a><a href="#__codelineno-27-29"><span class="linenos" data-linenos="29 "></span></a>state = get_state(kbits, k)
<a id="__codelineno-27-30" name="__codelineno-27-30"></a><a href="#__codelineno-27-30"><span class="linenos" data-linenos="30 "></span></a>random.setstate(state)
<a id="__codelineno-27-31" name="__codelineno-27-31"></a><a href="#__codelineno-27-31"><span class="linenos" data-linenos="31 "></span></a>gift = give_gift(kbits, num)
<a id="__codelineno-27-32" name="__codelineno-27-32"></a><a href="#__codelineno-27-32"><span class="linenos" data-linenos="32 "></span></a>enc = enc_flag(state, gift[2])
<a id="__codelineno-27-33" name="__codelineno-27-33"></a><a href="#__codelineno-27-33"><span class="linenos" data-linenos="33 "></span></a>print(gift, enc)
<a id="__codelineno-27-34" name="__codelineno-27-34"></a><a href="#__codelineno-27-34"><span class="linenos" data-linenos="34 "></span></a>
<a id="__codelineno-27-35" name="__codelineno-27-35"></a><a href="#__codelineno-27-35"><span class="linenos" data-linenos="35 "></span></a># ([91463260584, 97520150804, 134987178347, 134745660347, 23369346769, 88869916197, 67723104206, 132211190015, 74383600340, 57357411421, 80301226226, 2847043233, 46071508714, 76391425800, 71113777427, 12603028605, 127607785895, 82661956584, 48539405830, 131191473154, 137430688091, 48026249914, 105523652421, 58217141456, 135651011411, 37099885733, 101903983367, 117525416468, 49720139903, 123719748136, 58611168240, 68135859850, 6355615539, 23769720298, 7999623487, 19601432037, 49460687576, 34510812373, 97988805553, 120381187017, 37643325426, 79314538948, 128727827227, 41938289773, 74120986880, 29052999070, 21215042789, 76176648906, 82899209179, 90338690991, 102277220210, 109016314367, 2419923303, 75246152672, 109203867772, 87030346778, 119151949871, 134868756437, 124854798665, 122116306769, 31536426951, 82104297926, 118556737102, 78417017414, 81807286830, 24688295471, 126360674284, 8870569872, 105339369180, 61910863416, 56597235604, 50122937080, 135836683348, 75685244539, 112566491901, 86217144353, 110999080631, 91114786530, 94967775022, 52680440255, 76947914257, 133052296759, 22589975272, 104632324223, 47428022416, 106941367714, 119250845700, 80196618477, 92917756830, 52764061858, 82855761133, 26800124167, 129317288037, 44051967549, 70500283649, 165355182, 78293334339, 45001066520, 84638985033, 32566871344, 38421055041, 56145488218, 83396525174, 116762960131, 58381974438, 132249926372, 36091120717, 35213963219, 88756092150, 45288405267, 27461079382, 19589246113, 28308681656, 47161727545, 69898448282, 22959597168, 132569999975, 100557577568, 127037292334, 29708117311, 33229333831, 29311547868, 135347707719, 85435007922, 54540391811, 109544478077, 66841548339, 47159376439, 42574542524, 62176229940, 3138675000, 21267865120, 22618290315, 126018690563, 21590061225, 9799239940, 10617934652, 40956988582, 131053131140, 90043238501, 81283244185, 109338223936, 68311960398, 25088200986, 28895564195, 17646619057, 82775422880, 81522377214, 28334564831, 100791800926, 85872403124, 127915503356, 72496838376, 109007653011, 96263138881, 69693106974, 4718076407, 68334177311, 31708464646, 96111162918, 48965277868, 54931198292, 105535767797, 105680940066, 109968562576, 23573023928, 48569942163, 106967716286, 94835446653, 92803971955, 53791818332, 14453746086, 132101017989, 26361874022, 32122658200, 51724426274, 114997634813, 75838224666, 89848273104, 73619960674, 97795812498, 132466249292, 25997032367, 40732063573, 59142286405, 68524304985, 49545031400, 28044368864, 95700359624, 108201671504, 127043767055, 9384509797, 120972803416, 41782179648, 76653307257, 44056421640, 101631026937, 99078185959, 54885001820, 69316726710, 19710227322, 86035277688, 42289562955, 98051921147, 79098792488, 106490144808, 13834874, 69114014086, 4418515159, 109316722991, 92603496375, 68830244931, 111949257703, 102637560761, 5012149380, 43811237017, 4526712578, 102995188930, 9165821006, 63456393327, 68912422322, 104913358841, 108860651772, 52967416635, 84227988465, 101715630295, 26297443306, 110653579906, 91487440397, 116959430145, 83499469513, 48913630229, 76988993305, 41832173701, 13694488408, 135450931748, 39634435716, 41679152695, 126540504548, 91399825525, 99004649347, 19517357430, 8279948639, 133596449559, 1449103211, 50732184406, 52247676129, 74928416312, 64326525401, 124673786795, 92042480385, 24404916254, 99622146133, 51463314254, 36722967192, 4007778602, 39109534005, 120478575332, 99886542155, 5756463131, 91679854224, 3608646835, 35655876863, 121959477025, 20408412916, 36341277711, 43627610089, 24855949002, 128669830633, 70347508117, 9425085453, 2022963949, 5053312318, 63243834495, 21497715007, 5936366400, 44266914863, 119468825913, 91726986385, 126494307832, 93847533617, 22070910941, 20204251399, 42254244260, 60489335607, 40705184865, 80919639775, 73360223499, 132743946450, 88897376509, 103144368275, 9982808097, 131532980487, 91081435155, 78915930938, 72790758029, 120696671493, 78255313725, 13309583510, 23841020581, 116634908326, 73400462338, 57323203784, 46210923108, 41134724194, 43089395737, 118503520944, 111039189867, 99418263301, 59298127775, 45252940179, 40345195432, 16841439060, 100422187771, 65791698364, 61167532292, 30338914082, 14930863404, 4703203112, 124912009656, 9195518396, 18552364400, 7303227315, 105753747788, 3079040268, 116480022128, 1215344111, 9934249637, 76178148585, 20033461169, 87344780021, 72391242953, 129540048833, 15495213032, 49963621916, 84362224351, 97100635498, 105086571577, 51150506310, 118045067326, 65966867679, 7925108854, 131280748402, 66481282233, 107509392827, 78521145687, 35456851157, 97461157961, 30244093674, 24123083085, 27909475052, 69646113342, 131930611276, 97792139629, 135917828529, 32305782568, 59325645293, 84962280113, 74529748221, 22659244720, 54776660364, 66934871192, 14824496938, 37231294479, 102244198902, 31674646475, 128196911226, 90158594889, 121714346066, 64647669235, 105263204191, 127988380741, 130175056631, 114272442969, 135960937840, 62465712860, 32333037569, 137012433094, 92929672123, 86030288893, 73602847949, 58136148471, 118893337093, 97692245318, 99539974338, 116231441994, 32445182154, 115683286754, 114711297102, 102210385893, 7687212992, 73626254322, 242951419, 5952493527, 96817591608, 45197171621, 122928115217, 106192593180, 99889552302, 125596158762, 136959359712, 67291405558, 71974425715, 115789979144, 59321975202, 84748820897, 133266408556, 6800817333, 110678933813, 96832595879, 97681824039, 89341148630, 84626208563, 58523733456, 93000780873, 68444996084, 775177345, 17204124036, 129474447019, 73589942581, 65415043899, 131703332659, 101783987222, 61388598262, 103435807803, 104030629529, 19123072760, 63612557945, 38245223725, 54345357864, 62016904380, 34602169486, 51229280420, 66624757580, 68760378559, 131556923700, 21935621011, 36349470821, 10120892182, 25883848878, 71735922493, 62883391871, 90647098, 41388569318, 52175456448, 71822304690, 19251125978, 91308465291, 50110754397, 91050175581, 83697004380, 6165622900, 129188497722, 71424103672, 57569171583, 13220579058, 118266862549, 21791521844, 70064705221, 83120075317, 83316886784, 111745960042, 26241940218, 32402511427, 118604113535, 98847819357, 117058412964, 57680263912, 83166477192], [508, 300, 327, 517, 431, 195, 41, 162, 110, 358, 433, 105, 40, 256, 172, 50, 474, 55, 67, 284, 215, 118, 513, 98, 120, 26, 155, 298, 4, 233, 243, 267, 428, 478, 494, 226, 146, 488, 20, 113, 143, 136, 49, 236, 128, 346, 501, 264, 498, 0, 413, 30, 410, 99, 1, 220, 443, 369, 290, 374, 119, 511, 483, 199, 248, 351, 388, 335, 131, 79, 496, 245, 414, 244, 158, 451, 255, 412, 47, 473, 254, 95, 299, 462, 169, 519, 493, 12, 257, 385, 432, 417, 59, 93, 455, 324, 52, 90, 407, 288, 112, 34, 528, 29, 192, 101, 419, 203, 123, 176, 177, 167, 204, 445, 416, 485, 196, 302, 424, 425, 6, 418, 258, 17, 370, 262, 227, 326, 387, 294, 295, 174, 25, 188, 81, 408, 469, 11, 472, 80, 400, 84, 382, 448, 201, 344, 7, 502, 163, 312, 484, 349, 239, 108, 411, 315, 303, 377, 36, 383, 78, 339, 491, 271, 216, 187, 322, 140, 405, 296, 402, 516, 450, 22, 482, 361, 371, 249, 453, 64, 152, 72, 194, 66, 345, 492, 447, 58, 486, 357, 149, 200, 83, 212, 219, 504, 333, 23, 439, 376, 457, 332, 153, 348, 210, 237, 173, 359, 129, 179, 426, 71, 19, 321, 338, 444, 139, 307, 515, 88, 266, 475, 182, 323, 336, 354, 272, 384, 330, 2, 211, 446, 238, 397, 230, 278, 141, 506, 181, 70, 316, 314, 459, 235, 121, 286, 76, 518, 280, 43, 111, 62, 487, 429, 524, 364, 86, 228, 353, 275, 104, 441, 268, 13, 500, 68, 87, 109, 403, 520, 231, 391, 42, 51, 328, 253, 436, 60, 497, 313, 481, 522, 53, 61, 420, 225, 189, 325, 183, 56, 100, 229, 27, 39, 3, 184, 291, 415, 454, 75, 28, 107, 347, 421, 166, 224, 279, 16, 342, 206, 207, 171, 368, 198, 456, 464, 406, 365, 151, 320, 161, 9, 89, 479, 142, 259, 401, 232, 523, 449, 150, 218, 15, 97, 287, 133, 458, 221, 63, 185, 350, 74, 135, 404, 466, 214, 116, 507, 355, 213, 178, 318, 423, 126, 395, 465, 440, 452, 157, 366, 190, 343, 467, 247, 509, 91, 205, 114, 193, 409, 375, 269, 373, 389, 148, 69, 396, 398, 317, 145, 122, 147, 512, 32, 130, 386, 94, 435, 310, 57, 422, 308, 305, 217, 8, 154, 156, 309, 223, 44, 24, 82, 160, 392, 477, 356, 134, 54, 138, 378, 331, 379, 250, 96, 489, 306, 399, 46, 18, 283, 470, 21, 360, 209, 168, 495, 180, 514, 191, 270, 510, 381, 186, 442, 31, 390, 5, 85, 92, 363, 33, 127, 197, 285, 380, 265, 48, 352, 505, 208, 438, 329, 468, 282, 45, 159, 301, 362, 341, 65, 263, 393, 222, 521, 175, 293, 37, 490, 35], 60) 912396759652812740801869061695733452669218533249083289698313292427681899514848561025221753354562922565560034
</code></pre></div>
<hr />
<p>首先读代码</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1"></a><a href="#__codelineno-28-1"><span class="linenos" data-linenos=" 1 "></span></a>#生成三个随机数，数据范围很小，属于可爆破范围
<a id="__codelineno-28-2" name="__codelineno-28-2"></a><a href="#__codelineno-28-2"><span class="linenos" data-linenos=" 2 "></span></a>kbits, k, num = random.randrange(64), random.randrange(16), random.randrange(400, 600)
<a id="__codelineno-28-3" name="__codelineno-28-3"></a><a href="#__codelineno-28-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-28-4" name="__codelineno-28-4"></a><a href="#__codelineno-28-4"><span class="linenos" data-linenos=" 4 "></span></a>#生成624个不大于28bits的随机数，打包进state里
<a id="__codelineno-28-5" name="__codelineno-28-5"></a><a href="#__codelineno-28-5"><span class="linenos" data-linenos=" 5 "></span></a>seed = [(random.getrandbits(kbits) &gt;&gt; k) &amp; 0xfffffff for i in range(624)]
<a id="__codelineno-28-6" name="__codelineno-28-6"></a><a href="#__codelineno-28-6"><span class="linenos" data-linenos=" 6 "></span></a>state = (3, tuple(seed + [0]), None)
<a id="__codelineno-28-7" name="__codelineno-28-7"></a><a href="#__codelineno-28-7"><span class="linenos" data-linenos=" 7 "></span></a>
<a id="__codelineno-28-8" name="__codelineno-28-8"></a><a href="#__codelineno-28-8"><span class="linenos" data-linenos=" 8 "></span></a>#设置随机数内部状态
<a id="__codelineno-28-9" name="__codelineno-28-9"></a><a href="#__codelineno-28-9"><span class="linenos" data-linenos=" 9 "></span></a>random.setstate(state)
<a id="__codelineno-28-10" name="__codelineno-28-10"></a><a href="#__codelineno-28-10"><span class="linenos" data-linenos="10 "></span></a>
<a id="__codelineno-28-11" name="__codelineno-28-11"></a><a href="#__codelineno-28-11"><span class="linenos" data-linenos="11 "></span></a>#生成一个随机长度，随机大小的gift
<a id="__codelineno-28-12" name="__codelineno-28-12"></a><a href="#__codelineno-28-12"><span class="linenos" data-linenos="12 "></span></a>gift = [random.getrandbits(kbits) for i in range(num)]
<a id="__codelineno-28-13" name="__codelineno-28-13"></a><a href="#__codelineno-28-13"><span class="linenos" data-linenos="13 "></span></a>#生成一个e，不大于7bits
<a id="__codelineno-28-14" name="__codelineno-28-14"></a><a href="#__codelineno-28-14"><span class="linenos" data-linenos="14 "></span></a>e = random.getrandbits(7)
<a id="__codelineno-28-15" name="__codelineno-28-15"></a><a href="#__codelineno-28-15"><span class="linenos" data-linenos="15 "></span></a>l_num = num - e
<a id="__codelineno-28-16" name="__codelineno-28-16"></a><a href="#__codelineno-28-16"><span class="linenos" data-linenos="16 "></span></a>#将小于num的数构成一个列表，并打乱顺序
<a id="__codelineno-28-17" name="__codelineno-28-17"></a><a href="#__codelineno-28-17"><span class="linenos" data-linenos="17 "></span></a>s_box = list(range(num))
<a id="__codelineno-28-18" name="__codelineno-28-18"></a><a href="#__codelineno-28-18"><span class="linenos" data-linenos="18 "></span></a>random.shuffle(s_box)
<a id="__codelineno-28-19" name="__codelineno-28-19"></a><a href="#__codelineno-28-19"><span class="linenos" data-linenos="19 "></span></a>#把又是一个随机的数打包进gift
<a id="__codelineno-28-20" name="__codelineno-28-20"></a><a href="#__codelineno-28-20"><span class="linenos" data-linenos="20 "></span></a>l_gift = [gift[i] for i in s_box[:l_num]]
<a id="__codelineno-28-21" name="__codelineno-28-21"></a><a href="#__codelineno-28-21"><span class="linenos" data-linenos="21 "></span></a>gift = (l_gift, s_box[:l_num], e)
<a id="__codelineno-28-22" name="__codelineno-28-22"></a><a href="#__codelineno-28-22"><span class="linenos" data-linenos="22 "></span></a>
<a id="__codelineno-28-23" name="__codelineno-28-23"></a><a href="#__codelineno-28-23"><span class="linenos" data-linenos="23 "></span></a>#用一个随机的不大于28bits的数生成密钥
<a id="__codelineno-28-24" name="__codelineno-28-24"></a><a href="#__codelineno-28-24"><span class="linenos" data-linenos="24 "></span></a>key = bytes_to_long(md5(long_to_bytes(state[1][gift[2]])).digest())
<a id="__codelineno-28-25" name="__codelineno-28-25"></a><a href="#__codelineno-28-25"><span class="linenos" data-linenos="25 "></span></a>enc = bytes_to_long(flag) ^ key
<a id="__codelineno-28-26" name="__codelineno-28-26"></a><a href="#__codelineno-28-26"><span class="linenos" data-linenos="26 "></span></a>
<a id="__codelineno-28-27" name="__codelineno-28-27"></a><a href="#__codelineno-28-27"><span class="linenos" data-linenos="27 "></span></a>print(gift, enc)
</code></pre></div>
<p>读了半天，才发现前面的全是随机数的随机数，只有key的生成这一句有用，直接爆破一个大小不大于28bits的数即可</p>
<p>给了一堆gift，对于得到flag没有什么作用</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1"></a><a href="#__codelineno-29-1"><span class="linenos" data-linenos=" 1 "></span></a>from hashlib import md5
<a id="__codelineno-29-2" name="__codelineno-29-2"></a><a href="#__codelineno-29-2"><span class="linenos" data-linenos=" 2 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-29-3" name="__codelineno-29-3"></a><a href="#__codelineno-29-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-29-4" name="__codelineno-29-4"></a><a href="#__codelineno-29-4"><span class="linenos" data-linenos=" 4 "></span></a>enc = 912396759652812740801869061695733452669218533249083289698313292427681899514848561025221753354562922565560034
<a id="__codelineno-29-5" name="__codelineno-29-5"></a><a href="#__codelineno-29-5"><span class="linenos" data-linenos=" 5 "></span></a>
<a id="__codelineno-29-6" name="__codelineno-29-6"></a><a href="#__codelineno-29-6"><span class="linenos" data-linenos=" 6 "></span></a>for i in range( int(0xfffffff)+1 ):
<a id="__codelineno-29-7" name="__codelineno-29-7"></a><a href="#__codelineno-29-7"><span class="linenos" data-linenos=" 7 "></span></a>    key = bytes_to_long(md5(long_to_bytes(i)).digest())
<a id="__codelineno-29-8" name="__codelineno-29-8"></a><a href="#__codelineno-29-8"><span class="linenos" data-linenos=" 8 "></span></a>    flag = long_to_bytes(key^enc)
<a id="__codelineno-29-9" name="__codelineno-29-9"></a><a href="#__codelineno-29-9"><span class="linenos" data-linenos=" 9 "></span></a>    if &quot;\\&quot; in str(flag):
<a id="__codelineno-29-10" name="__codelineno-29-10"></a><a href="#__codelineno-29-10"><span class="linenos" data-linenos="10 "></span></a>        continue
<a id="__codelineno-29-11" name="__codelineno-29-11"></a><a href="#__codelineno-29-11"><span class="linenos" data-linenos="11 "></span></a>    else:
<a id="__codelineno-29-12" name="__codelineno-29-12"></a><a href="#__codelineno-29-12"><span class="linenos" data-linenos="12 "></span></a>        print( i , flag )
</code></pre></div>
<p>由于数据量过大，直接查关键字<code>ctfshow</code>出现的数据过多，而table我又不会用，故可以直接查找不存在十六进制无法翻译成字符的，可以得到flag</p>
<p><img alt="" src="asserts\image-20240111155315912.png" /></p>
<p>找出一个没有奇怪字符、大括号在最后面的即为flag</p>
<p>观赏了学长的代码，巧妙地运用了table，不用手动选择flag了（不过时间复杂度一样，都是线性的）</p>
<p>还有tqdm，有了它，就可以看到进度条了（不过不知道为什么我的电脑上用tqdm总是卡崩掉）</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1"></a><a href="#__codelineno-30-1"><span class="linenos" data-linenos=" 1 "></span></a>from tqdm import tqdm
<a id="__codelineno-30-2" name="__codelineno-30-2"></a><a href="#__codelineno-30-2"><span class="linenos" data-linenos=" 2 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-30-3" name="__codelineno-30-3"></a><a href="#__codelineno-30-3"><span class="linenos" data-linenos=" 3 "></span></a>from hashlib import md5
<a id="__codelineno-30-4" name="__codelineno-30-4"></a><a href="#__codelineno-30-4"><span class="linenos" data-linenos=" 4 "></span></a>import string
<a id="__codelineno-30-5" name="__codelineno-30-5"></a><a href="#__codelineno-30-5"><span class="linenos" data-linenos=" 5 "></span></a>
<a id="__codelineno-30-6" name="__codelineno-30-6"></a><a href="#__codelineno-30-6"><span class="linenos" data-linenos=" 6 "></span></a>def dec(num):
<a id="__codelineno-30-7" name="__codelineno-30-7"></a><a href="#__codelineno-30-7"><span class="linenos" data-linenos=" 7 "></span></a>    num = int(num)
<a id="__codelineno-30-8" name="__codelineno-30-8"></a><a href="#__codelineno-30-8"><span class="linenos" data-linenos=" 8 "></span></a>    key = bytes_to_long(md5(long_to_bytes(num)).digest())
<a id="__codelineno-30-9" name="__codelineno-30-9"></a><a href="#__codelineno-30-9"><span class="linenos" data-linenos=" 9 "></span></a>    m = enc ^ key
<a id="__codelineno-30-10" name="__codelineno-30-10"></a><a href="#__codelineno-30-10"><span class="linenos" data-linenos="10 "></span></a>    m = long_to_bytes(m)
<a id="__codelineno-30-11" name="__codelineno-30-11"></a><a href="#__codelineno-30-11"><span class="linenos" data-linenos="11 "></span></a>    try:
<a id="__codelineno-30-12" name="__codelineno-30-12"></a><a href="#__codelineno-30-12"><span class="linenos" data-linenos="12 "></span></a>        flag = m.decode()
<a id="__codelineno-30-13" name="__codelineno-30-13"></a><a href="#__codelineno-30-13"><span class="linenos" data-linenos="13 "></span></a>        if all(f in table for f in flag):
<a id="__codelineno-30-14" name="__codelineno-30-14"></a><a href="#__codelineno-30-14"><span class="linenos" data-linenos="14 "></span></a>            print(flag)
<a id="__codelineno-30-15" name="__codelineno-30-15"></a><a href="#__codelineno-30-15"><span class="linenos" data-linenos="15 "></span></a>            print(f&quot;num = {num}&quot;)
<a id="__codelineno-30-16" name="__codelineno-30-16"></a><a href="#__codelineno-30-16"><span class="linenos" data-linenos="16 "></span></a>    except:
<a id="__codelineno-30-17" name="__codelineno-30-17"></a><a href="#__codelineno-30-17"><span class="linenos" data-linenos="17 "></span></a>        return
<a id="__codelineno-30-18" name="__codelineno-30-18"></a><a href="#__codelineno-30-18"><span class="linenos" data-linenos="18 "></span></a>
<a id="__codelineno-30-19" name="__codelineno-30-19"></a><a href="#__codelineno-30-19"><span class="linenos" data-linenos="19 "></span></a>table = string.ascii_letters + &#39;0123456789_-{}&#39;
<a id="__codelineno-30-20" name="__codelineno-30-20"></a><a href="#__codelineno-30-20"><span class="linenos" data-linenos="20 "></span></a>
<a id="__codelineno-30-21" name="__codelineno-30-21"></a><a href="#__codelineno-30-21"><span class="linenos" data-linenos="21 "></span></a>enc = 912396759652812740801869061695733452669218533249083289698313292427681899514848561025221753354562922565560034
<a id="__codelineno-30-22" name="__codelineno-30-22"></a><a href="#__codelineno-30-22"><span class="linenos" data-linenos="22 "></span></a>
<a id="__codelineno-30-23" name="__codelineno-30-23"></a><a href="#__codelineno-30-23"><span class="linenos" data-linenos="23 "></span></a>for i in tqdm(range(0xfffffff+1)):
<a id="__codelineno-30-24" name="__codelineno-30-24"></a><a href="#__codelineno-30-24"><span class="linenos" data-linenos="24 "></span></a>    dec(i)
</code></pre></div>
<p>flag:<code>ctfshow{F2AD971D-66C2-2D1D-69D6-CE7DE2A49B35}</code></p>
<h3 id="ctfshow">[CTFshow元旦水友赛]哪位师傅知道这个是什么密码啊？<a class="headerlink" href="#ctfshow" title="Permanent link">&para;</a></h3>
<p><img alt="" src="asserts\image-20240113000226608.png" /></p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1"></a><a href="#__codelineno-31-1"><span class="linenos" data-linenos=" 1 "></span></a>import os
<a id="__codelineno-31-2" name="__codelineno-31-2"></a><a href="#__codelineno-31-2"><span class="linenos" data-linenos=" 2 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-31-3" name="__codelineno-31-3"></a><a href="#__codelineno-31-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-31-4" name="__codelineno-31-4"></a><a href="#__codelineno-31-4"><span class="linenos" data-linenos=" 4 "></span></a>F = lambda x: x * F(x-1) if x &gt; 0 else 1
<a id="__codelineno-31-5" name="__codelineno-31-5"></a><a href="#__codelineno-31-5"><span class="linenos" data-linenos=" 5 "></span></a>G = lambda x, y: F(x) // (F(y) * F(x-y))
<a id="__codelineno-31-6" name="__codelineno-31-6"></a><a href="#__codelineno-31-6"><span class="linenos" data-linenos=" 6 "></span></a>
<a id="__codelineno-31-7" name="__codelineno-31-7"></a><a href="#__codelineno-31-7"><span class="linenos" data-linenos=" 7 "></span></a>def get_keys(n: int):
<a id="__codelineno-31-8" name="__codelineno-31-8"></a><a href="#__codelineno-31-8"><span class="linenos" data-linenos=" 8 "></span></a>    p = getPrime(-11+45-14)
<a id="__codelineno-31-9" name="__codelineno-31-9"></a><a href="#__codelineno-31-9"><span class="linenos" data-linenos=" 9 "></span></a>    print(&#39;Please wait...&#39;)
<a id="__codelineno-31-10" name="__codelineno-31-10"></a><a href="#__codelineno-31-10"><span class="linenos" data-linenos="10 "></span></a>    s_list, t_list, u_list = [], [], []
<a id="__codelineno-31-11" name="__codelineno-31-11"></a><a href="#__codelineno-31-11"><span class="linenos" data-linenos="11 "></span></a>    for i in range(n):
<a id="__codelineno-31-12" name="__codelineno-31-12"></a><a href="#__codelineno-31-12"><span class="linenos" data-linenos="12 "></span></a>        print(f&#39;Progress: {i+1} / {n}&#39;)
<a id="__codelineno-31-13" name="__codelineno-31-13"></a><a href="#__codelineno-31-13"><span class="linenos" data-linenos="13 "></span></a>        while True:
<a id="__codelineno-31-14" name="__codelineno-31-14"></a><a href="#__codelineno-31-14"><span class="linenos" data-linenos="14 "></span></a>            t, s = sorted(getPrime(101) for _ in &#39;NB&#39;)
<a id="__codelineno-31-15" name="__codelineno-31-15"></a><a href="#__codelineno-31-15"><span class="linenos" data-linenos="15 "></span></a>            u = (G(s, t) % p) &amp; 0xFF
<a id="__codelineno-31-16" name="__codelineno-31-16"></a><a href="#__codelineno-31-16"><span class="linenos" data-linenos="16 "></span></a>            if (u != 0):
<a id="__codelineno-31-17" name="__codelineno-31-17"></a><a href="#__codelineno-31-17"><span class="linenos" data-linenos="17 "></span></a>                s_list.append(s)
<a id="__codelineno-31-18" name="__codelineno-31-18"></a><a href="#__codelineno-31-18"><span class="linenos" data-linenos="18 "></span></a>                t_list.append(t)
<a id="__codelineno-31-19" name="__codelineno-31-19"></a><a href="#__codelineno-31-19"><span class="linenos" data-linenos="19 "></span></a>                u_list.append(u)
<a id="__codelineno-31-20" name="__codelineno-31-20"></a><a href="#__codelineno-31-20"><span class="linenos" data-linenos="20 "></span></a>                break
<a id="__codelineno-31-21" name="__codelineno-31-21"></a><a href="#__codelineno-31-21"><span class="linenos" data-linenos="21 "></span></a>    return (s_list, t_list, p), u_list 
<a id="__codelineno-31-22" name="__codelineno-31-22"></a><a href="#__codelineno-31-22"><span class="linenos" data-linenos="22 "></span></a>
<a id="__codelineno-31-23" name="__codelineno-31-23"></a><a href="#__codelineno-31-23"><span class="linenos" data-linenos="23 "></span></a>FLAG = os.getenv(&#39;FLAG&#39;, &#39;ctfshow{never_gonna_give_you_flag}&#39;)
<a id="__codelineno-31-24" name="__codelineno-31-24"></a><a href="#__codelineno-31-24"><span class="linenos" data-linenos="24 "></span></a>print( FLAG )
<a id="__codelineno-31-25" name="__codelineno-31-25"></a><a href="#__codelineno-31-25"><span class="linenos" data-linenos="25 "></span></a>pubkey, privkey = get_keys(len(FLAG))
<a id="__codelineno-31-26" name="__codelineno-31-26"></a><a href="#__codelineno-31-26"><span class="linenos" data-linenos="26 "></span></a>print( pubkey, privkey )
<a id="__codelineno-31-27" name="__codelineno-31-27"></a><a href="#__codelineno-31-27"><span class="linenos" data-linenos="27 "></span></a>ciphertext = bytes(x ^ k for x, k in zip(FLAG.encode(), privkey))
<a id="__codelineno-31-28" name="__codelineno-31-28"></a><a href="#__codelineno-31-28"><span class="linenos" data-linenos="28 "></span></a>print(f&#39;{pubkey = }&#39;)
<a id="__codelineno-31-29" name="__codelineno-31-29"></a><a href="#__codelineno-31-29"><span class="linenos" data-linenos="29 "></span></a>print(f&#39;{ciphertext.hex() = }&#39;)
</code></pre></div>
<hr />
<p>F是阶乘，G是组合数的计算过程</p>
<p><a href="https://oi-wiki.org/math/number-theory/lucas/">卢卡斯定理（OI-wiki）</a></p>
<p><img alt="" src="asserts\image-20240113001008310.png" /></p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1"></a><a href="#__codelineno-32-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-32-2" name="__codelineno-32-2"></a><a href="#__codelineno-32-2"><span class="linenos" data-linenos=" 2 "></span></a>from Crypto.Util.number import long_to_bytes
<a id="__codelineno-32-3" name="__codelineno-32-3"></a><a href="#__codelineno-32-3"><span class="linenos" data-linenos=" 3 "></span></a>import gmpy2
<a id="__codelineno-32-4" name="__codelineno-32-4"></a><a href="#__codelineno-32-4"><span class="linenos" data-linenos=" 4 "></span></a>
<a id="__codelineno-32-5" name="__codelineno-32-5"></a><a href="#__codelineno-32-5"><span class="linenos" data-linenos=" 5 "></span></a>pubkey = ([2244095333388513367565281205621, 2260083173627571225575272017643, 2232571619487249695276209431911, 1366892418499855676258266570183, 2453504829447242891596294199551, 1749886540398964782388250510153, 2400368813718195311072803190537, 2412199908745985611198006411271, 2136151769918417200012573467547, 2188326070621506831342201179489, 2490975888687886171609455918979, 2520972296586880497850481220517, 2505441601685892494158922143537, 2223691958889488499464345149631, 2419970291634469073461115862923, 1913431629076248544274472723887, 1516525599480634064271895075589, 1748534379194448515689583072903, 2254654291529452465905257115983, 2036853065650744279222351374007, 1942468846337869648732525843309, 2201940065043223214975123483717, 2420554654468916631069996311243, 1578933527329599278882739520739, 2185608727926152268827042689247, 2138991356060432718559850740837, 1993202582269353654593882658857, 1851957155599032687165578632711, 1675430935325353825921279241939, 1539732791462031791764734543397, 1452444069464058198195009866663, 1853102085689472930613090539653, 2422886163436887722911429199407, 2478151413643348620173265601687, 2081728653302754258684980999897, 1869475969698886966223998022243, 2514233209214621717689871577799, 1565641057982670427875243690007, 2470941525500295562801927618117, 1957593611795889447618691712899, 2380166810104233903974756831281, 2310844976072657607087683813659, 2138906021714896472557340201269, 2133283066222174180401711231107, 2307615052065649723749209072291], [1950345581706607236958613312239, 1513963021166149007673751427809, 2209549849936350178706915353711, 1282304331826641551367349314389, 1285901314103578143578261497933, 1732171004069526252052648123229, 1885905081824428587397820753449, 2156360504061214962564655540577, 2114387282072764844800146882587, 1713540614501303042289450513031, 1718611954585760080721231776949, 2395901674478208382890220594709, 1953786497785706690568567652501, 1434952765892339228311211916623, 1434633435633106679937918543013, 1272002714370288579710832521801, 1345903574845925448968871221921, 1599178580175752823633130749379, 2050880877544639868041580689117, 1268507788047119658102789429151, 1550740527937339681775447782103, 2026060127920636700353677740333, 2320801697813895006451348616587, 1489309276821468831592096904009, 1343134452830065788367338410993, 1825449623429915829785766822487, 1385771207130987392492516965847, 1681955135857458220104835916897, 1608580883454393934111909197727, 1417761672076182691155757676783, 1339284864034936616590020649969, 1741000210994367137067807994129, 1416704333290652593089933548759, 1833600804996263316791298228287, 1740533709307600192323357511421, 1516475145585568797228308698679, 2284536672877756851447268908997, 1271126734775727764840925368047, 1674941925848400149104085993761, 1826602689042665336846528498857, 1987838509832756026588063009051, 1689378070597281801400506154393, 1490675164221922597195547712943, 1601946500767026172849726987951, 2081320371490185790723799153587], 560113)
<a id="__codelineno-32-6" name="__codelineno-32-6"></a><a href="#__codelineno-32-6"><span class="linenos" data-linenos=" 6 "></span></a>ciphertext = int(&#39;8b232301d0d8b5a681c1c982b04763b8765a8bbfb2bdf7332d0990f2a04b487dff3ffb0c6f1b1faefcd3037cf7&#39;,16)
<a id="__codelineno-32-7" name="__codelineno-32-7"></a><a href="#__codelineno-32-7"><span class="linenos" data-linenos=" 7 "></span></a>( s_list , t_list , p ) = pubkey
<a id="__codelineno-32-8" name="__codelineno-32-8"></a><a href="#__codelineno-32-8"><span class="linenos" data-linenos=" 8 "></span></a>
<a id="__codelineno-32-9" name="__codelineno-32-9"></a><a href="#__codelineno-32-9"><span class="linenos" data-linenos=" 9 "></span></a>def C( n , m , p ):
<a id="__codelineno-32-10" name="__codelineno-32-10"></a><a href="#__codelineno-32-10"><span class="linenos" data-linenos="10 "></span></a>    up , down = 1 , 1
<a id="__codelineno-32-11" name="__codelineno-32-11"></a><a href="#__codelineno-32-11"><span class="linenos" data-linenos="11 "></span></a>    for i in range( n - m + 1 , n + 1 ):
<a id="__codelineno-32-12" name="__codelineno-32-12"></a><a href="#__codelineno-32-12"><span class="linenos" data-linenos="12 "></span></a>        up = up * i % p
<a id="__codelineno-32-13" name="__codelineno-32-13"></a><a href="#__codelineno-32-13"><span class="linenos" data-linenos="13 "></span></a>    for i in range( 1 , m + 1 ):
<a id="__codelineno-32-14" name="__codelineno-32-14"></a><a href="#__codelineno-32-14"><span class="linenos" data-linenos="14 "></span></a>        down = down * i % p
<a id="__codelineno-32-15" name="__codelineno-32-15"></a><a href="#__codelineno-32-15"><span class="linenos" data-linenos="15 "></span></a>    return up * gmpy2.invert( down , p ) % p
<a id="__codelineno-32-16" name="__codelineno-32-16"></a><a href="#__codelineno-32-16"><span class="linenos" data-linenos="16 "></span></a>
<a id="__codelineno-32-17" name="__codelineno-32-17"></a><a href="#__codelineno-32-17"><span class="linenos" data-linenos="17 "></span></a>def lucas( n , m , p ):
<a id="__codelineno-32-18" name="__codelineno-32-18"></a><a href="#__codelineno-32-18"><span class="linenos" data-linenos="18 "></span></a>    if m == 0:
<a id="__codelineno-32-19" name="__codelineno-32-19"></a><a href="#__codelineno-32-19"><span class="linenos" data-linenos="19 "></span></a>        return 1
<a id="__codelineno-32-20" name="__codelineno-32-20"></a><a href="#__codelineno-32-20"><span class="linenos" data-linenos="20 "></span></a>    return C( n % p , m % p , p ) * lucas( n // p , m // p , p ) % p
<a id="__codelineno-32-21" name="__codelineno-32-21"></a><a href="#__codelineno-32-21"><span class="linenos" data-linenos="21 "></span></a>
<a id="__codelineno-32-22" name="__codelineno-32-22"></a><a href="#__codelineno-32-22"><span class="linenos" data-linenos="22 "></span></a>
<a id="__codelineno-32-23" name="__codelineno-32-23"></a><a href="#__codelineno-32-23"><span class="linenos" data-linenos="23 "></span></a>u_list = []
<a id="__codelineno-32-24" name="__codelineno-32-24"></a><a href="#__codelineno-32-24"><span class="linenos" data-linenos="24 "></span></a>for s,t in zip(s_list,t_list):
<a id="__codelineno-32-25" name="__codelineno-32-25"></a><a href="#__codelineno-32-25"><span class="linenos" data-linenos="25 "></span></a>    u_list.append( lucas(s,t,p) &amp; 0xFF )
<a id="__codelineno-32-26" name="__codelineno-32-26"></a><a href="#__codelineno-32-26"><span class="linenos" data-linenos="26 "></span></a>
<a id="__codelineno-32-27" name="__codelineno-32-27"></a><a href="#__codelineno-32-27"><span class="linenos" data-linenos="27 "></span></a>flag = bytes(x ^ k for x, k in zip(long_to_bytes(ciphertext), u_list))
<a id="__codelineno-32-28" name="__codelineno-32-28"></a><a href="#__codelineno-32-28"><span class="linenos" data-linenos="28 "></span></a>print(flag)
</code></pre></div>
<p>flag:<code>ctfshow{a786316f-b09b-4b83-b52c-8e20ef3c23d7}</code>（动态）</p>
<p><img alt="" src="asserts\image-20240113002329237.png" /></p>
<p>首次完整复盘了一场比赛的所有密码学题。</p>
<p>后续还需要完善的，有<code>sign_rand</code>的正解部分和<code>哪位师傅知道这个是什么？</code>的卢卡斯定理的推到和拓展卢卡斯定理</p>
<h3 id="buuctfgwctf2019babyrsa">[BUUCTF·GWCTF2019]BabyRSA<a class="headerlink" href="#buuctfgwctf2019babyrsa" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1"></a><a href="#__codelineno-33-1"><span class="linenos" data-linenos=" 1 "></span></a>import hashlib
<a id="__codelineno-33-2" name="__codelineno-33-2"></a><a href="#__codelineno-33-2"><span class="linenos" data-linenos=" 2 "></span></a>import sympy
<a id="__codelineno-33-3" name="__codelineno-33-3"></a><a href="#__codelineno-33-3"><span class="linenos" data-linenos=" 3 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-33-4" name="__codelineno-33-4"></a><a href="#__codelineno-33-4"><span class="linenos" data-linenos=" 4 "></span></a>
<a id="__codelineno-33-5" name="__codelineno-33-5"></a><a href="#__codelineno-33-5"><span class="linenos" data-linenos=" 5 "></span></a>flag = &#39;GWHT{******}&#39;
<a id="__codelineno-33-6" name="__codelineno-33-6"></a><a href="#__codelineno-33-6"><span class="linenos" data-linenos=" 6 "></span></a>secret = &#39;******&#39;
<a id="__codelineno-33-7" name="__codelineno-33-7"></a><a href="#__codelineno-33-7"><span class="linenos" data-linenos=" 7 "></span></a>
<a id="__codelineno-33-8" name="__codelineno-33-8"></a><a href="#__codelineno-33-8"><span class="linenos" data-linenos=" 8 "></span></a>assert(len(flag) == 38)
<a id="__codelineno-33-9" name="__codelineno-33-9"></a><a href="#__codelineno-33-9"><span class="linenos" data-linenos=" 9 "></span></a>
<a id="__codelineno-33-10" name="__codelineno-33-10"></a><a href="#__codelineno-33-10"><span class="linenos" data-linenos="10 "></span></a>half = len(flag) / 2
<a id="__codelineno-33-11" name="__codelineno-33-11"></a><a href="#__codelineno-33-11"><span class="linenos" data-linenos="11 "></span></a>
<a id="__codelineno-33-12" name="__codelineno-33-12"></a><a href="#__codelineno-33-12"><span class="linenos" data-linenos="12 "></span></a>flag1 = flag[:half]
<a id="__codelineno-33-13" name="__codelineno-33-13"></a><a href="#__codelineno-33-13"><span class="linenos" data-linenos="13 "></span></a>flag2 = flag[half:]
<a id="__codelineno-33-14" name="__codelineno-33-14"></a><a href="#__codelineno-33-14"><span class="linenos" data-linenos="14 "></span></a>
<a id="__codelineno-33-15" name="__codelineno-33-15"></a><a href="#__codelineno-33-15"><span class="linenos" data-linenos="15 "></span></a>secret_num = getPrime(1024) * bytes_to_long(secret)
<a id="__codelineno-33-16" name="__codelineno-33-16"></a><a href="#__codelineno-33-16"><span class="linenos" data-linenos="16 "></span></a>
<a id="__codelineno-33-17" name="__codelineno-33-17"></a><a href="#__codelineno-33-17"><span class="linenos" data-linenos="17 "></span></a>p = sympy.nextprime(secret_num)
<a id="__codelineno-33-18" name="__codelineno-33-18"></a><a href="#__codelineno-33-18"><span class="linenos" data-linenos="18 "></span></a>q = sympy.nextprime(p)
<a id="__codelineno-33-19" name="__codelineno-33-19"></a><a href="#__codelineno-33-19"><span class="linenos" data-linenos="19 "></span></a>
<a id="__codelineno-33-20" name="__codelineno-33-20"></a><a href="#__codelineno-33-20"><span class="linenos" data-linenos="20 "></span></a>N = p * q
<a id="__codelineno-33-21" name="__codelineno-33-21"></a><a href="#__codelineno-33-21"><span class="linenos" data-linenos="21 "></span></a>
<a id="__codelineno-33-22" name="__codelineno-33-22"></a><a href="#__codelineno-33-22"><span class="linenos" data-linenos="22 "></span></a>e = 0x10001
<a id="__codelineno-33-23" name="__codelineno-33-23"></a><a href="#__codelineno-33-23"><span class="linenos" data-linenos="23 "></span></a>
<a id="__codelineno-33-24" name="__codelineno-33-24"></a><a href="#__codelineno-33-24"><span class="linenos" data-linenos="24 "></span></a>F1 = bytes_to_long(flag1)
<a id="__codelineno-33-25" name="__codelineno-33-25"></a><a href="#__codelineno-33-25"><span class="linenos" data-linenos="25 "></span></a>F2 = bytes_to_long(flag2)
<a id="__codelineno-33-26" name="__codelineno-33-26"></a><a href="#__codelineno-33-26"><span class="linenos" data-linenos="26 "></span></a>
<a id="__codelineno-33-27" name="__codelineno-33-27"></a><a href="#__codelineno-33-27"><span class="linenos" data-linenos="27 "></span></a>c1 = F1 + F2
<a id="__codelineno-33-28" name="__codelineno-33-28"></a><a href="#__codelineno-33-28"><span class="linenos" data-linenos="28 "></span></a>c2 = pow(F1, 3) + pow(F2, 3)
<a id="__codelineno-33-29" name="__codelineno-33-29"></a><a href="#__codelineno-33-29"><span class="linenos" data-linenos="29 "></span></a>assert(c2 &lt; N)
<a id="__codelineno-33-30" name="__codelineno-33-30"></a><a href="#__codelineno-33-30"><span class="linenos" data-linenos="30 "></span></a>
<a id="__codelineno-33-31" name="__codelineno-33-31"></a><a href="#__codelineno-33-31"><span class="linenos" data-linenos="31 "></span></a>m1 = pow(c1, e, N)
<a id="__codelineno-33-32" name="__codelineno-33-32"></a><a href="#__codelineno-33-32"><span class="linenos" data-linenos="32 "></span></a>m2 = pow(c2, e, N)
<a id="__codelineno-33-33" name="__codelineno-33-33"></a><a href="#__codelineno-33-33"><span class="linenos" data-linenos="33 "></span></a>
<a id="__codelineno-33-34" name="__codelineno-33-34"></a><a href="#__codelineno-33-34"><span class="linenos" data-linenos="34 "></span></a>output = open(&#39;secret&#39;, &#39;w&#39;)
<a id="__codelineno-33-35" name="__codelineno-33-35"></a><a href="#__codelineno-33-35"><span class="linenos" data-linenos="35 "></span></a>output.write(&#39;N=&#39; + str(N) + &#39;\n&#39;)
<a id="__codelineno-33-36" name="__codelineno-33-36"></a><a href="#__codelineno-33-36"><span class="linenos" data-linenos="36 "></span></a>output.write(&#39;m1=&#39; + str(m1) + &#39;\n&#39;)
<a id="__codelineno-33-37" name="__codelineno-33-37"></a><a href="#__codelineno-33-37"><span class="linenos" data-linenos="37 "></span></a>output.write(&#39;m2=&#39; + str(m2) + &#39;\n&#39;)
<a id="__codelineno-33-38" name="__codelineno-33-38"></a><a href="#__codelineno-33-38"><span class="linenos" data-linenos="38 "></span></a>output.close()
<a id="__codelineno-33-39" name="__codelineno-33-39"></a><a href="#__codelineno-33-39"><span class="linenos" data-linenos="39 "></span></a>&quot;&quot;&quot;
<a id="__codelineno-33-40" name="__codelineno-33-40"></a><a href="#__codelineno-33-40"><span class="linenos" data-linenos="40 "></span></a>N=636585149594574746909030160182690866222909256464847291783000651837227921337237899651287943597773270944384034858925295744880727101606841413640006527614873110651410155893776548737823152943797884729130149758279127430044739254000426610922834573094957082589539445610828279428814524313491262061930512829074466232633130599104490893572093943832740301809630847541592548921200288222432789208650949937638303429456468889100192613859073752923812454212239908948930178355331390933536771065791817643978763045030833712326162883810638120029378337092938662174119747687899484603628344079493556601422498405360731958162719296160584042671057160241284852522913676264596201906163
<a id="__codelineno-33-41" name="__codelineno-33-41"></a><a href="#__codelineno-33-41"><span class="linenos" data-linenos="41 "></span></a>m1=90009974341452243216986938028371257528604943208941176518717463554774967878152694586469377765296113165659498726012712288670458884373971419842750929287658640266219686646956929872115782173093979742958745121671928568709468526098715927189829600497283118051641107305128852697032053368115181216069626606165503465125725204875578701237789292966211824002761481815276666236869005129138862782476859103086726091860497614883282949955023222414333243193268564781621699870412557822404381213804026685831221430728290755597819259339616650158674713248841654338515199405532003173732520457813901170264713085107077001478083341339002069870585378257051150217511755761491021553239
<a id="__codelineno-33-42" name="__codelineno-33-42"></a><a href="#__codelineno-33-42"><span class="linenos" data-linenos="42 "></span></a>m2=487443985757405173426628188375657117604235507936967522993257972108872283698305238454465723214226871414276788912058186197039821242912736742824080627680971802511206914394672159240206910735850651999316100014691067295708138639363203596244693995562780286637116394738250774129759021080197323724805414668042318806010652814405078769738548913675466181551005527065309515364950610137206393257148357659666687091662749848560225453826362271704292692847596339533229088038820532086109421158575841077601268713175097874083536249006018948789413238783922845633494023608865256071962856581229890043896939025613600564283391329331452199062858930374565991634191495137939574539546
<a id="__codelineno-33-43" name="__codelineno-33-43"></a><a href="#__codelineno-33-43"><span class="linenos" data-linenos="43 "></span></a>&quot;&quot;&quot;
</code></pre></div>
<hr />
<p>p和q是相邻的质数，一眼yafu</p>
<p><img alt="" src="asserts\image-20240113134805626.png" /></p>
<p>成功分解</p>
<p>后面需要解方程 <span class="arithmatex">\(c_1=f_1+f_2 \ , \ c_2 = f_1^3 + f_2^3\)</span></p>
<p>使用python的solve函数即可求解</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1"></a><a href="#__codelineno-34-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import long_to_bytes
<a id="__codelineno-34-2" name="__codelineno-34-2"></a><a href="#__codelineno-34-2"><span class="linenos" data-linenos=" 2 "></span></a>from sympy import *
<a id="__codelineno-34-3" name="__codelineno-34-3"></a><a href="#__codelineno-34-3"><span class="linenos" data-linenos=" 3 "></span></a>from sympy.abc import x,y
<a id="__codelineno-34-4" name="__codelineno-34-4"></a><a href="#__codelineno-34-4"><span class="linenos" data-linenos=" 4 "></span></a>import gmpy2
<a id="__codelineno-34-5" name="__codelineno-34-5"></a><a href="#__codelineno-34-5"><span class="linenos" data-linenos=" 5 "></span></a>
<a id="__codelineno-34-6" name="__codelineno-34-6"></a><a href="#__codelineno-34-6"><span class="linenos" data-linenos=" 6 "></span></a>m1=90009974341452243216986938028371257528604943208941176518717463554774967878152694586469377765296113165659498726012712288670458884373971419842750929287658640266219686646956929872115782173093979742958745121671928568709468526098715927189829600497283118051641107305128852697032053368115181216069626606165503465125725204875578701237789292966211824002761481815276666236869005129138862782476859103086726091860497614883282949955023222414333243193268564781621699870412557822404381213804026685831221430728290755597819259339616650158674713248841654338515199405532003173732520457813901170264713085107077001478083341339002069870585378257051150217511755761491021553239
<a id="__codelineno-34-7" name="__codelineno-34-7"></a><a href="#__codelineno-34-7"><span class="linenos" data-linenos=" 7 "></span></a>m2=487443985757405173426628188375657117604235507936967522993257972108872283698305238454465723214226871414276788912058186197039821242912736742824080627680971802511206914394672159240206910735850651999316100014691067295708138639363203596244693995562780286637116394738250774129759021080197323724805414668042318806010652814405078769738548913675466181551005527065309515364950610137206393257148357659666687091662749848560225453826362271704292692847596339533229088038820532086109421158575841077601268713175097874083536249006018948789413238783922845633494023608865256071962856581229890043896939025613600564283391329331452199062858930374565991634191495137939574539546
<a id="__codelineno-34-8" name="__codelineno-34-8"></a><a href="#__codelineno-34-8"><span class="linenos" data-linenos=" 8 "></span></a>p = 797862863902421984951231350430312260517773269684958456342860983236184129602390919026048496119757187702076499551310794177917920137646835888862706126924088411570997141257159563952725882214181185531209186972351469946269508511312863779123205322378452194261217016552527754513215520329499967108196968833163329724620251096080377748737
<a id="__codelineno-34-9" name="__codelineno-34-9"></a><a href="#__codelineno-34-9"><span class="linenos" data-linenos=" 9 "></span></a>q = 797862863902421984951231350430312260517773269684958456342860983236184129602390919026048496119757187702076499551310794177917920137646835888862706126924088411570997141257159563952725882214181185531209186972351469946269508511312863779123205322378452194261217016552527754513215520329499967108196968833163329724620251096080377747699
<a id="__codelineno-34-10" name="__codelineno-34-10"></a><a href="#__codelineno-34-10"><span class="linenos" data-linenos="10 "></span></a>n = p * q ; phi = (p-1) * (q-1) ; e = 0x10001 ; d = gmpy2.invert( e , phi )
<a id="__codelineno-34-11" name="__codelineno-34-11"></a><a href="#__codelineno-34-11"><span class="linenos" data-linenos="11 "></span></a>c1 = pow( m1 , d , n ) ; c2 = pow( m2 , d , n )
<a id="__codelineno-34-12" name="__codelineno-34-12"></a><a href="#__codelineno-34-12"><span class="linenos" data-linenos="12 "></span></a>
<a id="__codelineno-34-13" name="__codelineno-34-13"></a><a href="#__codelineno-34-13"><span class="linenos" data-linenos="13 "></span></a>res = solve( [ x+y-c1 , pow(x,3)+pow(y,3)-c2 ] , [ x , y ] )
<a id="__codelineno-34-14" name="__codelineno-34-14"></a><a href="#__codelineno-34-14"><span class="linenos" data-linenos="14 "></span></a>print( long_to_bytes( res[0][1] ) + long_to_bytes( res[0][0] ) )
</code></pre></div>
<p>flag:<code>flag{f709e0e2cfe7e530ca8972959a1033b2}</code></p>
<h3 id="nssctf-round16-basicpr">[NSSCTF Round#16 Basic]pr<a class="headerlink" href="#nssctf-round16-basicpr" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1"></a><a href="#__codelineno-35-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-35-2" name="__codelineno-35-2"></a><a href="#__codelineno-35-2"><span class="linenos" data-linenos=" 2 "></span></a>import random
<a id="__codelineno-35-3" name="__codelineno-35-3"></a><a href="#__codelineno-35-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-35-4" name="__codelineno-35-4"></a><a href="#__codelineno-35-4"><span class="linenos" data-linenos=" 4 "></span></a>flag=plaintext = &#39;NSSCTF{****************}&#39;
<a id="__codelineno-35-5" name="__codelineno-35-5"></a><a href="#__codelineno-35-5"><span class="linenos" data-linenos=" 5 "></span></a>charset = &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;
<a id="__codelineno-35-6" name="__codelineno-35-6"></a><a href="#__codelineno-35-6"><span class="linenos" data-linenos=" 6 "></span></a>padding_length = 100 - len(plaintext)
<a id="__codelineno-35-7" name="__codelineno-35-7"></a><a href="#__codelineno-35-7"><span class="linenos" data-linenos=" 7 "></span></a>
<a id="__codelineno-35-8" name="__codelineno-35-8"></a><a href="#__codelineno-35-8"><span class="linenos" data-linenos=" 8 "></span></a>for _ in range(padding_length):
<a id="__codelineno-35-9" name="__codelineno-35-9"></a><a href="#__codelineno-35-9"><span class="linenos" data-linenos=" 9 "></span></a>    plaintext += random.choice(charset)
<a id="__codelineno-35-10" name="__codelineno-35-10"></a><a href="#__codelineno-35-10"><span class="linenos" data-linenos="10 "></span></a>
<a id="__codelineno-35-11" name="__codelineno-35-11"></a><a href="#__codelineno-35-11"><span class="linenos" data-linenos="11 "></span></a>public_exponent = 31413537523
<a id="__codelineno-35-12" name="__codelineno-35-12"></a><a href="#__codelineno-35-12"><span class="linenos" data-linenos="12 "></span></a>message = bytes_to_long(plaintext.encode())
<a id="__codelineno-35-13" name="__codelineno-35-13"></a><a href="#__codelineno-35-13"><span class="linenos" data-linenos="13 "></span></a>assert message &gt; (1 &lt;&lt; 512)
<a id="__codelineno-35-14" name="__codelineno-35-14"></a><a href="#__codelineno-35-14"><span class="linenos" data-linenos="14 "></span></a>assert message &lt; (1 &lt;&lt; 1024)
<a id="__codelineno-35-15" name="__codelineno-35-15"></a><a href="#__codelineno-35-15"><span class="linenos" data-linenos="15 "></span></a>
<a id="__codelineno-35-16" name="__codelineno-35-16"></a><a href="#__codelineno-35-16"><span class="linenos" data-linenos="16 "></span></a>prime_p = getPrime(512)
<a id="__codelineno-35-17" name="__codelineno-35-17"></a><a href="#__codelineno-35-17"><span class="linenos" data-linenos="17 "></span></a>prime_q = getPrime(512)
<a id="__codelineno-35-18" name="__codelineno-35-18"></a><a href="#__codelineno-35-18"><span class="linenos" data-linenos="18 "></span></a>prime_r = getPrime(512)
<a id="__codelineno-35-19" name="__codelineno-35-19"></a><a href="#__codelineno-35-19"><span class="linenos" data-linenos="19 "></span></a>n1 = prime_p * prime_q
<a id="__codelineno-35-20" name="__codelineno-35-20"></a><a href="#__codelineno-35-20"><span class="linenos" data-linenos="20 "></span></a>n2 = prime_q * prime_r
<a id="__codelineno-35-21" name="__codelineno-35-21"></a><a href="#__codelineno-35-21"><span class="linenos" data-linenos="21 "></span></a>ciphertext1 = pow(message, public_exponent, n1)
<a id="__codelineno-35-22" name="__codelineno-35-22"></a><a href="#__codelineno-35-22"><span class="linenos" data-linenos="22 "></span></a>ciphertext2 = pow(message, public_exponent, n2)
<a id="__codelineno-35-23" name="__codelineno-35-23"></a><a href="#__codelineno-35-23"><span class="linenos" data-linenos="23 "></span></a>print(&#39;c1=&#39;, ciphertext1)
<a id="__codelineno-35-24" name="__codelineno-35-24"></a><a href="#__codelineno-35-24"><span class="linenos" data-linenos="24 "></span></a>print(&#39;c2=&#39;, ciphertext2)
<a id="__codelineno-35-25" name="__codelineno-35-25"></a><a href="#__codelineno-35-25"><span class="linenos" data-linenos="25 "></span></a>print(&#39;p=&#39;, prime_p)
<a id="__codelineno-35-26" name="__codelineno-35-26"></a><a href="#__codelineno-35-26"><span class="linenos" data-linenos="26 "></span></a>print(&#39;r=&#39;, prime_r)
<a id="__codelineno-35-27" name="__codelineno-35-27"></a><a href="#__codelineno-35-27"><span class="linenos" data-linenos="27 "></span></a>print( plaintext )
<a id="__codelineno-35-28" name="__codelineno-35-28"></a><a href="#__codelineno-35-28"><span class="linenos" data-linenos="28 "></span></a>print( prime_q )
<a id="__codelineno-35-29" name="__codelineno-35-29"></a><a href="#__codelineno-35-29"><span class="linenos" data-linenos="29 "></span></a>
<a id="__codelineno-35-30" name="__codelineno-35-30"></a><a href="#__codelineno-35-30"><span class="linenos" data-linenos="30 "></span></a>
<a id="__codelineno-35-31" name="__codelineno-35-31"></a><a href="#__codelineno-35-31"><span class="linenos" data-linenos="31 "></span></a>&#39;&#39;&#39;
<a id="__codelineno-35-32" name="__codelineno-35-32"></a><a href="#__codelineno-35-32"><span class="linenos" data-linenos="32 "></span></a>c1= 36918910341116680090654563538246204134840776220077189276689868322808977412566781872132517635399441578464309667998925236488280867210758507758915311644529399878185776345227817559234605958783077866016808605942558810445187434690812992072238407431218047312484354859724174751718700409405142819140636116559320641695
<a id="__codelineno-35-33" name="__codelineno-35-33"></a><a href="#__codelineno-35-33"><span class="linenos" data-linenos="33 "></span></a>c2= 15601788304485903964195122196382181273808496834343051747331984997977255326224514191280515875796224074672957848566506948553165091090701291545031857563686815297483181025074113978465751897596411324331847008870832527695258040104858667684793196948970048750296571273364559767074262996595282324974180754813257013752
<a id="__codelineno-35-34" name="__codelineno-35-34"></a><a href="#__codelineno-35-34"><span class="linenos" data-linenos="34 "></span></a>p= 12101696894052331138951718202838643670037274599483776996203693662637821825873973767235442427190607145999472731101517998719984942030184683388441121181962123
<a id="__codelineno-35-35" name="__codelineno-35-35"></a><a href="#__codelineno-35-35"><span class="linenos" data-linenos="35 "></span></a>r= 10199001137987151966640837133782537428248507382360655526592866939552984259171772190788036403425837649697437126360866173688083643144865107648483668545682383
<a id="__codelineno-35-36" name="__codelineno-35-36"></a><a href="#__codelineno-35-36"><span class="linenos" data-linenos="36 "></span></a>&#39;&#39;&#39;
</code></pre></div>
<hr />
<p>赛时想到了crt，但是犯了低级错误，导致没有在赛时出flag---&gt;<img src="C:\Users\coper\AppData\Roaming\Typora\typora-user-images\image-20240113181842330.png" alt="image-20240113181842330" style="zoom: 33%;" /></p>
<p>也是因为对于模运算的性质掌握不够熟练，放弃crt之后一直想求q，因而一直没有出来</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1"></a><a href="#__codelineno-36-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-36-2" name="__codelineno-36-2"></a><a href="#__codelineno-36-2"><span class="linenos" data-linenos=" 2 "></span></a>import gmpy2
<a id="__codelineno-36-3" name="__codelineno-36-3"></a><a href="#__codelineno-36-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-36-4" name="__codelineno-36-4"></a><a href="#__codelineno-36-4"><span class="linenos" data-linenos=" 4 "></span></a>c1= 36918910341116680090654563538246204134840776220077189276689868322808977412566781872132517635399441578464309667998925236488280867210758507758915311644529399878185776345227817559234605958783077866016808605942558810445187434690812992072238407431218047312484354859724174751718700409405142819140636116559320641695
<a id="__codelineno-36-5" name="__codelineno-36-5"></a><a href="#__codelineno-36-5"><span class="linenos" data-linenos=" 5 "></span></a>c2= 15601788304485903964195122196382181273808496834343051747331984997977255326224514191280515875796224074672957848566506948553165091090701291545031857563686815297483181025074113978465751897596411324331847008870832527695258040104858667684793196948970048750296571273364559767074262996595282324974180754813257013752
<a id="__codelineno-36-6" name="__codelineno-36-6"></a><a href="#__codelineno-36-6"><span class="linenos" data-linenos=" 6 "></span></a>p= 12101696894052331138951718202838643670037274599483776996203693662637821825873973767235442427190607145999472731101517998719984942030184683388441121181962123
<a id="__codelineno-36-7" name="__codelineno-36-7"></a><a href="#__codelineno-36-7"><span class="linenos" data-linenos=" 7 "></span></a>r= 10199001137987151966640837133782537428248507382360655526592866939552984259171772190788036403425837649697437126360866173688083643144865107648483668545682383
<a id="__codelineno-36-8" name="__codelineno-36-8"></a><a href="#__codelineno-36-8"><span class="linenos" data-linenos=" 8 "></span></a>e = 31413537523
<a id="__codelineno-36-9" name="__codelineno-36-9"></a><a href="#__codelineno-36-9"><span class="linenos" data-linenos=" 9 "></span></a>
<a id="__codelineno-36-10" name="__codelineno-36-10"></a><a href="#__codelineno-36-10"><span class="linenos" data-linenos="10 "></span></a>def crtt( c , p ):
<a id="__codelineno-36-11" name="__codelineno-36-11"></a><a href="#__codelineno-36-11"><span class="linenos" data-linenos="11 "></span></a>    M = 1
<a id="__codelineno-36-12" name="__codelineno-36-12"></a><a href="#__codelineno-36-12"><span class="linenos" data-linenos="12 "></span></a>    for i in p:
<a id="__codelineno-36-13" name="__codelineno-36-13"></a><a href="#__codelineno-36-13"><span class="linenos" data-linenos="13 "></span></a>        M = M * i
<a id="__codelineno-36-14" name="__codelineno-36-14"></a><a href="#__codelineno-36-14"><span class="linenos" data-linenos="14 "></span></a>    m = []
<a id="__codelineno-36-15" name="__codelineno-36-15"></a><a href="#__codelineno-36-15"><span class="linenos" data-linenos="15 "></span></a>    for i in range(len(p)):
<a id="__codelineno-36-16" name="__codelineno-36-16"></a><a href="#__codelineno-36-16"><span class="linenos" data-linenos="16 "></span></a>        m.append(M // p[i])
<a id="__codelineno-36-17" name="__codelineno-36-17"></a><a href="#__codelineno-36-17"><span class="linenos" data-linenos="17 "></span></a>    x = 0
<a id="__codelineno-36-18" name="__codelineno-36-18"></a><a href="#__codelineno-36-18"><span class="linenos" data-linenos="18 "></span></a>    for i in range(len(c)):
<a id="__codelineno-36-19" name="__codelineno-36-19"></a><a href="#__codelineno-36-19"><span class="linenos" data-linenos="19 "></span></a>        x = x + c[i]*m[i]*gmpy2.invert(m[i],p[i])
<a id="__codelineno-36-20" name="__codelineno-36-20"></a><a href="#__codelineno-36-20"><span class="linenos" data-linenos="20 "></span></a>    return x % M
<a id="__codelineno-36-21" name="__codelineno-36-21"></a><a href="#__codelineno-36-21"><span class="linenos" data-linenos="21 "></span></a>
<a id="__codelineno-36-22" name="__codelineno-36-22"></a><a href="#__codelineno-36-22"><span class="linenos" data-linenos="22 "></span></a>c = crtt( [ c1 , c2 ] , [ p , r ] )
<a id="__codelineno-36-23" name="__codelineno-36-23"></a><a href="#__codelineno-36-23"><span class="linenos" data-linenos="23 "></span></a>phi = ( p-1 ) * (r-1)
<a id="__codelineno-36-24" name="__codelineno-36-24"></a><a href="#__codelineno-36-24"><span class="linenos" data-linenos="24 "></span></a>d = gmpy2.invert( e , phi )
<a id="__codelineno-36-25" name="__codelineno-36-25"></a><a href="#__codelineno-36-25"><span class="linenos" data-linenos="25 "></span></a>
<a id="__codelineno-36-26" name="__codelineno-36-26"></a><a href="#__codelineno-36-26"><span class="linenos" data-linenos="26 "></span></a>print( long_to_bytes(pow( c , d , p*r )) )
</code></pre></div>
<p>flag:<code>NSSCTF{yUanshEnx1ncHun2o23!}</code></p>
<h3 id="isctf2023">[isctf2023]七七的欧拉<a class="headerlink" href="#isctf2023" title="Permanent link">&para;</a></h3>
<p>使用大质数分解在线网站，得到 n=p^8</p>
<p>已知n=p<sup>x时，φ(n)=p</sup>x-p^(x-1)（欧拉函数的第二种快速计算方式）</p>
<p>则phi=p<sup>8-p</sup>7</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1"></a><a href="#__codelineno-37-1"><span class="linenos" data-linenos="1 "></span></a>import gmpy2
<a id="__codelineno-37-2" name="__codelineno-37-2"></a><a href="#__codelineno-37-2"><span class="linenos" data-linenos="2 "></span></a>from Crypto.Util.number import long_to_bytes
<a id="__codelineno-37-3" name="__codelineno-37-3"></a><a href="#__codelineno-37-3"><span class="linenos" data-linenos="3 "></span></a>e=
<a id="__codelineno-37-4" name="__codelineno-37-4"></a><a href="#__codelineno-37-4"><span class="linenos" data-linenos="4 "></span></a>n=
<a id="__codelineno-37-5" name="__codelineno-37-5"></a><a href="#__codelineno-37-5"><span class="linenos" data-linenos="5 "></span></a>c=
<a id="__codelineno-37-6" name="__codelineno-37-6"></a><a href="#__codelineno-37-6"><span class="linenos" data-linenos="6 "></span></a>p=
<a id="__codelineno-37-7" name="__codelineno-37-7"></a><a href="#__codelineno-37-7"><span class="linenos" data-linenos="7 "></span></a>phi = p**8-p**7
<a id="__codelineno-37-8" name="__codelineno-37-8"></a><a href="#__codelineno-37-8"><span class="linenos" data-linenos="8 "></span></a>d = gmpy2.invert( e , phi )
<a id="__codelineno-37-9" name="__codelineno-37-9"></a><a href="#__codelineno-37-9"><span class="linenos" data-linenos="9 "></span></a>print( long_to_bytes( pow(c,d,n) ) )
</code></pre></div>
<p>ISCTF{3237saq-21se82-3s74f8-8h84ps7-9qw45v7-6bs531-s26h23-c7iu01}</p>
<h3 id="isctf2023signin">[isctf2023]signin<a class="headerlink" href="#isctf2023signin" title="Permanent link">&para;</a></h3>
<p>Schmidt-Samoa密码系统</p>
<p>密钥生成：选取两个大质数，计算N=p^2*q；计算d=invert(N,φ(p*q))</p>
<p>加密：c=m^N mod N</p>
<p>解密：m=c^d mod p*q</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1"></a><a href="#__codelineno-38-1"><span class="linenos" data-linenos=" 1 "></span></a>import gmpy2
<a id="__codelineno-38-2" name="__codelineno-38-2"></a><a href="#__codelineno-38-2"><span class="linenos" data-linenos=" 2 "></span></a>
<a id="__codelineno-38-3" name="__codelineno-38-3"></a><a href="#__codelineno-38-3"><span class="linenos" data-linenos=" 3 "></span></a>c = 
<a id="__codelineno-38-4" name="__codelineno-38-4"></a><a href="#__codelineno-38-4"><span class="linenos" data-linenos=" 4 "></span></a>N = 
<a id="__codelineno-38-5" name="__codelineno-38-5"></a><a href="#__codelineno-38-5"><span class="linenos" data-linenos=" 5 "></span></a>d = 
<a id="__codelineno-38-6" name="__codelineno-38-6"></a><a href="#__codelineno-38-6"><span class="linenos" data-linenos=" 6 "></span></a>
<a id="__codelineno-38-7" name="__codelineno-38-7"></a><a href="#__codelineno-38-7"><span class="linenos" data-linenos=" 7 "></span></a>pq = gmpy2.gcd(pow(2,d*N,N) - 2,N)
<a id="__codelineno-38-8" name="__codelineno-38-8"></a><a href="#__codelineno-38-8"><span class="linenos" data-linenos=" 8 "></span></a>m = pow(c,d,pq)
<a id="__codelineno-38-9" name="__codelineno-38-9"></a><a href="#__codelineno-38-9"><span class="linenos" data-linenos=" 9 "></span></a>
<a id="__codelineno-38-10" name="__codelineno-38-10"></a><a href="#__codelineno-38-10"><span class="linenos" data-linenos="10 "></span></a>print( long_to_bytes(m) )
</code></pre></div>
<p>ISCTF{aeb8be10-ff19-42cf-8cfd-2ce71ac418e8}</p>
<h3 id="isctf2023easy_aes">[isctf2023]Easy_AES<a class="headerlink" href="#isctf2023easy_aes" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1"></a><a href="#__codelineno-39-1"><span class="linenos" data-linenos=" 1 "></span></a>import gmpy2
<a id="__codelineno-39-2" name="__codelineno-39-2"></a><a href="#__codelineno-39-2"><span class="linenos" data-linenos=" 2 "></span></a>from Crypto.Util.number import long_to_bytes
<a id="__codelineno-39-3" name="__codelineno-39-3"></a><a href="#__codelineno-39-3"><span class="linenos" data-linenos=" 3 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-39-4" name="__codelineno-39-4"></a><a href="#__codelineno-39-4"><span class="linenos" data-linenos=" 4 "></span></a>from Crypto.Cipher import AES
<a id="__codelineno-39-5" name="__codelineno-39-5"></a><a href="#__codelineno-39-5"><span class="linenos" data-linenos=" 5 "></span></a>import os
<a id="__codelineno-39-6" name="__codelineno-39-6"></a><a href="#__codelineno-39-6"><span class="linenos" data-linenos=" 6 "></span></a>
<a id="__codelineno-39-7" name="__codelineno-39-7"></a><a href="#__codelineno-39-7"><span class="linenos" data-linenos=" 7 "></span></a>flag = b&quot;ISCTF{&quot;
<a id="__codelineno-39-8" name="__codelineno-39-8"></a><a href="#__codelineno-39-8"><span class="linenos" data-linenos=" 8 "></span></a>key = b&quot;1513562561656285&quot;
<a id="__codelineno-39-9" name="__codelineno-39-9"></a><a href="#__codelineno-39-9"><span class="linenos" data-linenos=" 9 "></span></a>
<a id="__codelineno-39-10" name="__codelineno-39-10"></a><a href="#__codelineno-39-10"><span class="linenos" data-linenos="10 "></span></a>hint = int(b&#39;0x47405a4847405a48470000021a0f2870&#39;,16)
<a id="__codelineno-39-11" name="__codelineno-39-11"></a><a href="#__codelineno-39-11"><span class="linenos" data-linenos="11 "></span></a>
<a id="__codelineno-39-12" name="__codelineno-39-12"></a><a href="#__codelineno-39-12"><span class="linenos" data-linenos="12 "></span></a>print( hint )
<a id="__codelineno-39-13" name="__codelineno-39-13"></a><a href="#__codelineno-39-13"><span class="linenos" data-linenos="13 "></span></a>
<a id="__codelineno-39-14" name="__codelineno-39-14"></a><a href="#__codelineno-39-14"><span class="linenos" data-linenos="14 "></span></a>for i in range( 49 , 50 ):
<a id="__codelineno-39-15" name="__codelineno-39-15"></a><a href="#__codelineno-39-15"><span class="linenos" data-linenos="15 "></span></a>    t = b&quot;\t\t\t\t\t\t\t\t\t&quot; + flag + chr(i).encode()
<a id="__codelineno-39-16" name="__codelineno-39-16"></a><a href="#__codelineno-39-16"><span class="linenos" data-linenos="16 "></span></a>    print( chr(i) )
<a id="__codelineno-39-17" name="__codelineno-39-17"></a><a href="#__codelineno-39-17"><span class="linenos" data-linenos="17 "></span></a>    #print( bytes_to_long(t) ^ hint )
<a id="__codelineno-39-18" name="__codelineno-39-18"></a><a href="#__codelineno-39-18"><span class="linenos" data-linenos="18 "></span></a>    key = long_to_bytes( bytes_to_long(t) ^ hint )
<a id="__codelineno-39-19" name="__codelineno-39-19"></a><a href="#__codelineno-39-19"><span class="linenos" data-linenos="19 "></span></a>    print( key )
<a id="__codelineno-39-20" name="__codelineno-39-20"></a><a href="#__codelineno-39-20"><span class="linenos" data-linenos="20 "></span></a>&quot;&quot;&quot;
<a id="__codelineno-39-21" name="__codelineno-39-21"></a><a href="#__codelineno-39-21"><span class="linenos" data-linenos="21 "></span></a>flag = b&quot;ISCTF{asnxjbnmkishubxhxbasxmscmskldjvl}&quot;
<a id="__codelineno-39-22" name="__codelineno-39-22"></a><a href="#__codelineno-39-22"><span class="linenos" data-linenos="22 "></span></a>key = b&quot;NISANISANISANISA&quot;
<a id="__codelineno-39-23" name="__codelineno-39-23"></a><a href="#__codelineno-39-23"><span class="linenos" data-linenos="23 "></span></a>enc = b&#39;bsF\xb6m\xcf\x94\x9fg1\xfaxG\xd4\xa3\x04\xfb\x9c\xac\xed\xbe\xc4\xc0\xb5\x899|u\xbf9e\xe0\xa6\xdb5\xa8x\x84\x95(\xc6\x18\xfe\x07\x88\x02\xe1v&#39;
<a id="__codelineno-39-24" name="__codelineno-39-24"></a><a href="#__codelineno-39-24"><span class="linenos" data-linenos="24 "></span></a>
<a id="__codelineno-39-25" name="__codelineno-39-25"></a><a href="#__codelineno-39-25"><span class="linenos" data-linenos="25 "></span></a>
<a id="__codelineno-39-26" name="__codelineno-39-26"></a><a href="#__codelineno-39-26"><span class="linenos" data-linenos="26 "></span></a>for i in range( 10 ):
<a id="__codelineno-39-27" name="__codelineno-39-27"></a><a href="#__codelineno-39-27"><span class="linenos" data-linenos="27 "></span></a>    #iv = b&#39;\xac\xec\xec\x1d\xd4@\xdd\xf6\xcf\xda\xbcb\xdeg\x06\x9d&#39;
<a id="__codelineno-39-28" name="__codelineno-39-28"></a><a href="#__codelineno-39-28"><span class="linenos" data-linenos="28 "></span></a>    iv = os.urandom(16)
<a id="__codelineno-39-29" name="__codelineno-39-29"></a><a href="#__codelineno-39-29"><span class="linenos" data-linenos="29 "></span></a>    aes = AES.new(key,AES.MODE_CBC,iv)
<a id="__codelineno-39-30" name="__codelineno-39-30"></a><a href="#__codelineno-39-30"><span class="linenos" data-linenos="30 "></span></a>    flag = aes.decrypt( enc )
<a id="__codelineno-39-31" name="__codelineno-39-31"></a><a href="#__codelineno-39-31"><span class="linenos" data-linenos="31 "></span></a>    #print( iv )
<a id="__codelineno-39-32" name="__codelineno-39-32"></a><a href="#__codelineno-39-32"><span class="linenos" data-linenos="32 "></span></a>    print( flag )
<a id="__codelineno-39-33" name="__codelineno-39-33"></a><a href="#__codelineno-39-33"><span class="linenos" data-linenos="33 "></span></a>    #print( flag[:5] )
<a id="__codelineno-39-34" name="__codelineno-39-34"></a><a href="#__codelineno-39-34"><span class="linenos" data-linenos="34 "></span></a>
<a id="__codelineno-39-35" name="__codelineno-39-35"></a><a href="#__codelineno-39-35"><span class="linenos" data-linenos="35 "></span></a>flag{b106cea3fb848e7bea310c9851f15c1}
<a id="__codelineno-39-36" name="__codelineno-39-36"></a><a href="#__codelineno-39-36"><span class="linenos" data-linenos="36 "></span></a>&quot;&quot;&quot;
</code></pre></div>
<p>flag{1b106cea3fb848e7bea310c9851f15c1}</p>
<h3 id="nssctf-round16-basicbreak">[NSSCTF Round#16 Basic]break<a class="headerlink" href="#nssctf-round16-basicbreak" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1"></a><a href="#__codelineno-40-1"><span class="linenos" data-linenos=" 1 "></span></a>Bc8tSTrvGJm2oYuCzIz+Yg4nwwKBgQDiYUawe5Y+rPbFhVOMVB8ZByfMa4LjeSDd
<a id="__codelineno-40-2" name="__codelineno-40-2"></a><a href="#__codelineno-40-2"><span class="linenos" data-linenos=" 2 "></span></a>Z23jEGvylBHSeyvFCQq3ISUE40k1D2XmmeaZML3a1nUn6ORIWGaG2phcwrWLkR6n
<a id="__codelineno-40-3" name="__codelineno-40-3"></a><a href="#__codelineno-40-3"><span class="linenos" data-linenos=" 3 "></span></a>ubVmb1QJSzgzmFHGnL56KHByZxD9q6DPB+o6gGWt8/6ddBl2NIZU/1btdPQgojfA
<a id="__codelineno-40-4" name="__codelineno-40-4"></a><a href="#__codelineno-40-4"><span class="linenos" data-linenos=" 4 "></span></a>XXJFzR92RQKBgQC7qlB0U7m2U4FdG9eelSd+WSKNUVllZAuHji7jgh7Ox6La9xN5
<a id="__codelineno-40-5" name="__codelineno-40-5"></a><a href="#__codelineno-40-5"><span class="linenos" data-linenos=" 5 "></span></a>miGZ1yvP44yX218OJ9Zi08o6vIrM6Eil45KzTtGm4iuIn8CMpox+5eUtoxyvxa9r
<a id="__codelineno-40-6" name="__codelineno-40-6"></a><a href="#__codelineno-40-6"><span class="linenos" data-linenos=" 6 "></span></a>s2Wu+IRZN9zCME+p+qI8/TG27dIyDzsdgNqcUo8ESls7uW5/FEA7bYTCiQKBgQC7
<a id="__codelineno-40-7" name="__codelineno-40-7"></a><a href="#__codelineno-40-7"><span class="linenos" data-linenos=" 7 "></span></a>1KybeB+kZ0zlfIdi8tVOpeI+uaHDbdh3+/5wHUsD3hmfg7VAag0q/2RA1vkB/oG1
<a id="__codelineno-40-8" name="__codelineno-40-8"></a><a href="#__codelineno-40-8"><span class="linenos" data-linenos=" 8 "></span></a>QVLVHl0Yu0I/1/u5jyeakrtClAegAsvlrK+3i321rGS4YpTPb3SX1P/f3GZ7o7Ds
<a id="__codelineno-40-9" name="__codelineno-40-9"></a><a href="#__codelineno-40-9"><span class="linenos" data-linenos=" 9 "></span></a>touA+NHk8IL9T7xkmJYw5h/RLG32ucH6aU6MXfLR5QKBgD/skfdFxGWxhHk6U1mS
<a id="__codelineno-40-10" name="__codelineno-40-10"></a><a href="#__codelineno-40-10"><span class="linenos" data-linenos="10 "></span></a>27IM9jJNg9xLz5nxzkqPPhLn+rdgIIuTuQtv++eEjEP++7ZV10rg5yKVJd/bxy8H
<a id="__codelineno-40-11" name="__codelineno-40-11"></a><a href="#__codelineno-40-11"><span class="linenos" data-linenos="11 "></span></a>2IN7aQo7kZWulHTQDZMFwgOhn0u6glJi+qC8bWzYDFOQSFrY9XQ3vwKMspqm+697
<a id="__codelineno-40-12" name="__codelineno-40-12"></a><a href="#__codelineno-40-12"><span class="linenos" data-linenos="12 "></span></a>xM+dMUW0LML6oUE9ZjEiAY/5
<a id="__codelineno-40-13" name="__codelineno-40-13"></a><a href="#__codelineno-40-13"><span class="linenos" data-linenos="13 "></span></a>-----END PRIVATE KEY-----
</code></pre></div>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1"></a><a href="#__codelineno-41-1"><span class="linenos" data-linenos="1 "></span></a>6081370370545409218106271903400346695565292992689150366474451604281551878507114813906275593034729563149286993189430514737137534129570304832172520820901940874698337733991868650159489601159238582002010625666203730677577976307606665760650563172302688129824842780090723167480409842707790983962415315804311334507726664838464859751689906850572044873633896253285381878416855505301919877714965930289139921111644393144686543207867970807469735534838601255712764863973853116693691206791007433101433703535127367245739289103650669095061417223994665200039533840922696282929063608853551346533188464573323230476645532002621795338655
</code></pre></div>
<hr />
<p>对于一个pem私钥文件，包含：</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1"></a><a href="#__codelineno-42-1"><span class="linenos" data-linenos=" 1 "></span></a>RSAPrivateKey ::= SEQUENCE {
<a id="__codelineno-42-2" name="__codelineno-42-2"></a><a href="#__codelineno-42-2"><span class="linenos" data-linenos=" 2 "></span></a>version Version,
<a id="__codelineno-42-3" name="__codelineno-42-3"></a><a href="#__codelineno-42-3"><span class="linenos" data-linenos=" 3 "></span></a>modulus INTEGER, -- n
<a id="__codelineno-42-4" name="__codelineno-42-4"></a><a href="#__codelineno-42-4"><span class="linenos" data-linenos=" 4 "></span></a>publicExponent INTEGER, -- e
<a id="__codelineno-42-5" name="__codelineno-42-5"></a><a href="#__codelineno-42-5"><span class="linenos" data-linenos=" 5 "></span></a>privateExponent INTEGER, -- d
<a id="__codelineno-42-6" name="__codelineno-42-6"></a><a href="#__codelineno-42-6"><span class="linenos" data-linenos=" 6 "></span></a>prime1 INTEGER, -- p
<a id="__codelineno-42-7" name="__codelineno-42-7"></a><a href="#__codelineno-42-7"><span class="linenos" data-linenos=" 7 "></span></a>prime2 INTEGER, -- q
<a id="__codelineno-42-8" name="__codelineno-42-8"></a><a href="#__codelineno-42-8"><span class="linenos" data-linenos=" 8 "></span></a>exponent1 INTEGER, -- d mod (p-1)
<a id="__codelineno-42-9" name="__codelineno-42-9"></a><a href="#__codelineno-42-9"><span class="linenos" data-linenos=" 9 "></span></a>exponent2 INTEGER, -- d mod (q-1)
<a id="__codelineno-42-10" name="__codelineno-42-10"></a><a href="#__codelineno-42-10"><span class="linenos" data-linenos="10 "></span></a>coefficient INTEGER, -- (inverse of q) mod p
<a id="__codelineno-42-11" name="__codelineno-42-11"></a><a href="#__codelineno-42-11"><span class="linenos" data-linenos="11 "></span></a>otherPrimeInfos OtherPrimeInfos OPTIONAL
<a id="__codelineno-42-12" name="__codelineno-42-12"></a><a href="#__codelineno-42-12"><span class="linenos" data-linenos="12 "></span></a>}
</code></pre></div>
<p>编写脚本利用<code>02</code>分割</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1"></a><a href="#__codelineno-43-1"><span class="linenos" data-linenos=" 1 "></span></a>from base64 import *
<a id="__codelineno-43-2" name="__codelineno-43-2"></a><a href="#__codelineno-43-2"><span class="linenos" data-linenos=" 2 "></span></a>
<a id="__codelineno-43-3" name="__codelineno-43-3"></a><a href="#__codelineno-43-3"><span class="linenos" data-linenos=" 3 "></span></a>a =&#39;&#39;&#39;Bc8tSTrvGJm2oYuCzIz+Yg4nwwKBgQDiYUawe5Y+rPbFhVOMVB8ZByfMa4LjeSDd
<a id="__codelineno-43-4" name="__codelineno-43-4"></a><a href="#__codelineno-43-4"><span class="linenos" data-linenos=" 4 "></span></a>Z23jEGvylBHSeyvFCQq3ISUE40k1D2XmmeaZML3a1nUn6ORIWGaG2phcwrWLkR6n
<a id="__codelineno-43-5" name="__codelineno-43-5"></a><a href="#__codelineno-43-5"><span class="linenos" data-linenos=" 5 "></span></a>ubVmb1QJSzgzmFHGnL56KHByZxD9q6DPB+o6gGWt8/6ddBl2NIZU/1btdPQgojfA
<a id="__codelineno-43-6" name="__codelineno-43-6"></a><a href="#__codelineno-43-6"><span class="linenos" data-linenos=" 6 "></span></a>XXJFzR92RQKBgQC7qlB0U7m2U4FdG9eelSd+WSKNUVllZAuHji7jgh7Ox6La9xN5
<a id="__codelineno-43-7" name="__codelineno-43-7"></a><a href="#__codelineno-43-7"><span class="linenos" data-linenos=" 7 "></span></a>miGZ1yvP44yX218OJ9Zi08o6vIrM6Eil45KzTtGm4iuIn8CMpox+5eUtoxyvxa9r
<a id="__codelineno-43-8" name="__codelineno-43-8"></a><a href="#__codelineno-43-8"><span class="linenos" data-linenos=" 8 "></span></a>s2Wu+IRZN9zCME+p+qI8/TG27dIyDzsdgNqcUo8ESls7uW5/FEA7bYTCiQKBgQC7
<a id="__codelineno-43-9" name="__codelineno-43-9"></a><a href="#__codelineno-43-9"><span class="linenos" data-linenos=" 9 "></span></a>1KybeB+kZ0zlfIdi8tVOpeI+uaHDbdh3+/5wHUsD3hmfg7VAag0q/2RA1vkB/oG1
<a id="__codelineno-43-10" name="__codelineno-43-10"></a><a href="#__codelineno-43-10"><span class="linenos" data-linenos="10 "></span></a>QVLVHl0Yu0I/1/u5jyeakrtClAegAsvlrK+3i321rGS4YpTPb3SX1P/f3GZ7o7Ds
<a id="__codelineno-43-11" name="__codelineno-43-11"></a><a href="#__codelineno-43-11"><span class="linenos" data-linenos="11 "></span></a>touA+NHk8IL9T7xkmJYw5h/RLG32ucH6aU6MXfLR5QKBgD/skfdFxGWxhHk6U1mS
<a id="__codelineno-43-12" name="__codelineno-43-12"></a><a href="#__codelineno-43-12"><span class="linenos" data-linenos="12 "></span></a>27IM9jJNg9xLz5nxzkqPPhLn+rdgIIuTuQtv++eEjEP++7ZV10rg5yKVJd/bxy8H
<a id="__codelineno-43-13" name="__codelineno-43-13"></a><a href="#__codelineno-43-13"><span class="linenos" data-linenos="13 "></span></a>2IN7aQo7kZWulHTQDZMFwgOhn0u6glJi+qC8bWzYDFOQSFrY9XQ3vwKMspqm+697
<a id="__codelineno-43-14" name="__codelineno-43-14"></a><a href="#__codelineno-43-14"><span class="linenos" data-linenos="14 "></span></a>xM+dMUW0LML6oUE9ZjEiAY/5&#39;&#39;&#39;
<a id="__codelineno-43-15" name="__codelineno-43-15"></a><a href="#__codelineno-43-15"><span class="linenos" data-linenos="15 "></span></a>
<a id="__codelineno-43-16" name="__codelineno-43-16"></a><a href="#__codelineno-43-16"><span class="linenos" data-linenos="16 "></span></a>txt = &quot;&quot;
<a id="__codelineno-43-17" name="__codelineno-43-17"></a><a href="#__codelineno-43-17"><span class="linenos" data-linenos="17 "></span></a>for i in a.split():
<a id="__codelineno-43-18" name="__codelineno-43-18"></a><a href="#__codelineno-43-18"><span class="linenos" data-linenos="18 "></span></a>    txt = txt + str(b64decode(i).hex())
<a id="__codelineno-43-19" name="__codelineno-43-19"></a><a href="#__codelineno-43-19"><span class="linenos" data-linenos="19 "></span></a>
<a id="__codelineno-43-20" name="__codelineno-43-20"></a><a href="#__codelineno-43-20"><span class="linenos" data-linenos="20 "></span></a>txt = txt.split(&quot;02&quot;)
<a id="__codelineno-43-21" name="__codelineno-43-21"></a><a href="#__codelineno-43-21"><span class="linenos" data-linenos="21 "></span></a>
<a id="__codelineno-43-22" name="__codelineno-43-22"></a><a href="#__codelineno-43-22"><span class="linenos" data-linenos="22 "></span></a>for i in txt:
<a id="__codelineno-43-23" name="__codelineno-43-23"></a><a href="#__codelineno-43-23"><span class="linenos" data-linenos="23 "></span></a>    print( i )
</code></pre></div>
<p>得到运行结果：</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1"></a><a href="#__codelineno-44-1"><span class="linenos" data-linenos="1 "></span></a>05cf2d493aef1899b6a18b82cc8cfe620e27c3
<a id="__codelineno-44-2" name="__codelineno-44-2"></a><a href="#__codelineno-44-2"><span class="linenos" data-linenos="2 "></span></a>818100e26146b07b963eacf6c585538c541f190727cc6b82e37920dd676de3106bf29411d27b2bc5090ab7212504e349350f65e699e69930bddad67527e8e448586686da985cc2b58b911ea7b9b5666f54094b38339851c69cbe7a2870726710fdaba0cf07ea3a8065adf3fe9d741976348654ff56ed74f420a237c05d7245cd1f7645
<a id="__codelineno-44-3" name="__codelineno-44-3"></a><a href="#__codelineno-44-3"><span class="linenos" data-linenos="3 "></span></a>818100bbaa507453b9b653815d1bd79e95277e59228d515965640b878e2ee3821ecec7a2daf713799a2199d72bcfe38c97db5f0e27d662d3ca3abc8acce848a5e392b34ed1a6e22b889fc08ca68c7ee5e52da31cafc5af6bb365aef8845937dcc2304fa9faa23cfd31b6edd2320f3b1d80da9c528f044a5b3bb96e7f14403b6d84c289
<a id="__codelineno-44-4" name="__codelineno-44-4"></a><a href="#__codelineno-44-4"><span class="linenos" data-linenos="4 "></span></a>818100bbd4ac9b781fa4674ce57c8762f2d54ea5e23eb9a1c36dd877fbfe701d4b03de199f83b5406a0d2aff6440d6f901fe81b54152d51e5d18bb423fd7fbb98f279a92bb429407a0
<a id="__codelineno-44-5" name="__codelineno-44-5"></a><a href="#__codelineno-44-5"><span class="linenos" data-linenos="5 "></span></a>cbe5acafb78b7db5ac64b86294cf6f7497d4ffdfdc667ba3b0ecb68b80f8d1e4f082fd4fbc64989630e61fd12c6df6b9c1fa694e8c5df2d1e5
<a id="__codelineno-44-6" name="__codelineno-44-6"></a><a href="#__codelineno-44-6"><span class="linenos" data-linenos="6 "></span></a>81803fec91f745c465b184793a535992dbb20cf6324d83dc4bcf99f1ce4a8f3e12e7fab76
<a id="__codelineno-44-7" name="__codelineno-44-7"></a><a href="#__codelineno-44-7"><span class="linenos" data-linenos="7 "></span></a>08b93b90b6ffbe7848c43fefbb655d74ae0e7229525dfdbc72f07d8837b690a3b9195ae9474d00d9305c203a19f4bba825262faa0bc6d6cd80c5390485ad8f57437bf
<a id="__codelineno-44-8" name="__codelineno-44-8"></a><a href="#__codelineno-44-8"><span class="linenos" data-linenos="8 "></span></a>8cb29aa6fbaf7bc4cf9d3145b42cc2faa1413d663122018ff9
</code></pre></div>
<p>获取到最后几组数据</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1"></a><a href="#__codelineno-45-1"><span class="linenos" data-linenos="1 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-45-2" name="__codelineno-45-2"></a><a href="#__codelineno-45-2"><span class="linenos" data-linenos="2 "></span></a>import gmpy2
<a id="__codelineno-45-3" name="__codelineno-45-3"></a><a href="#__codelineno-45-3"><span class="linenos" data-linenos="3 "></span></a>
<a id="__codelineno-45-4" name="__codelineno-45-4"></a><a href="#__codelineno-45-4"><span class="linenos" data-linenos="4 "></span></a>q = 0x00e26146b07b963eacf6c585538c541f190727cc6b82e37920dd676de3106bf29411d27b2bc5090ab7212504e349350f65e699e69930bddad67527e8e448586686da985cc2b58b911ea7b9b5666f54094b38339851c69cbe7a2870726710fdaba0cf07ea3a8065adf3fe9d741976348654ff56ed74f420a237c05d7245cd1f7645
<a id="__codelineno-45-5" name="__codelineno-45-5"></a><a href="#__codelineno-45-5"><span class="linenos" data-linenos="5 "></span></a>c = 6081370370545409218106271903400346695565292992689150366474451604281551878507114813906275593034729563149286993189430514737137534129570304832172520820901940874698337733991868650159489601159238582002010625666203730677577976307606665760650563172302688129824842780090723167480409842707790983962415315804311334507726664838464859751689906850572044873633896253285381878416855505301919877714965930289139921111644393144686543207867970807469735534838601255712764863973853116693691206791007433101433703535127367245739289103650669095061417223994665200039533840922696282929063608853551346533188464573323230476645532002621795338655
<a id="__codelineno-45-6" name="__codelineno-45-6"></a><a href="#__codelineno-45-6"><span class="linenos" data-linenos="6 "></span></a>e = 0x10001
<a id="__codelineno-45-7" name="__codelineno-45-7"></a><a href="#__codelineno-45-7"><span class="linenos" data-linenos="7 "></span></a>m = pow(c, gmpy2.invert(e, q-1),q)
<a id="__codelineno-45-8" name="__codelineno-45-8"></a><a href="#__codelineno-45-8"><span class="linenos" data-linenos="8 "></span></a>print( long_to_bytes(m) )
</code></pre></div>
<p>flag:<code>NSSCTF{oi!_you_find___what_i_Wa1t_talK_y0n!!!}</code></p>
<p>相关考点：openssl rsa</p>
<h3 id="buuctfnctf2019babyrsa">[BUUCTF·NCTF2019]babyRSA<a class="headerlink" href="#buuctfnctf2019babyrsa" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1"></a><a href="#__codelineno-46-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-46-2" name="__codelineno-46-2"></a><a href="#__codelineno-46-2"><span class="linenos" data-linenos=" 2 "></span></a>from flag import flag
<a id="__codelineno-46-3" name="__codelineno-46-3"></a><a href="#__codelineno-46-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-46-4" name="__codelineno-46-4"></a><a href="#__codelineno-46-4"><span class="linenos" data-linenos=" 4 "></span></a>def nextPrime(n):
<a id="__codelineno-46-5" name="__codelineno-46-5"></a><a href="#__codelineno-46-5"><span class="linenos" data-linenos=" 5 "></span></a>    n += 2 if n &amp; 1 else 1
<a id="__codelineno-46-6" name="__codelineno-46-6"></a><a href="#__codelineno-46-6"><span class="linenos" data-linenos=" 6 "></span></a>    while not isPrime(n):
<a id="__codelineno-46-7" name="__codelineno-46-7"></a><a href="#__codelineno-46-7"><span class="linenos" data-linenos=" 7 "></span></a>        n += 2
<a id="__codelineno-46-8" name="__codelineno-46-8"></a><a href="#__codelineno-46-8"><span class="linenos" data-linenos=" 8 "></span></a>    return n
<a id="__codelineno-46-9" name="__codelineno-46-9"></a><a href="#__codelineno-46-9"><span class="linenos" data-linenos=" 9 "></span></a>
<a id="__codelineno-46-10" name="__codelineno-46-10"></a><a href="#__codelineno-46-10"><span class="linenos" data-linenos="10 "></span></a>p = getPrime(1024)
<a id="__codelineno-46-11" name="__codelineno-46-11"></a><a href="#__codelineno-46-11"><span class="linenos" data-linenos="11 "></span></a>q = nextPrime(p)
<a id="__codelineno-46-12" name="__codelineno-46-12"></a><a href="#__codelineno-46-12"><span class="linenos" data-linenos="12 "></span></a>n = p * q
<a id="__codelineno-46-13" name="__codelineno-46-13"></a><a href="#__codelineno-46-13"><span class="linenos" data-linenos="13 "></span></a>e = 0x10001
<a id="__codelineno-46-14" name="__codelineno-46-14"></a><a href="#__codelineno-46-14"><span class="linenos" data-linenos="14 "></span></a>d = inverse(e, (p-1) * (q-1))
<a id="__codelineno-46-15" name="__codelineno-46-15"></a><a href="#__codelineno-46-15"><span class="linenos" data-linenos="15 "></span></a>c = pow(bytes_to_long(flag.encode()), e, n)
<a id="__codelineno-46-16" name="__codelineno-46-16"></a><a href="#__codelineno-46-16"><span class="linenos" data-linenos="16 "></span></a>
<a id="__codelineno-46-17" name="__codelineno-46-17"></a><a href="#__codelineno-46-17"><span class="linenos" data-linenos="17 "></span></a># d = 19275778946037899718035455438175509175723911466127462154506916564101519923603308900331427601983476886255849200332374081996442976307058597390881168155862238533018621944733299208108185814179466844504468163200369996564265921022888670062554504758512453217434777820468049494313818291727050400752551716550403647148197148884408264686846693842118387217753516963449753809860354047619256787869400297858568139700396567519469825398575103885487624463424429913017729585620877168171603444111464692841379661112075123399343270610272287865200880398193573260848268633461983435015031227070217852728240847398084414687146397303110709214913
<a id="__codelineno-46-18" name="__codelineno-46-18"></a><a href="#__codelineno-46-18"><span class="linenos" data-linenos="18 "></span></a># c = 5382723168073828110696168558294206681757991149022777821127563301413483223874527233300721180839298617076705685041174247415826157096583055069337393987892262764211225227035880754417457056723909135525244957935906902665679777101130111392780237502928656225705262431431953003520093932924375902111280077255205118217436744112064069429678632923259898627997145803892753989255615273140300021040654505901442787810653626524305706316663169341797205752938755590056568986738227803487467274114398257187962140796551136220532809687606867385639367743705527511680719955380746377631156468689844150878381460560990755652899449340045313521804
</code></pre></div>
<hr />
<p>我们已知 <span class="arithmatex">\(e*d \equiv 1\ mod\ phi\)</span></p>
<p>恒等式化等式得到：<span class="arithmatex">\(e*d=1+k*phi\)</span></p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1"></a><a href="#__codelineno-47-1"><span class="linenos" data-linenos="1 "></span></a>d = 19275778946037899718035455438175509175723911466127462154506916564101519923603308900331427601983476886255849200332374081996442976307058597390881168155862238533018621944733299208108185814179466844504468163200369996564265921022888670062554504758512453217434777820468049494313818291727050400752551716550403647148197148884408264686846693842118387217753516963449753809860354047619256787869400297858568139700396567519469825398575103885487624463424429913017729585620877168171603444111464692841379661112075123399343270610272287865200880398193573260848268633461983435015031227070217852728240847398084414687146397303110709214913
<a id="__codelineno-47-2" name="__codelineno-47-2"></a><a href="#__codelineno-47-2"><span class="linenos" data-linenos="2 "></span></a>e = 0x10001
<a id="__codelineno-47-3" name="__codelineno-47-3"></a><a href="#__codelineno-47-3"><span class="linenos" data-linenos="3 "></span></a>ed = str(bin( e * d - 1 ))
<a id="__codelineno-47-4" name="__codelineno-47-4"></a><a href="#__codelineno-47-4"><span class="linenos" data-linenos="4 "></span></a>print( ed , len(ed)-2 )#把前缀&#39;0b&#39;去掉
</code></pre></div>
<p><span class="arithmatex">\(e*d\)</span> 长度为 <span class="arithmatex">\(2064\)</span>，而 <span class="arithmatex">\(phi\)</span> 的长度应当为 <span class="arithmatex">\(2048\)</span>，故 <span class="arithmatex">\(k\)</span> 的范围是 <span class="arithmatex">\(2^{15}\)</span>~<span class="arithmatex">\(2^{16}\)</span>，穷举即可</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1"></a><a href="#__codelineno-48-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-48-2" name="__codelineno-48-2"></a><a href="#__codelineno-48-2"><span class="linenos" data-linenos=" 2 "></span></a>import sympy.crypto
<a id="__codelineno-48-3" name="__codelineno-48-3"></a><a href="#__codelineno-48-3"><span class="linenos" data-linenos=" 3 "></span></a>import gmpy2
<a id="__codelineno-48-4" name="__codelineno-48-4"></a><a href="#__codelineno-48-4"><span class="linenos" data-linenos=" 4 "></span></a>
<a id="__codelineno-48-5" name="__codelineno-48-5"></a><a href="#__codelineno-48-5"><span class="linenos" data-linenos=" 5 "></span></a>d = 19275778946037899718035455438175509175723911466127462154506916564101519923603308900331427601983476886255849200332374081996442976307058597390881168155862238533018621944733299208108185814179466844504468163200369996564265921022888670062554504758512453217434777820468049494313818291727050400752551716550403647148197148884408264686846693842118387217753516963449753809860354047619256787869400297858568139700396567519469825398575103885487624463424429913017729585620877168171603444111464692841379661112075123399343270610272287865200880398193573260848268633461983435015031227070217852728240847398084414687146397303110709214913
<a id="__codelineno-48-6" name="__codelineno-48-6"></a><a href="#__codelineno-48-6"><span class="linenos" data-linenos=" 6 "></span></a>c = 5382723168073828110696168558294206681757991149022777821127563301413483223874527233300721180839298617076705685041174247415826157096583055069337393987892262764211225227035880754417457056723909135525244957935906902665679777101130111392780237502928656225705262431431953003520093932924375902111280077255205118217436744112064069429678632923259898627997145803892753989255615273140300021040654505901442787810653626524305706316663169341797205752938755590056568986738227803487467274114398257187962140796551136220532809687606867385639367743705527511680719955380746377631156468689844150878381460560990755652899449340045313521804
<a id="__codelineno-48-7" name="__codelineno-48-7"></a><a href="#__codelineno-48-7"><span class="linenos" data-linenos=" 7 "></span></a>e = 0x10001
<a id="__codelineno-48-8" name="__codelineno-48-8"></a><a href="#__codelineno-48-8"><span class="linenos" data-linenos=" 8 "></span></a>p = q = 0
<a id="__codelineno-48-9" name="__codelineno-48-9"></a><a href="#__codelineno-48-9"><span class="linenos" data-linenos=" 9 "></span></a>
<a id="__codelineno-48-10" name="__codelineno-48-10"></a><a href="#__codelineno-48-10"><span class="linenos" data-linenos="10 "></span></a>for k in range( 2**15 , 2**16 ):
<a id="__codelineno-48-11" name="__codelineno-48-11"></a><a href="#__codelineno-48-11"><span class="linenos" data-linenos="11 "></span></a>    if ( e * d - 1 ) % k == 0:
<a id="__codelineno-48-12" name="__codelineno-48-12"></a><a href="#__codelineno-48-12"><span class="linenos" data-linenos="12 "></span></a>        p = sympy.prevprime( gmpy2.iroot( ( e * d - 1 ) // k , 2 )[0] ) ;
<a id="__codelineno-48-13" name="__codelineno-48-13"></a><a href="#__codelineno-48-13"><span class="linenos" data-linenos="13 "></span></a>        q = sympy.nextprime( p )
<a id="__codelineno-48-14" name="__codelineno-48-14"></a><a href="#__codelineno-48-14"><span class="linenos" data-linenos="14 "></span></a>        if (e*d-1)==(p-1)*(q-1)*k:
<a id="__codelineno-48-15" name="__codelineno-48-15"></a><a href="#__codelineno-48-15"><span class="linenos" data-linenos="15 "></span></a>            break
<a id="__codelineno-48-16" name="__codelineno-48-16"></a><a href="#__codelineno-48-16"><span class="linenos" data-linenos="16 "></span></a>n = p * q
<a id="__codelineno-48-17" name="__codelineno-48-17"></a><a href="#__codelineno-48-17"><span class="linenos" data-linenos="17 "></span></a>print( long_to_bytes( pow( c , d , n ) ) )
</code></pre></div>
<p>flag:<code>flag{70u2_nn47h_14_v3ry_gOO0000000d}</code></p>
<h3 id="buuctfafctf2018">[BUUCTF·AFCTF2018]你能看出这是什么加密么<a class="headerlink" href="#buuctfafctf2018" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1"></a><a href="#__codelineno-49-1"><span class="linenos" data-linenos="1 "></span></a>p=0x928fb6aa9d813b6c3270131818a7c54edb18e3806942b88670106c1821e0326364194a8c49392849432b37632f0abe3f3c52e909b939c91c50e41a7b8cd00c67d6743b4f
<a id="__codelineno-49-2" name="__codelineno-49-2"></a><a href="#__codelineno-49-2"><span class="linenos" data-linenos="2 "></span></a>
<a id="__codelineno-49-3" name="__codelineno-49-3"></a><a href="#__codelineno-49-3"><span class="linenos" data-linenos="3 "></span></a>q=0xec301417ccdffa679a8dcc4027dd0d75baf9d441625ed8930472165717f4732884c33f25d4ee6a6c9ae6c44aedad039b0b72cf42cab7f80d32b74061
<a id="__codelineno-49-4" name="__codelineno-49-4"></a><a href="#__codelineno-49-4"><span class="linenos" data-linenos="4 "></span></a>
<a id="__codelineno-49-5" name="__codelineno-49-5"></a><a href="#__codelineno-49-5"><span class="linenos" data-linenos="5 "></span></a>e=0x10001
<a id="__codelineno-49-6" name="__codelineno-49-6"></a><a href="#__codelineno-49-6"><span class="linenos" data-linenos="6 "></span></a>
<a id="__codelineno-49-7" name="__codelineno-49-7"></a><a href="#__codelineno-49-7"><span class="linenos" data-linenos="7 "></span></a>c=0x70c9133e1647e95c3cb99bd998a9028b5bf492929725a9e8e6d2e277fa0f37205580b196e5f121a2e83bc80a8204c99f5036a07c8cf6f96c420369b4161d2654a7eccbdaf583204b645e137b3bd15c5ce865298416fd5831cba0d947113ed5be5426b708b89451934d11f9aed9085b48b729449e461ff0863552149b965e22b6   
</code></pre></div>
<hr />
<p>普通的rsa，直接解即可</p>
<p>python每日小寄巧：别直接复制（尤其是c），原文有毒</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1"></a><a href="#__codelineno-50-1"><span class="linenos" data-linenos=" 1 "></span></a>import gmpy2
<a id="__codelineno-50-2" name="__codelineno-50-2"></a><a href="#__codelineno-50-2"><span class="linenos" data-linenos=" 2 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-50-3" name="__codelineno-50-3"></a><a href="#__codelineno-50-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-50-4" name="__codelineno-50-4"></a><a href="#__codelineno-50-4"><span class="linenos" data-linenos=" 4 "></span></a>p=0x928fb6aa9d813b6c3270131818a7c54edb18e3806942b88670106c1821e0326364194a8c49392849432b37632f0abe3f3c52e909b939c91c50e41a7b8cd00c67d6743b4f
<a id="__codelineno-50-5" name="__codelineno-50-5"></a><a href="#__codelineno-50-5"><span class="linenos" data-linenos=" 5 "></span></a>q=0xec301417ccdffa679a8dcc4027dd0d75baf9d441625ed8930472165717f4732884c33f25d4ee6a6c9ae6c44aedad039b0b72cf42cab7f80d32b74061
<a id="__codelineno-50-6" name="__codelineno-50-6"></a><a href="#__codelineno-50-6"><span class="linenos" data-linenos=" 6 "></span></a>e=0x10001
<a id="__codelineno-50-7" name="__codelineno-50-7"></a><a href="#__codelineno-50-7"><span class="linenos" data-linenos=" 7 "></span></a>c=0x70c9133e1647e95c3cb99bd998a9028b5bf492929725a9e8e6d2e277fa0f37205580b196e5f121a2e83bc80a8204c99f5036a07c8cf6f96c420369b4161d2654a7eccbdaf583204b645e137b3bd15c5ce865298416fd5831cba0d947113ed5be5426b708b89451934d11f9aed9085b48b729449e461ff0863552149b965e22b6
<a id="__codelineno-50-8" name="__codelineno-50-8"></a><a href="#__codelineno-50-8"><span class="linenos" data-linenos=" 8 "></span></a>
<a id="__codelineno-50-9" name="__codelineno-50-9"></a><a href="#__codelineno-50-9"><span class="linenos" data-linenos=" 9 "></span></a>n = p * q ; phi = (p-1)*(q-1)
<a id="__codelineno-50-10" name="__codelineno-50-10"></a><a href="#__codelineno-50-10"><span class="linenos" data-linenos="10 "></span></a>d = gmpy2.invert( e , phi )
<a id="__codelineno-50-11" name="__codelineno-50-11"></a><a href="#__codelineno-50-11"><span class="linenos" data-linenos="11 "></span></a>print( long_to_bytes( pow(c,d,n) ) )
</code></pre></div>
<p>flag:<code>flag{R54_|5_$0_$imp13}</code></p>
<h3 id="buuctfroarctf2019rsa">[BUUCTF·RoarCTF2019]RSA<a class="headerlink" href="#buuctfroarctf2019rsa" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1"></a><a href="#__codelineno-51-1"><span class="linenos" data-linenos="1 "></span></a>A=(((y%x)**5)%(x%y))**2019+y**316+(y+1)/x
<a id="__codelineno-51-2" name="__codelineno-51-2"></a><a href="#__codelineno-51-2"><span class="linenos" data-linenos="2 "></span></a>p=next_prime(z*x*y)
<a id="__codelineno-51-3" name="__codelineno-51-3"></a><a href="#__codelineno-51-3"><span class="linenos" data-linenos="3 "></span></a>q=next_prime(z)
<a id="__codelineno-51-4" name="__codelineno-51-4"></a><a href="#__codelineno-51-4"><span class="linenos" data-linenos="4 "></span></a>A =  2683349182678714524247469512793476009861014781004924905484127480308161377768192868061561886577048646432382128960881487463427414176114486885830693959404989743229103516924432512724195654425703453612710310587164417035878308390676612592848750287387318129424195208623440294647817367740878211949147526287091298307480502897462279102572556822231669438279317474828479089719046386411971105448723910594710418093977044179949800373224354729179833393219827789389078869290217569511230868967647963089430594258815146362187250855166897553056073744582946148472068334167445499314471518357535261186318756327890016183228412253724
<a id="__codelineno-51-5" name="__codelineno-51-5"></a><a href="#__codelineno-51-5"><span class="linenos" data-linenos="5 "></span></a>n =  117930806043507374325982291823027285148807239117987369609583515353889814856088099671454394340816761242974462268435911765045576377767711593100416932019831889059333166946263184861287975722954992219766493089630810876984781113645362450398009234556085330943125568377741065242183073882558834603430862598066786475299918395341014877416901185392905676043795425126968745185649565106322336954427505104906770493155723995382318346714944184577894150229037758434597242564815299174950147754426950251419204917376517360505024549691723683358170823416757973059354784142601436519500811159036795034676360028928301979780528294114933347127
<a id="__codelineno-51-6" name="__codelineno-51-6"></a><a href="#__codelineno-51-6"><span class="linenos" data-linenos="6 "></span></a>c =  41971850275428383625653350824107291609587853887037624239544762751558838294718672159979929266922528917912189124713273673948051464226519605803745171340724343705832198554680196798623263806617998072496026019940476324971696928551159371970207365741517064295956376809297272541800647747885170905737868568000101029143923792003486793278197051326716680212726111099439262589341050943913401067673851885114314709706016622157285023272496793595281054074260451116213815934843317894898883215362289599366101018081513215120728297131352439066930452281829446586562062242527329672575620261776042653626411730955819001674118193293313612128
</code></pre></div>
<hr />
<p>通过yafu不能分解，利用factor可以分解得到p和q</p>
<p>可能会出现分母为0的情况，故需要判断</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1"></a><a href="#__codelineno-52-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-52-2" name="__codelineno-52-2"></a><a href="#__codelineno-52-2"><span class="linenos" data-linenos=" 2 "></span></a>from gmpy2 import *
<a id="__codelineno-52-3" name="__codelineno-52-3"></a><a href="#__codelineno-52-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-52-4" name="__codelineno-52-4"></a><a href="#__codelineno-52-4"><span class="linenos" data-linenos=" 4 "></span></a>p = 842868045681390934539739959201847552284980179958879667933078453950968566151662147267006293571765463137270594151138695778986165111380428806545593588078365331313084230014618714412959584843421586674162688321942889369912392031882620994944241987153078156389470370195514285850736541078623854327959382156753458569
<a id="__codelineno-52-5" name="__codelineno-52-5"></a><a href="#__codelineno-52-5"><span class="linenos" data-linenos=" 5 "></span></a>q = 139916095583110895133596833227506693679306709873174024876891023355860781981175916446323044732913066880786918629089023499311703408489151181886568535621008644997971982182426706592551291084007983387911006261442519635405457077292515085160744169867410973960652081452455371451222265819051559818441257438021073941183
<a id="__codelineno-52-6" name="__codelineno-52-6"></a><a href="#__codelineno-52-6"><span class="linenos" data-linenos=" 6 "></span></a>n = p * q
<a id="__codelineno-52-7" name="__codelineno-52-7"></a><a href="#__codelineno-52-7"><span class="linenos" data-linenos=" 7 "></span></a>phi = (p-1)*(q-1)
<a id="__codelineno-52-8" name="__codelineno-52-8"></a><a href="#__codelineno-52-8"><span class="linenos" data-linenos=" 8 "></span></a>c = 41971850275428383625653350824107291609587853887037624239544762751558838294718672159979929266922528917912189124713273673948051464226519605803745171340724343705832198554680196798623263806617998072496026019940476324971696928551159371970207365741517064295956376809297272541800647747885170905737868568000101029143923792003486793278197051326716680212726111099439262589341050943913401067673851885114314709706016622157285023272496793595281054074260451116213815934843317894898883215362289599366101018081513215120728297131352439066930452281829446586562062242527329672575620261776042653626411730955819001674118193293313612128
<a id="__codelineno-52-9" name="__codelineno-52-9"></a><a href="#__codelineno-52-9"><span class="linenos" data-linenos=" 9 "></span></a>
<a id="__codelineno-52-10" name="__codelineno-52-10"></a><a href="#__codelineno-52-10"><span class="linenos" data-linenos="10 "></span></a>for e in range( 2 , 100000 ):
<a id="__codelineno-52-11" name="__codelineno-52-11"></a><a href="#__codelineno-52-11"><span class="linenos" data-linenos="11 "></span></a>    try:
<a id="__codelineno-52-12" name="__codelineno-52-12"></a><a href="#__codelineno-52-12"><span class="linenos" data-linenos="12 "></span></a>        d = invert( e , phi )
<a id="__codelineno-52-13" name="__codelineno-52-13"></a><a href="#__codelineno-52-13"><span class="linenos" data-linenos="13 "></span></a>        m = str(long_to_bytes( pow(c,d,n) ))
<a id="__codelineno-52-14" name="__codelineno-52-14"></a><a href="#__codelineno-52-14"><span class="linenos" data-linenos="14 "></span></a>        if &quot;CTF&quot; in m or &quot;flag&quot; in m:
<a id="__codelineno-52-15" name="__codelineno-52-15"></a><a href="#__codelineno-52-15"><span class="linenos" data-linenos="15 "></span></a>            print( m )
<a id="__codelineno-52-16" name="__codelineno-52-16"></a><a href="#__codelineno-52-16"><span class="linenos" data-linenos="16 "></span></a>    except ZeroDivisionError:
<a id="__codelineno-52-17" name="__codelineno-52-17"></a><a href="#__codelineno-52-17"><span class="linenos" data-linenos="17 "></span></a>        continue
</code></pre></div>
<p>flag:<code>flag{wm-l1l1ll1l1l1l111ll}</code></p>
<h3 id="buuctfroarctf2019babyrsa">[BUUCTF·RoarCTF2019]babyRSA<a class="headerlink" href="#buuctfroarctf2019babyrsa" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1"></a><a href="#__codelineno-53-1"><span class="linenos" data-linenos=" 1 "></span></a>import sympy
<a id="__codelineno-53-2" name="__codelineno-53-2"></a><a href="#__codelineno-53-2"><span class="linenos" data-linenos=" 2 "></span></a>import random
<a id="__codelineno-53-3" name="__codelineno-53-3"></a><a href="#__codelineno-53-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-53-4" name="__codelineno-53-4"></a><a href="#__codelineno-53-4"><span class="linenos" data-linenos=" 4 "></span></a>def myGetPrime():
<a id="__codelineno-53-5" name="__codelineno-53-5"></a><a href="#__codelineno-53-5"><span class="linenos" data-linenos=" 5 "></span></a>    A= getPrime(513)
<a id="__codelineno-53-6" name="__codelineno-53-6"></a><a href="#__codelineno-53-6"><span class="linenos" data-linenos=" 6 "></span></a>    print(A)
<a id="__codelineno-53-7" name="__codelineno-53-7"></a><a href="#__codelineno-53-7"><span class="linenos" data-linenos=" 7 "></span></a>    B=A-random.randint(1e3,1e5)
<a id="__codelineno-53-8" name="__codelineno-53-8"></a><a href="#__codelineno-53-8"><span class="linenos" data-linenos=" 8 "></span></a>    print(B)
<a id="__codelineno-53-9" name="__codelineno-53-9"></a><a href="#__codelineno-53-9"><span class="linenos" data-linenos=" 9 "></span></a>    return sympy.nextPrime((B!)%A)
<a id="__codelineno-53-10" name="__codelineno-53-10"></a><a href="#__codelineno-53-10"><span class="linenos" data-linenos="10 "></span></a>p=myGetPrime()
<a id="__codelineno-53-11" name="__codelineno-53-11"></a><a href="#__codelineno-53-11"><span class="linenos" data-linenos="11 "></span></a>#A1=21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467234407
<a id="__codelineno-53-12" name="__codelineno-53-12"></a><a href="#__codelineno-53-12"><span class="linenos" data-linenos="12 "></span></a>#B1=21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467140596
<a id="__codelineno-53-13" name="__codelineno-53-13"></a><a href="#__codelineno-53-13"><span class="linenos" data-linenos="13 "></span></a>
<a id="__codelineno-53-14" name="__codelineno-53-14"></a><a href="#__codelineno-53-14"><span class="linenos" data-linenos="14 "></span></a>q=myGetPrime()
<a id="__codelineno-53-15" name="__codelineno-53-15"></a><a href="#__codelineno-53-15"><span class="linenos" data-linenos="15 "></span></a>#A2=16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858418927
<a id="__codelineno-53-16" name="__codelineno-53-16"></a><a href="#__codelineno-53-16"><span class="linenos" data-linenos="16 "></span></a>#B2=16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858351026
<a id="__codelineno-53-17" name="__codelineno-53-17"></a><a href="#__codelineno-53-17"><span class="linenos" data-linenos="17 "></span></a>
<a id="__codelineno-53-18" name="__codelineno-53-18"></a><a href="#__codelineno-53-18"><span class="linenos" data-linenos="18 "></span></a>r=myGetPrime()
<a id="__codelineno-53-19" name="__codelineno-53-19"></a><a href="#__codelineno-53-19"><span class="linenos" data-linenos="19 "></span></a>
<a id="__codelineno-53-20" name="__codelineno-53-20"></a><a href="#__codelineno-53-20"><span class="linenos" data-linenos="20 "></span></a>n=p*q*r
<a id="__codelineno-53-21" name="__codelineno-53-21"></a><a href="#__codelineno-53-21"><span class="linenos" data-linenos="21 "></span></a>#n=85492663786275292159831603391083876175149354309327673008716627650718160585639723100793347534649628330416631255660901307533909900431413447524262332232659153047067908693481947121069070451562822417357656432171870951184673132554213690123308042697361969986360375060954702920656364144154145812838558365334172935931441424096270206140691814662318562696925767991937369782627908408239087358033165410020690152067715711112732252038588432896758405898709010342467882264362733
<a id="__codelineno-53-22" name="__codelineno-53-22"></a><a href="#__codelineno-53-22"><span class="linenos" data-linenos="22 "></span></a>c=pow(flag,e,n)
<a id="__codelineno-53-23" name="__codelineno-53-23"></a><a href="#__codelineno-53-23"><span class="linenos" data-linenos="23 "></span></a>#e=0x1001
<a id="__codelineno-53-24" name="__codelineno-53-24"></a><a href="#__codelineno-53-24"><span class="linenos" data-linenos="24 "></span></a>#c=75700883021669577739329316795450706204502635802310731477156998834710820770245219468703245302009998932067080383977560299708060476222089630209972629755965140317526034680452483360917378812244365884527186056341888615564335560765053550155758362271622330017433403027261127561225585912484777829588501213961110690451987625502701331485141639684356427316905122995759825241133872734362716041819819948645662803292418802204430874521342108413623635150475963121220095236776428
<a id="__codelineno-53-25" name="__codelineno-53-25"></a><a href="#__codelineno-53-25"><span class="linenos" data-linenos="25 "></span></a>#so,what is the flag?
</code></pre></div>
<hr />
<p>威尔逊定理：<span class="arithmatex">\((p-1)! \equiv -1 \ mod \ p\)</span> 其中p是质数</p>
<p>要求 <span class="arithmatex">\(Ans = B!\ \% \ A\)</span> ，只需求 <span class="arithmatex">\((A-1)! \ \% \ A\)</span> 和 <span class="arithmatex">\(B! * (A-1)!^{-1}\)</span></p>
<p>其中 <span class="arithmatex">\((A-1)! \equiv -1 \ mod \ A\)</span> 和 <span class="arithmatex">\((B! * (A-1)!^{-1})^{-1}=\prod_{b+1}^{A-1}\)</span></p>
<p>故 <span class="arithmatex">\(Ans= -(\prod_{b+1}^{A-1})^{-1}\)</span></p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1"></a><a href="#__codelineno-54-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-54-2" name="__codelineno-54-2"></a><a href="#__codelineno-54-2"><span class="linenos" data-linenos=" 2 "></span></a>from gmpy2 import *
<a id="__codelineno-54-3" name="__codelineno-54-3"></a><a href="#__codelineno-54-3"><span class="linenos" data-linenos=" 3 "></span></a>from sympy import *
<a id="__codelineno-54-4" name="__codelineno-54-4"></a><a href="#__codelineno-54-4"><span class="linenos" data-linenos=" 4 "></span></a>
<a id="__codelineno-54-5" name="__codelineno-54-5"></a><a href="#__codelineno-54-5"><span class="linenos" data-linenos=" 5 "></span></a>A1=21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467234407
<a id="__codelineno-54-6" name="__codelineno-54-6"></a><a href="#__codelineno-54-6"><span class="linenos" data-linenos=" 6 "></span></a>B1=21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467140596
<a id="__codelineno-54-7" name="__codelineno-54-7"></a><a href="#__codelineno-54-7"><span class="linenos" data-linenos=" 7 "></span></a>A2=16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858418927
<a id="__codelineno-54-8" name="__codelineno-54-8"></a><a href="#__codelineno-54-8"><span class="linenos" data-linenos=" 8 "></span></a>B2=16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858351026
<a id="__codelineno-54-9" name="__codelineno-54-9"></a><a href="#__codelineno-54-9"><span class="linenos" data-linenos=" 9 "></span></a>n=85492663786275292159831603391083876175149354309327673008716627650718160585639723100793347534649628330416631255660901307533909900431413447524262332232659153047067908693481947121069070451562822417357656432171870951184673132554213690123308042697361969986360375060954702920656364144154145812838558365334172935931441424096270206140691814662318562696925767991937369782627908408239087358033165410020690152067715711112732252038588432896758405898709010342467882264362733
<a id="__codelineno-54-10" name="__codelineno-54-10"></a><a href="#__codelineno-54-10"><span class="linenos" data-linenos="10 "></span></a>e=0x1001
<a id="__codelineno-54-11" name="__codelineno-54-11"></a><a href="#__codelineno-54-11"><span class="linenos" data-linenos="11 "></span></a>c=75700883021669577739329316795450706204502635802310731477156998834710820770245219468703245302009998932067080383977560299708060476222089630209972629755965140317526034680452483360917378812244365884527186056341888615564335560765053550155758362271622330017433403027261127561225585912484777829588501213961110690451987625502701331485141639684356427316905122995759825241133872734362716041819819948645662803292418802204430874521342108413623635150475963121220095236776428
<a id="__codelineno-54-12" name="__codelineno-54-12"></a><a href="#__codelineno-54-12"><span class="linenos" data-linenos="12 "></span></a>
<a id="__codelineno-54-13" name="__codelineno-54-13"></a><a href="#__codelineno-54-13"><span class="linenos" data-linenos="13 "></span></a>p = 1 ; q = 1
<a id="__codelineno-54-14" name="__codelineno-54-14"></a><a href="#__codelineno-54-14"><span class="linenos" data-linenos="14 "></span></a>for i in range( B1+1 , A1 ):
<a id="__codelineno-54-15" name="__codelineno-54-15"></a><a href="#__codelineno-54-15"><span class="linenos" data-linenos="15 "></span></a>    p = p * i % A1
<a id="__codelineno-54-16" name="__codelineno-54-16"></a><a href="#__codelineno-54-16"><span class="linenos" data-linenos="16 "></span></a>p = nextprime(-invert( p , A1 ) % A1)
<a id="__codelineno-54-17" name="__codelineno-54-17"></a><a href="#__codelineno-54-17"><span class="linenos" data-linenos="17 "></span></a>for i in range( B2+1 , A2 ):
<a id="__codelineno-54-18" name="__codelineno-54-18"></a><a href="#__codelineno-54-18"><span class="linenos" data-linenos="18 "></span></a>    q = q * i % A2
<a id="__codelineno-54-19" name="__codelineno-54-19"></a><a href="#__codelineno-54-19"><span class="linenos" data-linenos="19 "></span></a>q = nextprime(-invert( q , A2 ) % A2)
<a id="__codelineno-54-20" name="__codelineno-54-20"></a><a href="#__codelineno-54-20"><span class="linenos" data-linenos="20 "></span></a>
<a id="__codelineno-54-21" name="__codelineno-54-21"></a><a href="#__codelineno-54-21"><span class="linenos" data-linenos="21 "></span></a>r = n // ( p * q )
<a id="__codelineno-54-22" name="__codelineno-54-22"></a><a href="#__codelineno-54-22"><span class="linenos" data-linenos="22 "></span></a>d = gmpy2.invert(e,(p-1)*(q-1)*(r-1))
<a id="__codelineno-54-23" name="__codelineno-54-23"></a><a href="#__codelineno-54-23"><span class="linenos" data-linenos="23 "></span></a>print( long_to_bytes( pow( c , d , n ) ) ) 
</code></pre></div>
<p>flag:<code>flag{wm-CongrAtu1ation4-1t4-ju4t-A-bAby-R4A}</code></p>
<h3 id="buuctfbjdctf2020rsa_output">[BUUCTF·BJDCTF2020]rsa_output<a class="headerlink" href="#buuctfbjdctf2020rsa_output" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1"></a><a href="#__codelineno-55-1"><span class="linenos" data-linenos="1 "></span></a>{21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111,2767}
<a id="__codelineno-55-2" name="__codelineno-55-2"></a><a href="#__codelineno-55-2"><span class="linenos" data-linenos="2 "></span></a>
<a id="__codelineno-55-3" name="__codelineno-55-3"></a><a href="#__codelineno-55-3"><span class="linenos" data-linenos="3 "></span></a>{21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111,3659}
<a id="__codelineno-55-4" name="__codelineno-55-4"></a><a href="#__codelineno-55-4"><span class="linenos" data-linenos="4 "></span></a>
<a id="__codelineno-55-5" name="__codelineno-55-5"></a><a href="#__codelineno-55-5"><span class="linenos" data-linenos="5 "></span></a>message1=20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599
<a id="__codelineno-55-6" name="__codelineno-55-6"></a><a href="#__codelineno-55-6"><span class="linenos" data-linenos="6 "></span></a>
<a id="__codelineno-55-7" name="__codelineno-55-7"></a><a href="#__codelineno-55-7"><span class="linenos" data-linenos="7 "></span></a>message2=11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227
</code></pre></div>
<p>知道n和两组e两组c，故是共膜攻击</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1"></a><a href="#__codelineno-56-1"><span class="linenos" data-linenos=" 1 "></span></a>import gmpy2
<a id="__codelineno-56-2" name="__codelineno-56-2"></a><a href="#__codelineno-56-2"><span class="linenos" data-linenos=" 2 "></span></a>from Crypto.Util.number import long_to_bytes
<a id="__codelineno-56-3" name="__codelineno-56-3"></a><a href="#__codelineno-56-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-56-4" name="__codelineno-56-4"></a><a href="#__codelineno-56-4"><span class="linenos" data-linenos=" 4 "></span></a>n = 21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111
<a id="__codelineno-56-5" name="__codelineno-56-5"></a><a href="#__codelineno-56-5"><span class="linenos" data-linenos=" 5 "></span></a>e1 = 2767
<a id="__codelineno-56-6" name="__codelineno-56-6"></a><a href="#__codelineno-56-6"><span class="linenos" data-linenos=" 6 "></span></a>e2 = 3659
<a id="__codelineno-56-7" name="__codelineno-56-7"></a><a href="#__codelineno-56-7"><span class="linenos" data-linenos=" 7 "></span></a>
<a id="__codelineno-56-8" name="__codelineno-56-8"></a><a href="#__codelineno-56-8"><span class="linenos" data-linenos=" 8 "></span></a>c1 = 20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599
<a id="__codelineno-56-9" name="__codelineno-56-9"></a><a href="#__codelineno-56-9"><span class="linenos" data-linenos=" 9 "></span></a>c2 = 11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227
<a id="__codelineno-56-10" name="__codelineno-56-10"></a><a href="#__codelineno-56-10"><span class="linenos" data-linenos="10 "></span></a>
<a id="__codelineno-56-11" name="__codelineno-56-11"></a><a href="#__codelineno-56-11"><span class="linenos" data-linenos="11 "></span></a>def exgcd( a , b ):
<a id="__codelineno-56-12" name="__codelineno-56-12"></a><a href="#__codelineno-56-12"><span class="linenos" data-linenos="12 "></span></a>    if a == 0:
<a id="__codelineno-56-13" name="__codelineno-56-13"></a><a href="#__codelineno-56-13"><span class="linenos" data-linenos="13 "></span></a>        return ( b , 0 , 1 )
<a id="__codelineno-56-14" name="__codelineno-56-14"></a><a href="#__codelineno-56-14"><span class="linenos" data-linenos="14 "></span></a>    else:
<a id="__codelineno-56-15" name="__codelineno-56-15"></a><a href="#__codelineno-56-15"><span class="linenos" data-linenos="15 "></span></a>        g , y , x = exgcd( b % a , a )
<a id="__codelineno-56-16" name="__codelineno-56-16"></a><a href="#__codelineno-56-16"><span class="linenos" data-linenos="16 "></span></a>        return ( g , x - ( b // a ) * y , y )
<a id="__codelineno-56-17" name="__codelineno-56-17"></a><a href="#__codelineno-56-17"><span class="linenos" data-linenos="17 "></span></a>
<a id="__codelineno-56-18" name="__codelineno-56-18"></a><a href="#__codelineno-56-18"><span class="linenos" data-linenos="18 "></span></a>s = exgcd( e1 , e2 )
<a id="__codelineno-56-19" name="__codelineno-56-19"></a><a href="#__codelineno-56-19"><span class="linenos" data-linenos="19 "></span></a>s1 = -s[1] ; s2 = s[2]
<a id="__codelineno-56-20" name="__codelineno-56-20"></a><a href="#__codelineno-56-20"><span class="linenos" data-linenos="20 "></span></a>c1 = gmpy2.invert( c1 , n )
<a id="__codelineno-56-21" name="__codelineno-56-21"></a><a href="#__codelineno-56-21"><span class="linenos" data-linenos="21 "></span></a>m = ( pow( c1 , s1 ) * pow( c2 , s2 ) ) % n
<a id="__codelineno-56-22" name="__codelineno-56-22"></a><a href="#__codelineno-56-22"><span class="linenos" data-linenos="22 "></span></a>print( long_to_bytes( m ) )
</code></pre></div>
<p>flag:<code>flag{r3a_C0mmoN_moD@_4ttack}</code></p>
<h3 id="buuctfsamemod">[BUUCTF]SameMod<a class="headerlink" href="#buuctfsamemod" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1"></a><a href="#__codelineno-57-1"><span class="linenos" data-linenos="1 "></span></a>{6266565720726907265997241358331585417095726146341989755538017122981360742813498401533594757088796536341941659691259323065631249,773}
<a id="__codelineno-57-2" name="__codelineno-57-2"></a><a href="#__codelineno-57-2"><span class="linenos" data-linenos="2 "></span></a>{6266565720726907265997241358331585417095726146341989755538017122981360742813498401533594757088796536341941659691259323065631249,839}
<a id="__codelineno-57-3" name="__codelineno-57-3"></a><a href="#__codelineno-57-3"><span class="linenos" data-linenos="3 "></span></a>
<a id="__codelineno-57-4" name="__codelineno-57-4"></a><a href="#__codelineno-57-4"><span class="linenos" data-linenos="4 "></span></a>message1=3453520592723443935451151545245025864232388871721682326408915024349804062041976702364728660682912396903968193981131553111537349
<a id="__codelineno-57-5" name="__codelineno-57-5"></a><a href="#__codelineno-57-5"><span class="linenos" data-linenos="5 "></span></a>message2=5672818026816293344070119332536629619457163570036305296869053532293105379690793386019065754465292867769521736414170803238309535
</code></pre></div>
<p>很好的共膜攻击，使我的python翻转</p>
<p>使用传统的<code>long_to_bytes</code>解出得到的是乱码</p>
<p>好多1哇·······那个97好眼熟——实际上正解是通过ascll码进行转化得到flag</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1"></a><a href="#__codelineno-58-1"><span class="linenos" data-linenos=" 1 "></span></a>import gmpy2
<a id="__codelineno-58-2" name="__codelineno-58-2"></a><a href="#__codelineno-58-2"><span class="linenos" data-linenos=" 2 "></span></a>from Crypto.Util.number import long_to_bytes
<a id="__codelineno-58-3" name="__codelineno-58-3"></a><a href="#__codelineno-58-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-58-4" name="__codelineno-58-4"></a><a href="#__codelineno-58-4"><span class="linenos" data-linenos=" 4 "></span></a>n = 6266565720726907265997241358331585417095726146341989755538017122981360742813498401533594757088796536341941659691259323065631249
<a id="__codelineno-58-5" name="__codelineno-58-5"></a><a href="#__codelineno-58-5"><span class="linenos" data-linenos=" 5 "></span></a>e1 = 773
<a id="__codelineno-58-6" name="__codelineno-58-6"></a><a href="#__codelineno-58-6"><span class="linenos" data-linenos=" 6 "></span></a>e2 = 839
<a id="__codelineno-58-7" name="__codelineno-58-7"></a><a href="#__codelineno-58-7"><span class="linenos" data-linenos=" 7 "></span></a>c1 = 3453520592723443935451151545245025864232388871721682326408915024349804062041976702364728660682912396903968193981131553111537349
<a id="__codelineno-58-8" name="__codelineno-58-8"></a><a href="#__codelineno-58-8"><span class="linenos" data-linenos=" 8 "></span></a>c2 = 5672818026816293344070119332536629619457163570036305296869053532293105379690793386019065754465292867769521736414170803238309535
<a id="__codelineno-58-9" name="__codelineno-58-9"></a><a href="#__codelineno-58-9"><span class="linenos" data-linenos=" 9 "></span></a>
<a id="__codelineno-58-10" name="__codelineno-58-10"></a><a href="#__codelineno-58-10"><span class="linenos" data-linenos="10 "></span></a>def exgcd( a , b ):
<a id="__codelineno-58-11" name="__codelineno-58-11"></a><a href="#__codelineno-58-11"><span class="linenos" data-linenos="11 "></span></a>    if a == 0:
<a id="__codelineno-58-12" name="__codelineno-58-12"></a><a href="#__codelineno-58-12"><span class="linenos" data-linenos="12 "></span></a>        return ( b , 0 , 1 )
<a id="__codelineno-58-13" name="__codelineno-58-13"></a><a href="#__codelineno-58-13"><span class="linenos" data-linenos="13 "></span></a>    else:
<a id="__codelineno-58-14" name="__codelineno-58-14"></a><a href="#__codelineno-58-14"><span class="linenos" data-linenos="14 "></span></a>        g , y , x = exgcd( b % a , a )
<a id="__codelineno-58-15" name="__codelineno-58-15"></a><a href="#__codelineno-58-15"><span class="linenos" data-linenos="15 "></span></a>        return ( g , x - ( b // a ) * y , y )
<a id="__codelineno-58-16" name="__codelineno-58-16"></a><a href="#__codelineno-58-16"><span class="linenos" data-linenos="16 "></span></a>
<a id="__codelineno-58-17" name="__codelineno-58-17"></a><a href="#__codelineno-58-17"><span class="linenos" data-linenos="17 "></span></a>s = exgcd( e1 , e2 )
<a id="__codelineno-58-18" name="__codelineno-58-18"></a><a href="#__codelineno-58-18"><span class="linenos" data-linenos="18 "></span></a>s1 = -s[1] ; s2 = s[2]
<a id="__codelineno-58-19" name="__codelineno-58-19"></a><a href="#__codelineno-58-19"><span class="linenos" data-linenos="19 "></span></a>c1 = gmpy2.invert( c1 , n )
<a id="__codelineno-58-20" name="__codelineno-58-20"></a><a href="#__codelineno-58-20"><span class="linenos" data-linenos="20 "></span></a>m = str(( pow( c1 , s1 ) * pow( c2 , s2 ) ) % n)
<a id="__codelineno-58-21" name="__codelineno-58-21"></a><a href="#__codelineno-58-21"><span class="linenos" data-linenos="21 "></span></a>cnt = 0
<a id="__codelineno-58-22" name="__codelineno-58-22"></a><a href="#__codelineno-58-22"><span class="linenos" data-linenos="22 "></span></a>num = &quot;&quot;
<a id="__codelineno-58-23" name="__codelineno-58-23"></a><a href="#__codelineno-58-23"><span class="linenos" data-linenos="23 "></span></a>top = 3
<a id="__codelineno-58-24" name="__codelineno-58-24"></a><a href="#__codelineno-58-24"><span class="linenos" data-linenos="24 "></span></a>for i in m:
<a id="__codelineno-58-25" name="__codelineno-58-25"></a><a href="#__codelineno-58-25"><span class="linenos" data-linenos="25 "></span></a>    num = num + i
<a id="__codelineno-58-26" name="__codelineno-58-26"></a><a href="#__codelineno-58-26"><span class="linenos" data-linenos="26 "></span></a>    cnt += 1
<a id="__codelineno-58-27" name="__codelineno-58-27"></a><a href="#__codelineno-58-27"><span class="linenos" data-linenos="27 "></span></a>    if num[0] == &quot;1&quot;:
<a id="__codelineno-58-28" name="__codelineno-58-28"></a><a href="#__codelineno-58-28"><span class="linenos" data-linenos="28 "></span></a>        top = 3
<a id="__codelineno-58-29" name="__codelineno-58-29"></a><a href="#__codelineno-58-29"><span class="linenos" data-linenos="29 "></span></a>    else:
<a id="__codelineno-58-30" name="__codelineno-58-30"></a><a href="#__codelineno-58-30"><span class="linenos" data-linenos="30 "></span></a>        top = 2
<a id="__codelineno-58-31" name="__codelineno-58-31"></a><a href="#__codelineno-58-31"><span class="linenos" data-linenos="31 "></span></a>    if cnt == top:
<a id="__codelineno-58-32" name="__codelineno-58-32"></a><a href="#__codelineno-58-32"><span class="linenos" data-linenos="32 "></span></a>        cnt = 0
<a id="__codelineno-58-33" name="__codelineno-58-33"></a><a href="#__codelineno-58-33"><span class="linenos" data-linenos="33 "></span></a>        print( chr(int(num)) , end=&quot;&quot; )
<a id="__codelineno-58-34" name="__codelineno-58-34"></a><a href="#__codelineno-58-34"><span class="linenos" data-linenos="34 "></span></a>        num = &quot;&quot;
</code></pre></div>
<p>flag:<code>flag{whenwethinkitispossible}</code></p>
<h3 id="buuctfbjdctf2020easyrsa">[BUUCTF·BJDCTF2020]easyrsa<a class="headerlink" href="#buuctfbjdctf2020easyrsa" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-59-1" name="__codelineno-59-1"></a><a href="#__codelineno-59-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import getPrime,bytes_to_long
<a id="__codelineno-59-2" name="__codelineno-59-2"></a><a href="#__codelineno-59-2"><span class="linenos" data-linenos=" 2 "></span></a>from sympy import Derivative
<a id="__codelineno-59-3" name="__codelineno-59-3"></a><a href="#__codelineno-59-3"><span class="linenos" data-linenos=" 3 "></span></a>from fractions import Fraction
<a id="__codelineno-59-4" name="__codelineno-59-4"></a><a href="#__codelineno-59-4"><span class="linenos" data-linenos=" 4 "></span></a>from secret import flag
<a id="__codelineno-59-5" name="__codelineno-59-5"></a><a href="#__codelineno-59-5"><span class="linenos" data-linenos=" 5 "></span></a>
<a id="__codelineno-59-6" name="__codelineno-59-6"></a><a href="#__codelineno-59-6"><span class="linenos" data-linenos=" 6 "></span></a>p=getPrime(1024)
<a id="__codelineno-59-7" name="__codelineno-59-7"></a><a href="#__codelineno-59-7"><span class="linenos" data-linenos=" 7 "></span></a>q=getPrime(1024)
<a id="__codelineno-59-8" name="__codelineno-59-8"></a><a href="#__codelineno-59-8"><span class="linenos" data-linenos=" 8 "></span></a>e=65537
<a id="__codelineno-59-9" name="__codelineno-59-9"></a><a href="#__codelineno-59-9"><span class="linenos" data-linenos=" 9 "></span></a>n=p*q
<a id="__codelineno-59-10" name="__codelineno-59-10"></a><a href="#__codelineno-59-10"><span class="linenos" data-linenos="10 "></span></a>z=Fraction(1,Derivative(arctan(p),p))-Fraction(1,Derivative(arth(q),q))
<a id="__codelineno-59-11" name="__codelineno-59-11"></a><a href="#__codelineno-59-11"><span class="linenos" data-linenos="11 "></span></a>m=bytes_to_long(flag)
<a id="__codelineno-59-12" name="__codelineno-59-12"></a><a href="#__codelineno-59-12"><span class="linenos" data-linenos="12 "></span></a>c=pow(m,e,n)
<a id="__codelineno-59-13" name="__codelineno-59-13"></a><a href="#__codelineno-59-13"><span class="linenos" data-linenos="13 "></span></a>print(c,z,n)
<a id="__codelineno-59-14" name="__codelineno-59-14"></a><a href="#__codelineno-59-14"><span class="linenos" data-linenos="14 "></span></a>&#39;&#39;&#39;
<a id="__codelineno-59-15" name="__codelineno-59-15"></a><a href="#__codelineno-59-15"><span class="linenos" data-linenos="15 "></span></a>output:
<a id="__codelineno-59-16" name="__codelineno-59-16"></a><a href="#__codelineno-59-16"><span class="linenos" data-linenos="16 "></span></a>7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035
<a id="__codelineno-59-17" name="__codelineno-59-17"></a><a href="#__codelineno-59-17"><span class="linenos" data-linenos="17 "></span></a>32115748677623209667471622872185275070257924766015020072805267359839059393284316595882933372289732127274076434587519333300142473010344694803885168557548801202495933226215437763329280242113556524498457559562872900811602056944423967403777623306961880757613246328729616643032628964072931272085866928045973799374711846825157781056965164178505232524245809179235607571567174228822561697888645968559343608375331988097157145264357626738141646556353500994924115875748198318036296898604097000938272195903056733565880150540275369239637793975923329598716003350308259321436752579291000355560431542229699759955141152914708362494482
<a id="__codelineno-59-18" name="__codelineno-59-18"></a><a href="#__codelineno-59-18"><span class="linenos" data-linenos="18 "></span></a>15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441
<a id="__codelineno-59-19" name="__codelineno-59-19"></a><a href="#__codelineno-59-19"><span class="linenos" data-linenos="19 "></span></a>&#39;&#39;&#39;
</code></pre></div>
<p><img alt="" src="asserts\2024.1.6.jpg" /></p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-60-1" name="__codelineno-60-1"></a><a href="#__codelineno-60-1"><span class="linenos" data-linenos=" 1 "></span></a>import gmpy2
<a id="__codelineno-60-2" name="__codelineno-60-2"></a><a href="#__codelineno-60-2"><span class="linenos" data-linenos=" 2 "></span></a>from Crypto.Util.number import long_to_bytes
<a id="__codelineno-60-3" name="__codelineno-60-3"></a><a href="#__codelineno-60-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-60-4" name="__codelineno-60-4"></a><a href="#__codelineno-60-4"><span class="linenos" data-linenos=" 4 "></span></a>c = 7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035
<a id="__codelineno-60-5" name="__codelineno-60-5"></a><a href="#__codelineno-60-5"><span class="linenos" data-linenos=" 5 "></span></a>z = 32115748677623209667471622872185275070257924766015020072805267359839059393284316595882933372289732127274076434587519333300142473010344694803885168557548801202495933226215437763329280242113556524498457559562872900811602056944423967403777623306961880757613246328729616643032628964072931272085866928045973799374711846825157781056965164178505232524245809179235607571567174228822561697888645968559343608375331988097157145264357626738141646556353500994924115875748198318036296898604097000938272195903056733565880150540275369239637793975923329598716003350308259321436752579291000355560431542229699759955141152914708362494482
<a id="__codelineno-60-6" name="__codelineno-60-6"></a><a href="#__codelineno-60-6"><span class="linenos" data-linenos=" 6 "></span></a>n = 15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441
<a id="__codelineno-60-7" name="__codelineno-60-7"></a><a href="#__codelineno-60-7"><span class="linenos" data-linenos=" 7 "></span></a>e = 65537
<a id="__codelineno-60-8" name="__codelineno-60-8"></a><a href="#__codelineno-60-8"><span class="linenos" data-linenos=" 8 "></span></a>p = (gmpy2.iroot(z+n*2,2)[0]+gmpy2.iroot(z-n*2,2)[0])//2
<a id="__codelineno-60-9" name="__codelineno-60-9"></a><a href="#__codelineno-60-9"><span class="linenos" data-linenos=" 9 "></span></a>q = (gmpy2.iroot(z+n*2,2)[0]-gmpy2.iroot(z-n*2,2)[0])//2
<a id="__codelineno-60-10" name="__codelineno-60-10"></a><a href="#__codelineno-60-10"><span class="linenos" data-linenos="10 "></span></a>
<a id="__codelineno-60-11" name="__codelineno-60-11"></a><a href="#__codelineno-60-11"><span class="linenos" data-linenos="11 "></span></a>phi = (p-1)*(q-1)
<a id="__codelineno-60-12" name="__codelineno-60-12"></a><a href="#__codelineno-60-12"><span class="linenos" data-linenos="12 "></span></a>d = gmpy2.invert( e , phi )
<a id="__codelineno-60-13" name="__codelineno-60-13"></a><a href="#__codelineno-60-13"><span class="linenos" data-linenos="13 "></span></a>m = pow( c , d , n )
<a id="__codelineno-60-14" name="__codelineno-60-14"></a><a href="#__codelineno-60-14"><span class="linenos" data-linenos="14 "></span></a>print( long_to_bytes( m ) )
</code></pre></div>
<p>flag:<code>flag{Advanced_mathematics_is_too_hard!!!}</code></p>
<h3 id="wieners-attack">维纳攻击（Wiener's Attack）<a class="headerlink" href="#wieners-attack" title="Permanent link">&para;</a></h3>
<p>要求：</p>
<ol>
<li><span class="arithmatex">\(p\)</span> 和 <span class="arithmatex">\(q\)</span> 相差不远</li>
<li><span class="arithmatex">\(d&lt;\frac{1}{3}n^{\frac{1}{4}}\)</span></li>
<li><span class="arithmatex">\(q &lt; p  &lt; 2 * q\)</span></li>
</ol>
<p>公式推导：</p>
<p>因为 <span class="arithmatex">\(e d ≡ 1 mod phi\)</span></p>
<p>所以 <span class="arithmatex">\(e * d - t * phi = 1\)</span>，其中 <span class="arithmatex">\(t\)</span> 为整数</p>
<p>因为 <span class="arithmatex">\(n = p * q  &gt; q^2\)</span> ，则有$ q &lt; \sqrt{n}$</p>
<p>所以 <span class="arithmatex">\(n - phi = p + q - 1 &lt; 3 * q - 1 &lt; 3 * q &lt; 3\sqrt{n}\)</span></p>
<p>故有<span class="arithmatex">\(\lvert\frac{e}{n}-\frac{t}{a}\rvert\)</span>=<span class="arithmatex">\(\lvert\frac{ed-tn}{dn}\rvert\)</span>=<span class="arithmatex">\(\lvert\frac{1+t(phi-n)}{dn}\rvert\)</span>&lt;<span class="arithmatex">\(\frac{3t\sqrt{n}}{dn}\)</span>=<span class="arithmatex">\(\frac{3t}{d\sqrt{n}}\)</span></p>
<p>由于<span class="arithmatex">\(t&lt;a\)</span>，故 原式&lt;<span class="arithmatex">\(\frac{1}{dn^{\frac{1}{4}}}\)</span>&lt;<span class="arithmatex">\(\frac{1}{3d^2}\)</span></p>
<p>综上所述，<span class="arithmatex">\(\lvert\frac{e}{n}-\frac{t}{a}\rvert\)</span> &lt; <span class="arithmatex">\(\frac{1}{3d^2}\)</span></p>
<p>此时，<span class="arithmatex">\(\frac{t}{a}\)</span>是<span class="arithmatex">\(\frac{b}{n}\)</span>的一个收敛子</p>
<h3 id="legendre">Legendre理论<a class="headerlink" href="#legendre" title="Permanent link">&para;</a></h3>
<p>已知<span class="arithmatex">\(\lvert\frac{(p_1-p_2)q_1q_2}{p_2}\rvert&lt;\frac12\)</span>，则可推得<span class="arithmatex">\(\lvert\frac{N_1}{N_2}-\frac{q_1}{q_2}\rvert&lt;\frac{1}{2q_2^2}\)</span></p>
<p>所以<span class="arithmatex">\(\frac{q_1}{q_2}\)</span>是<span class="arithmatex">\(\frac{N_1}{N_2}\)</span> 的收敛子，用连分数即可求得<span class="arithmatex">\(q_1\)</span>,<span class="arithmatex">\(q_2\)</span></p>
<h3 id="easy_aes">Easy_AES<a class="headerlink" href="#easy_aes" title="Permanent link">&para;</a></h3>
<p>pedding填充方式是在前面填充<code>b'\t\t\t\t\t\t\t\t\t'</code></p>
<p>因而前15位永远是<code>\t\t\t\t\t\t\t\t\tISCTF{</code></p>
<p>进而可以爆破得到key</p>
<p>已知enc，可以取它的前16位来爆破iv，进而得到flag</p>
<p>flag{1b106cea3fb848e7bea310c9851f15c1}</p>
<h3 id="isctf20231zrsa">[ISCTF2023]1zRSA<a class="headerlink" href="#isctf20231zrsa" title="Permanent link">&para;</a></h3>
<p>Legendre理论:</p>
<p>已知<span class="arithmatex">\(\lvert\frac{(p_1-p_2)q_1q_2}{p_2}\rvert&lt;\frac12\)</span>，则可推得<span class="arithmatex">\(\lvert\frac{N_1}{N_2}-\frac{q_1}{q_2}\rvert&lt;\frac{1}{2q_2^2}\)</span></p>
<p>所以<span class="arithmatex">\(\frac{q_1}{q_2}\)</span>是<span class="arithmatex">\(\frac{N_1}{N_2}\)</span> 连分数展开的某一项的渐进分数</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-61-1" name="__codelineno-61-1"></a><a href="#__codelineno-61-1"><span class="linenos" data-linenos="1 "></span></a>每个连分数都可以看作由两个数列组成：一个是整数部分的数列，另一个是分数的数列。——《普林斯顿数学指南》
</code></pre></div>
<p>通过辗转相除法，求得连分数展开形式：具体操作是：</p>
<p>计算商数作为整数部分，计算余数/除数得到分数部分，取分数的倒数置于分母，进行下一轮的运行，直到可以整除为止，过程中得到的整数部分顺序排列即为连分数展开形式的数列</p>
<p>对于渐进分数，有 <span class="arithmatex">\(p_i=a_ip_{i-1}+p_{i-2}\)</span> ，<span class="arithmatex">\(q_i=a_iq_{i-1}+q_{i-2}\)</span> </p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-62-1" name="__codelineno-62-1"></a><a href="#__codelineno-62-1"><span class="linenos" data-linenos="1 "></span></a>#OI-wiki上的代码
<a id="__codelineno-62-2" name="__codelineno-62-2"></a><a href="#__codelineno-62-2"><span class="linenos" data-linenos="2 "></span></a>def fraction(p, q):
<a id="__codelineno-62-3" name="__codelineno-62-3"></a><a href="#__codelineno-62-3"><span class="linenos" data-linenos="3 "></span></a>    a = []
<a id="__codelineno-62-4" name="__codelineno-62-4"></a><a href="#__codelineno-62-4"><span class="linenos" data-linenos="4 "></span></a>    while q:
<a id="__codelineno-62-5" name="__codelineno-62-5"></a><a href="#__codelineno-62-5"><span class="linenos" data-linenos="5 "></span></a>        a.append(p // q)
<a id="__codelineno-62-6" name="__codelineno-62-6"></a><a href="#__codelineno-62-6"><span class="linenos" data-linenos="6 "></span></a>        p, q = q, p % q
<a id="__codelineno-62-7" name="__codelineno-62-7"></a><a href="#__codelineno-62-7"><span class="linenos" data-linenos="7 "></span></a>    return a
</code></pre></div>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-63-1" name="__codelineno-63-1"></a><a href="#__codelineno-63-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import long_to_bytes
<a id="__codelineno-63-2" name="__codelineno-63-2"></a><a href="#__codelineno-63-2"><span class="linenos" data-linenos=" 2 "></span></a>import gmpy2
<a id="__codelineno-63-3" name="__codelineno-63-3"></a><a href="#__codelineno-63-3"><span class="linenos" data-linenos=" 3 "></span></a>c = 
<a id="__codelineno-63-4" name="__codelineno-63-4"></a><a href="#__codelineno-63-4"><span class="linenos" data-linenos=" 4 "></span></a>N1 = 
<a id="__codelineno-63-5" name="__codelineno-63-5"></a><a href="#__codelineno-63-5"><span class="linenos" data-linenos=" 5 "></span></a>N2 = 
<a id="__codelineno-63-6" name="__codelineno-63-6"></a><a href="#__codelineno-63-6"><span class="linenos" data-linenos=" 6 "></span></a>e = 
<a id="__codelineno-63-7" name="__codelineno-63-7"></a><a href="#__codelineno-63-7"><span class="linenos" data-linenos=" 7 "></span></a>
<a id="__codelineno-63-8" name="__codelineno-63-8"></a><a href="#__codelineno-63-8"><span class="linenos" data-linenos=" 8 "></span></a>a = []
<a id="__codelineno-63-9" name="__codelineno-63-9"></a><a href="#__codelineno-63-9"><span class="linenos" data-linenos=" 9 "></span></a>p = []
<a id="__codelineno-63-10" name="__codelineno-63-10"></a><a href="#__codelineno-63-10"><span class="linenos" data-linenos="10 "></span></a>q = []
<a id="__codelineno-63-11" name="__codelineno-63-11"></a><a href="#__codelineno-63-11"><span class="linenos" data-linenos="11 "></span></a>def get_a( p , q ):
<a id="__codelineno-63-12" name="__codelineno-63-12"></a><a href="#__codelineno-63-12"><span class="linenos" data-linenos="12 "></span></a>    a.append( p // q )
<a id="__codelineno-63-13" name="__codelineno-63-13"></a><a href="#__codelineno-63-13"><span class="linenos" data-linenos="13 "></span></a>    if p % q != 0:
<a id="__codelineno-63-14" name="__codelineno-63-14"></a><a href="#__codelineno-63-14"><span class="linenos" data-linenos="14 "></span></a>        get_a( q , p%q )
<a id="__codelineno-63-15" name="__codelineno-63-15"></a><a href="#__codelineno-63-15"><span class="linenos" data-linenos="15 "></span></a>get_a( N1 , N2 )
<a id="__codelineno-63-16" name="__codelineno-63-16"></a><a href="#__codelineno-63-16"><span class="linenos" data-linenos="16 "></span></a>p.append( a[0] ) , p.append( a[0]*a[1]+1 )
<a id="__codelineno-63-17" name="__codelineno-63-17"></a><a href="#__codelineno-63-17"><span class="linenos" data-linenos="17 "></span></a>q.append( 1 ) , q.append( a[1] )
<a id="__codelineno-63-18" name="__codelineno-63-18"></a><a href="#__codelineno-63-18"><span class="linenos" data-linenos="18 "></span></a>for i in range( 2 , len(a)-1 ):
<a id="__codelineno-63-19" name="__codelineno-63-19"></a><a href="#__codelineno-63-19"><span class="linenos" data-linenos="19 "></span></a>    p.append( a[i]*p[i-1]+p[i-2] )
<a id="__codelineno-63-20" name="__codelineno-63-20"></a><a href="#__codelineno-63-20"><span class="linenos" data-linenos="20 "></span></a>    q.append( a[i]*q[i-1]+q[i-2] )
<a id="__codelineno-63-21" name="__codelineno-63-21"></a><a href="#__codelineno-63-21"><span class="linenos" data-linenos="21 "></span></a>for i in range( 0 , len(a)-1 ):
<a id="__codelineno-63-22" name="__codelineno-63-22"></a><a href="#__codelineno-63-22"><span class="linenos" data-linenos="22 "></span></a>    if N1 % p[i] == 0 and p[i] != 1:
<a id="__codelineno-63-23" name="__codelineno-63-23"></a><a href="#__codelineno-63-23"><span class="linenos" data-linenos="23 "></span></a>        d = gmpy2.invert( e , (p[i]-1)*(N1//p[i]-1) )
<a id="__codelineno-63-24" name="__codelineno-63-24"></a><a href="#__codelineno-63-24"><span class="linenos" data-linenos="24 "></span></a>        m = pow( c , d , N1 )
<a id="__codelineno-63-25" name="__codelineno-63-25"></a><a href="#__codelineno-63-25"><span class="linenos" data-linenos="25 "></span></a>        print( long_to_bytes( m ) )
</code></pre></div>
<p>flag:<code>ISCTF{6f3af9a9-2727-4d48-afb4-9ca82de893f3}</code></p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-64-1" name="__codelineno-64-1"></a><a href="#__codelineno-64-1"><span class="linenos" data-linenos="1 "></span></a>references:
<a id="__codelineno-64-2" name="__codelineno-64-2"></a><a href="#__codelineno-64-2"><span class="linenos" data-linenos="2 "></span></a>https://math.stackexchange.com/questions/531736/legendres-proof-continued-fractions-from-hardys-book
<a id="__codelineno-64-3" name="__codelineno-64-3"></a><a href="#__codelineno-64-3"><span class="linenos" data-linenos="3 "></span></a>https://chaoli.club/index.php/2756/0
<a id="__codelineno-64-4" name="__codelineno-64-4"></a><a href="#__codelineno-64-4"><span class="linenos" data-linenos="4 "></span></a>https://oi-wiki.org/math/number-theory/continued-fraction/
</code></pre></div>
<h3 id="polarctf2023basecrypto">[PolarCTF网络安全2023冬季]base（CRYPTO）<a class="headerlink" href="#polarctf2023basecrypto" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-65-1" name="__codelineno-65-1"></a><a href="#__codelineno-65-1"><span class="linenos" data-linenos=" 1 "></span></a>import base64
<a id="__codelineno-65-2" name="__codelineno-65-2"></a><a href="#__codelineno-65-2"><span class="linenos" data-linenos=" 2 "></span></a>import struct
<a id="__codelineno-65-3" name="__codelineno-65-3"></a><a href="#__codelineno-65-3"><span class="linenos" data-linenos=" 3 "></span></a>raw_table = &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&#39;
<a id="__codelineno-65-4" name="__codelineno-65-4"></a><a href="#__codelineno-65-4"><span class="linenos" data-linenos=" 4 "></span></a>new_table = &#39;GHI3KLMNJOPQRSTUb=cdefghijklmnopWXYZ/12+406789VaqrstuvwxyzABCDEF5&#39;
<a id="__codelineno-65-5" name="__codelineno-65-5"></a><a href="#__codelineno-65-5"><span class="linenos" data-linenos=" 5 "></span></a>
<a id="__codelineno-65-6" name="__codelineno-65-6"></a><a href="#__codelineno-65-6"><span class="linenos" data-linenos=" 6 "></span></a>cipher = &#39;j2rXjx8wSZjD&#39;
<a id="__codelineno-65-7" name="__codelineno-65-7"></a><a href="#__codelineno-65-7"><span class="linenos" data-linenos=" 7 "></span></a>flag = &quot;&quot;
<a id="__codelineno-65-8" name="__codelineno-65-8"></a><a href="#__codelineno-65-8"><span class="linenos" data-linenos=" 8 "></span></a>
<a id="__codelineno-65-9" name="__codelineno-65-9"></a><a href="#__codelineno-65-9"><span class="linenos" data-linenos=" 9 "></span></a>for i in cipher:
<a id="__codelineno-65-10" name="__codelineno-65-10"></a><a href="#__codelineno-65-10"><span class="linenos" data-linenos="10 "></span></a>    for j in range( len(raw_table) ):
<a id="__codelineno-65-11" name="__codelineno-65-11"></a><a href="#__codelineno-65-11"><span class="linenos" data-linenos="11 "></span></a>        #print( i )
<a id="__codelineno-65-12" name="__codelineno-65-12"></a><a href="#__codelineno-65-12"><span class="linenos" data-linenos="12 "></span></a>        #print( new_table[j] )
<a id="__codelineno-65-13" name="__codelineno-65-13"></a><a href="#__codelineno-65-13"><span class="linenos" data-linenos="13 "></span></a>        if i == new_table[j]:
<a id="__codelineno-65-14" name="__codelineno-65-14"></a><a href="#__codelineno-65-14"><span class="linenos" data-linenos="14 "></span></a>            flag += raw_table[j]
<a id="__codelineno-65-15" name="__codelineno-65-15"></a><a href="#__codelineno-65-15"><span class="linenos" data-linenos="15 "></span></a>            break
<a id="__codelineno-65-16" name="__codelineno-65-16"></a><a href="#__codelineno-65-16"><span class="linenos" data-linenos="16 "></span></a>print( flag )
</code></pre></div>
<p>base64解码得到flag</p>
<p>flag:<code>flag{666}</code></p>
<h3 id="nctf2019childrsa">[NCTF2019]childRSA<a class="headerlink" href="#nctf2019childrsa" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-66-1" name="__codelineno-66-1"></a><a href="#__codelineno-66-1"><span class="linenos" data-linenos=" 1 "></span></a>from random import choice
<a id="__codelineno-66-2" name="__codelineno-66-2"></a><a href="#__codelineno-66-2"><span class="linenos" data-linenos=" 2 "></span></a>from Crypto.Util.number import isPrime, sieve_base as primes
<a id="__codelineno-66-3" name="__codelineno-66-3"></a><a href="#__codelineno-66-3"><span class="linenos" data-linenos=" 3 "></span></a>from flag import flag
<a id="__codelineno-66-4" name="__codelineno-66-4"></a><a href="#__codelineno-66-4"><span class="linenos" data-linenos=" 4 "></span></a>
<a id="__codelineno-66-5" name="__codelineno-66-5"></a><a href="#__codelineno-66-5"><span class="linenos" data-linenos=" 5 "></span></a>def getPrime(bits):
<a id="__codelineno-66-6" name="__codelineno-66-6"></a><a href="#__codelineno-66-6"><span class="linenos" data-linenos=" 6 "></span></a>    while True:
<a id="__codelineno-66-7" name="__codelineno-66-7"></a><a href="#__codelineno-66-7"><span class="linenos" data-linenos=" 7 "></span></a>        n = 2
<a id="__codelineno-66-8" name="__codelineno-66-8"></a><a href="#__codelineno-66-8"><span class="linenos" data-linenos=" 8 "></span></a>        while n.bit_length() &lt; bits:
<a id="__codelineno-66-9" name="__codelineno-66-9"></a><a href="#__codelineno-66-9"><span class="linenos" data-linenos=" 9 "></span></a>            n *= choice(primes)
<a id="__codelineno-66-10" name="__codelineno-66-10"></a><a href="#__codelineno-66-10"><span class="linenos" data-linenos="10 "></span></a>        if isPrime(n + 1):
<a id="__codelineno-66-11" name="__codelineno-66-11"></a><a href="#__codelineno-66-11"><span class="linenos" data-linenos="11 "></span></a>            return n + 1
<a id="__codelineno-66-12" name="__codelineno-66-12"></a><a href="#__codelineno-66-12"><span class="linenos" data-linenos="12 "></span></a>
<a id="__codelineno-66-13" name="__codelineno-66-13"></a><a href="#__codelineno-66-13"><span class="linenos" data-linenos="13 "></span></a>e = 0x10001
<a id="__codelineno-66-14" name="__codelineno-66-14"></a><a href="#__codelineno-66-14"><span class="linenos" data-linenos="14 "></span></a>m = int.from_bytes(flag.encode(), &#39;big&#39;)
<a id="__codelineno-66-15" name="__codelineno-66-15"></a><a href="#__codelineno-66-15"><span class="linenos" data-linenos="15 "></span></a>p, q = [getPrime(2048) for _ in range(2)]
<a id="__codelineno-66-16" name="__codelineno-66-16"></a><a href="#__codelineno-66-16"><span class="linenos" data-linenos="16 "></span></a>n = p * q
<a id="__codelineno-66-17" name="__codelineno-66-17"></a><a href="#__codelineno-66-17"><span class="linenos" data-linenos="17 "></span></a>c = pow(m, e, n)
<a id="__codelineno-66-18" name="__codelineno-66-18"></a><a href="#__codelineno-66-18"><span class="linenos" data-linenos="18 "></span></a>
<a id="__codelineno-66-19" name="__codelineno-66-19"></a><a href="#__codelineno-66-19"><span class="linenos" data-linenos="19 "></span></a>#n = 
<a id="__codelineno-66-20" name="__codelineno-66-20"></a><a href="#__codelineno-66-20"><span class="linenos" data-linenos="20 "></span></a>#c = 
</code></pre></div>
<p>自行编写脚本，求得 <span class="arithmatex">\(primes\)</span> 都是不超过 <span class="arithmatex">\(1e5\)</span> 的质数，<span class="arithmatex">\(choice()\)</span>为在列表中随机选择一个元素</p>
<p>观察 <span class="arithmatex">\(p\)</span> 和 <span class="arithmatex">\(q\)</span> 的生成方式，可以得到 <span class="arithmatex">\(p-1\)</span> 和 <span class="arithmatex">\(q-1\)</span> 都是 前 <span class="arithmatex">\(10000\)</span> 个质数里随机选择多个的乘积</p>
<p>设 $T = \prod primes $，故有 <span class="arithmatex">\(T\)</span> 是 <span class="arithmatex">\(p-1\)</span> 和 <span class="arithmatex">\(q-1\)</span> 的 整数倍，不妨设 <span class="arithmatex">\(T=k*(p-1)\)</span></p>
<p>则 <span class="arithmatex">\(2^T-1=2^{k*(p-1)}-1 \equiv 0 (modp )\)</span> ，故 <span class="arithmatex">\(2^T-1 \equiv 0 (modp )\)</span>，因为<span class="arithmatex">\(n \equiv 0 (modp )\)</span></p>
<p>通过费马小定理得到 <span class="arithmatex">\(2^T-1\)</span> 是 <span class="arithmatex">\(p\)</span> 的整数倍，根据 <span class="arithmatex">\(RSA\)</span>规则，<span class="arithmatex">\(n\)</span> 也是 <span class="arithmatex">\(p\)</span> 的整数倍，故得到 </p>
<p><span class="arithmatex">\(gcd(2^T-1,n)=p\)</span> </p>
<p>即求得 <span class="arithmatex">\(2^T\)</span> 可得 <span class="arithmatex">\(n\)</span> </p>
<p>进一步优化</p>
<p>因为 $2^T \% n = 2^T - k^{'}p*q $</p>
<p>两边同时%p，则 <span class="arithmatex">\(2^T \% n = 2 ^ T (modp)\)</span></p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-67-1" name="__codelineno-67-1"></a><a href="#__codelineno-67-1"><span class="linenos" data-linenos=" 1 "></span></a>import gmpy2
<a id="__codelineno-67-2" name="__codelineno-67-2"></a><a href="#__codelineno-67-2"><span class="linenos" data-linenos=" 2 "></span></a>import binascii
<a id="__codelineno-67-3" name="__codelineno-67-3"></a><a href="#__codelineno-67-3"><span class="linenos" data-linenos=" 3 "></span></a>from Crypto.Util.number import long_to_bytes
<a id="__codelineno-67-4" name="__codelineno-67-4"></a><a href="#__codelineno-67-4"><span class="linenos" data-linenos=" 4 "></span></a>from Crypto.Util.number import isPrime, sieve_base as primes
<a id="__codelineno-67-5" name="__codelineno-67-5"></a><a href="#__codelineno-67-5"><span class="linenos" data-linenos=" 5 "></span></a>
<a id="__codelineno-67-6" name="__codelineno-67-6"></a><a href="#__codelineno-67-6"><span class="linenos" data-linenos=" 6 "></span></a>e = 0x10001
<a id="__codelineno-67-7" name="__codelineno-67-7"></a><a href="#__codelineno-67-7"><span class="linenos" data-linenos=" 7 "></span></a>n = 
<a id="__codelineno-67-8" name="__codelineno-67-8"></a><a href="#__codelineno-67-8"><span class="linenos" data-linenos=" 8 "></span></a>c = 
<a id="__codelineno-67-9" name="__codelineno-67-9"></a><a href="#__codelineno-67-9"><span class="linenos" data-linenos=" 9 "></span></a>
<a id="__codelineno-67-10" name="__codelineno-67-10"></a><a href="#__codelineno-67-10"><span class="linenos" data-linenos="10 "></span></a>prod = 1
<a id="__codelineno-67-11" name="__codelineno-67-11"></a><a href="#__codelineno-67-11"><span class="linenos" data-linenos="11 "></span></a>for i in primes:
<a id="__codelineno-67-12" name="__codelineno-67-12"></a><a href="#__codelineno-67-12"><span class="linenos" data-linenos="12 "></span></a>    prod *= i
<a id="__codelineno-67-13" name="__codelineno-67-13"></a><a href="#__codelineno-67-13"><span class="linenos" data-linenos="13 "></span></a>p = gmpy2.gcd( pow(2,prd,n)-1 , n )
<a id="__codelineno-67-14" name="__codelineno-67-14"></a><a href="#__codelineno-67-14"><span class="linenos" data-linenos="14 "></span></a>q = n // p
<a id="__codelineno-67-15" name="__codelineno-67-15"></a><a href="#__codelineno-67-15"><span class="linenos" data-linenos="15 "></span></a>d = gmpy2.invert( e , (p-1)*(q-1) )
<a id="__codelineno-67-16" name="__codelineno-67-16"></a><a href="#__codelineno-67-16"><span class="linenos" data-linenos="16 "></span></a>print( long_to_bytes(pow(c,d,n))
</code></pre></div>
<p><code>flag{Th3r3_ar3_1ns3cure_RSA_m0duli_7hat_at_f1rst_gl4nce_appe4r_t0_be_s3cur3}</code></p>
<p>总结：这道题给了 <span class="arithmatex">\(p\)</span> 和 <span class="arithmatex">\(q\)</span> 的生成方式，可以借此发现 <span class="arithmatex">\(n\)</span> 和 $\prod $ 在 <span class="arithmatex">\(mod\)</span> <span class="arithmatex">\(p\)</span> 下的关系；通过数论运算得到 <span class="arithmatex">\(\prod\)</span> 的等价快速运算，进而求出 <span class="arithmatex">\(p\)</span>，得到 <code>flag</code></p>
<h3 id="hdctf2019bbbbbbrsa">[HDCTF2019]bbbbbbrsa<a class="headerlink" href="#hdctf2019bbbbbbrsa" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-68-1" name="__codelineno-68-1"></a><a href="#__codelineno-68-1"><span class="linenos" data-linenos=" 1 "></span></a>from base64 import b64encode as b32encode
<a id="__codelineno-68-2" name="__codelineno-68-2"></a><a href="#__codelineno-68-2"><span class="linenos" data-linenos=" 2 "></span></a>from gmpy2 import invert,gcd,iroot
<a id="__codelineno-68-3" name="__codelineno-68-3"></a><a href="#__codelineno-68-3"><span class="linenos" data-linenos=" 3 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-68-4" name="__codelineno-68-4"></a><a href="#__codelineno-68-4"><span class="linenos" data-linenos=" 4 "></span></a>from binascii import a2b_hex,b2a_hex
<a id="__codelineno-68-5" name="__codelineno-68-5"></a><a href="#__codelineno-68-5"><span class="linenos" data-linenos=" 5 "></span></a>import random
<a id="__codelineno-68-6" name="__codelineno-68-6"></a><a href="#__codelineno-68-6"><span class="linenos" data-linenos=" 6 "></span></a>nbit = 128
<a id="__codelineno-68-7" name="__codelineno-68-7"></a><a href="#__codelineno-68-7"><span class="linenos" data-linenos=" 7 "></span></a>p = getPrime(nbit)
<a id="__codelineno-68-8" name="__codelineno-68-8"></a><a href="#__codelineno-68-8"><span class="linenos" data-linenos=" 8 "></span></a>q = getPrime(nbit)
<a id="__codelineno-68-9" name="__codelineno-68-9"></a><a href="#__codelineno-68-9"><span class="linenos" data-linenos=" 9 "></span></a>n = p*q
<a id="__codelineno-68-10" name="__codelineno-68-10"></a><a href="#__codelineno-68-10"><span class="linenos" data-linenos="10 "></span></a>phi = (p-1)*(q-1)
<a id="__codelineno-68-11" name="__codelineno-68-11"></a><a href="#__codelineno-68-11"><span class="linenos" data-linenos="11 "></span></a>e = random.randint(50000,70000)
<a id="__codelineno-68-12" name="__codelineno-68-12"></a><a href="#__codelineno-68-12"><span class="linenos" data-linenos="12 "></span></a>while True:
<a id="__codelineno-68-13" name="__codelineno-68-13"></a><a href="#__codelineno-68-13"><span class="linenos" data-linenos="13 "></span></a>    if gcd(e,phi) == 1:
<a id="__codelineno-68-14" name="__codelineno-68-14"></a><a href="#__codelineno-68-14"><span class="linenos" data-linenos="14 "></span></a>        break;
<a id="__codelineno-68-15" name="__codelineno-68-15"></a><a href="#__codelineno-68-15"><span class="linenos" data-linenos="15 "></span></a>    else:
<a id="__codelineno-68-16" name="__codelineno-68-16"></a><a href="#__codelineno-68-16"><span class="linenos" data-linenos="16 "></span></a>        e -= 1;
<a id="__codelineno-68-17" name="__codelineno-68-17"></a><a href="#__codelineno-68-17"><span class="linenos" data-linenos="17 "></span></a>c = pow(int(b2a_hex(flag),16),e,n)
<a id="__codelineno-68-18" name="__codelineno-68-18"></a><a href="#__codelineno-68-18"><span class="linenos" data-linenos="18 "></span></a>print b32encode(str(c))[::-1]
<a id="__codelineno-68-19" name="__codelineno-68-19"></a><a href="#__codelineno-68-19"><span class="linenos" data-linenos="19 "></span></a>
<a id="__codelineno-68-20" name="__codelineno-68-20"></a><a href="#__codelineno-68-20"><span class="linenos" data-linenos="20 "></span></a>#p= 177077389675257695042507998165006460849
<a id="__codelineno-68-21" name="__codelineno-68-21"></a><a href="#__codelineno-68-21"><span class="linenos" data-linenos="21 "></span></a>#n= 37421829509887796274897162249367329400988647145613325367337968063341372726061
<a id="__codelineno-68-22" name="__codelineno-68-22"></a><a href="#__codelineno-68-22"><span class="linenos" data-linenos="22 "></span></a>#c= ==gMzYDNzIjMxUTNyIzNzIjMyYTM4MDM0gTMwEjNzgTM2UTN4cjNwIjN2QzM5ADMwIDNyMTO4UzM2cTM5kDN2MTOyUTO5YDM0czM3MjM
</code></pre></div>
<p>将 <span class="arithmatex">\(c\)</span> 进行字符串翻转，进行 <span class="arithmatex">\(base64\)</span> 解码，e数据范围很小，可以爆破</p>
<p>记得检查串里是否包含 <code>flag</code>，不然跑不完的</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-69-1" name="__codelineno-69-1"></a><a href="#__codelineno-69-1"><span class="linenos" data-linenos=" 1 "></span></a>import gmpy2
<a id="__codelineno-69-2" name="__codelineno-69-2"></a><a href="#__codelineno-69-2"><span class="linenos" data-linenos=" 2 "></span></a>from Crypto.Util.number import long_to_bytes
<a id="__codelineno-69-3" name="__codelineno-69-3"></a><a href="#__codelineno-69-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-69-4" name="__codelineno-69-4"></a><a href="#__codelineno-69-4"><span class="linenos" data-linenos=" 4 "></span></a>c = 2373740699529364991763589324200093466206785561836101840381622237225512234632
<a id="__codelineno-69-5" name="__codelineno-69-5"></a><a href="#__codelineno-69-5"><span class="linenos" data-linenos=" 5 "></span></a>p = 177077389675257695042507998165006460849
<a id="__codelineno-69-6" name="__codelineno-69-6"></a><a href="#__codelineno-69-6"><span class="linenos" data-linenos=" 6 "></span></a>n = 37421829509887796274897162249367329400988647145613325367337968063341372726061
<a id="__codelineno-69-7" name="__codelineno-69-7"></a><a href="#__codelineno-69-7"><span class="linenos" data-linenos=" 7 "></span></a>q = n // p
<a id="__codelineno-69-8" name="__codelineno-69-8"></a><a href="#__codelineno-69-8"><span class="linenos" data-linenos=" 8 "></span></a>phi = (p-1) * (q-1)
<a id="__codelineno-69-9" name="__codelineno-69-9"></a><a href="#__codelineno-69-9"><span class="linenos" data-linenos=" 9 "></span></a>e = 70000
<a id="__codelineno-69-10" name="__codelineno-69-10"></a><a href="#__codelineno-69-10"><span class="linenos" data-linenos="10 "></span></a>while 1:
<a id="__codelineno-69-11" name="__codelineno-69-11"></a><a href="#__codelineno-69-11"><span class="linenos" data-linenos="11 "></span></a>    if gmpy2.gcd(e,phi) == 1:
<a id="__codelineno-69-12" name="__codelineno-69-12"></a><a href="#__codelineno-69-12"><span class="linenos" data-linenos="12 "></span></a>        d = gmpy2.invert( e , phi )
<a id="__codelineno-69-13" name="__codelineno-69-13"></a><a href="#__codelineno-69-13"><span class="linenos" data-linenos="13 "></span></a>        flag = pow( c , d , n )
<a id="__codelineno-69-14" name="__codelineno-69-14"></a><a href="#__codelineno-69-14"><span class="linenos" data-linenos="14 "></span></a>        if &#39;flag&#39; in str(long_to_bytes(flag)):
<a id="__codelineno-69-15" name="__codelineno-69-15"></a><a href="#__codelineno-69-15"><span class="linenos" data-linenos="15 "></span></a>            print(long_to_bytes(flag))
<a id="__codelineno-69-16" name="__codelineno-69-16"></a><a href="#__codelineno-69-16"><span class="linenos" data-linenos="16 "></span></a>            break
<a id="__codelineno-69-17" name="__codelineno-69-17"></a><a href="#__codelineno-69-17"><span class="linenos" data-linenos="17 "></span></a>    e = e - 1
</code></pre></div>
<p><code>flag{rs4_1s_s1mpl3!#}</code></p>
<h3 id="rsa4">RSA4<a class="headerlink" href="#rsa4" title="Permanent link">&para;</a></h3>
<p>给了三组n和c，中国剩余定理即可求解</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-70-1" name="__codelineno-70-1"></a><a href="#__codelineno-70-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import long_to_bytes
<a id="__codelineno-70-2" name="__codelineno-70-2"></a><a href="#__codelineno-70-2"><span class="linenos" data-linenos=" 2 "></span></a>import gmpy2
<a id="__codelineno-70-3" name="__codelineno-70-3"></a><a href="#__codelineno-70-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-70-4" name="__codelineno-70-4"></a><a href="#__codelineno-70-4"><span class="linenos" data-linenos=" 4 "></span></a>def crrt( c , p ):
<a id="__codelineno-70-5" name="__codelineno-70-5"></a><a href="#__codelineno-70-5"><span class="linenos" data-linenos=" 5 "></span></a>    M = 1
<a id="__codelineno-70-6" name="__codelineno-70-6"></a><a href="#__codelineno-70-6"><span class="linenos" data-linenos=" 6 "></span></a>    for i in p:
<a id="__codelineno-70-7" name="__codelineno-70-7"></a><a href="#__codelineno-70-7"><span class="linenos" data-linenos=" 7 "></span></a>        M = M * i
<a id="__codelineno-70-8" name="__codelineno-70-8"></a><a href="#__codelineno-70-8"><span class="linenos" data-linenos=" 8 "></span></a>    m = []
<a id="__codelineno-70-9" name="__codelineno-70-9"></a><a href="#__codelineno-70-9"><span class="linenos" data-linenos=" 9 "></span></a>    for i in range(len(p)):
<a id="__codelineno-70-10" name="__codelineno-70-10"></a><a href="#__codelineno-70-10"><span class="linenos" data-linenos="10 "></span></a>        m.append(M // p[i])
<a id="__codelineno-70-11" name="__codelineno-70-11"></a><a href="#__codelineno-70-11"><span class="linenos" data-linenos="11 "></span></a>    x = 0
<a id="__codelineno-70-12" name="__codelineno-70-12"></a><a href="#__codelineno-70-12"><span class="linenos" data-linenos="12 "></span></a>    for i in range(len(c)):
<a id="__codelineno-70-13" name="__codelineno-70-13"></a><a href="#__codelineno-70-13"><span class="linenos" data-linenos="13 "></span></a>        x = x + c[i]*m[i]*gmpy2.invert(m[i],p[i])
<a id="__codelineno-70-14" name="__codelineno-70-14"></a><a href="#__codelineno-70-14"><span class="linenos" data-linenos="14 "></span></a>    return x % M
<a id="__codelineno-70-15" name="__codelineno-70-15"></a><a href="#__codelineno-70-15"><span class="linenos" data-linenos="15 "></span></a>
<a id="__codelineno-70-16" name="__codelineno-70-16"></a><a href="#__codelineno-70-16"><span class="linenos" data-linenos="16 "></span></a>n1 = &quot;&quot;
<a id="__codelineno-70-17" name="__codelineno-70-17"></a><a href="#__codelineno-70-17"><span class="linenos" data-linenos="17 "></span></a>c1 = &quot;&quot;
<a id="__codelineno-70-18" name="__codelineno-70-18"></a><a href="#__codelineno-70-18"><span class="linenos" data-linenos="18 "></span></a>n2 = &quot;&quot;
<a id="__codelineno-70-19" name="__codelineno-70-19"></a><a href="#__codelineno-70-19"><span class="linenos" data-linenos="19 "></span></a>c2 = &quot;&quot;
<a id="__codelineno-70-20" name="__codelineno-70-20"></a><a href="#__codelineno-70-20"><span class="linenos" data-linenos="20 "></span></a>n3 = &quot;&quot;
<a id="__codelineno-70-21" name="__codelineno-70-21"></a><a href="#__codelineno-70-21"><span class="linenos" data-linenos="21 "></span></a>c3 = &quot;&quot;
<a id="__codelineno-70-22" name="__codelineno-70-22"></a><a href="#__codelineno-70-22"><span class="linenos" data-linenos="22 "></span></a>n = [int(n1,5),int(n2,5),int(n3,5)]
<a id="__codelineno-70-23" name="__codelineno-70-23"></a><a href="#__codelineno-70-23"><span class="linenos" data-linenos="23 "></span></a>c = [int(c1,5),int(c2,5),int(c3,5)]
<a id="__codelineno-70-24" name="__codelineno-70-24"></a><a href="#__codelineno-70-24"><span class="linenos" data-linenos="24 "></span></a>M = crrt( c , n )
<a id="__codelineno-70-25" name="__codelineno-70-25"></a><a href="#__codelineno-70-25"><span class="linenos" data-linenos="25 "></span></a>for e in range( 3 , 4 ):
<a id="__codelineno-70-26" name="__codelineno-70-26"></a><a href="#__codelineno-70-26"><span class="linenos" data-linenos="26 "></span></a>    m , f = gmpy2.iroot( M , e )
<a id="__codelineno-70-27" name="__codelineno-70-27"></a><a href="#__codelineno-70-27"><span class="linenos" data-linenos="27 "></span></a>    print( long_to_bytes( m ) )
</code></pre></div>
<p><code>flag{D4mn_y0u_h4s74d_wh47_4_b100dy_b4s74rd!}</code></p>
<h3 id="rsa4_1">RSA4<a class="headerlink" href="#rsa4_1" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-71-1" name="__codelineno-71-1"></a><a href="#__codelineno-71-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import long_to_bytes
<a id="__codelineno-71-2" name="__codelineno-71-2"></a><a href="#__codelineno-71-2"><span class="linenos" data-linenos=" 2 "></span></a>import gmpy2
<a id="__codelineno-71-3" name="__codelineno-71-3"></a><a href="#__codelineno-71-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-71-4" name="__codelineno-71-4"></a><a href="#__codelineno-71-4"><span class="linenos" data-linenos=" 4 "></span></a>def crtt( c , p ):
<a id="__codelineno-71-5" name="__codelineno-71-5"></a><a href="#__codelineno-71-5"><span class="linenos" data-linenos=" 5 "></span></a>    M = 1
<a id="__codelineno-71-6" name="__codelineno-71-6"></a><a href="#__codelineno-71-6"><span class="linenos" data-linenos=" 6 "></span></a>    for i in p:
<a id="__codelineno-71-7" name="__codelineno-71-7"></a><a href="#__codelineno-71-7"><span class="linenos" data-linenos=" 7 "></span></a>        M = M * i
<a id="__codelineno-71-8" name="__codelineno-71-8"></a><a href="#__codelineno-71-8"><span class="linenos" data-linenos=" 8 "></span></a>    m = []
<a id="__codelineno-71-9" name="__codelineno-71-9"></a><a href="#__codelineno-71-9"><span class="linenos" data-linenos=" 9 "></span></a>    for i in range(len(p)):
<a id="__codelineno-71-10" name="__codelineno-71-10"></a><a href="#__codelineno-71-10"><span class="linenos" data-linenos="10 "></span></a>        m.append(M // p[i])
<a id="__codelineno-71-11" name="__codelineno-71-11"></a><a href="#__codelineno-71-11"><span class="linenos" data-linenos="11 "></span></a>    x = 0
<a id="__codelineno-71-12" name="__codelineno-71-12"></a><a href="#__codelineno-71-12"><span class="linenos" data-linenos="12 "></span></a>    for i in range(len(c)):
<a id="__codelineno-71-13" name="__codelineno-71-13"></a><a href="#__codelineno-71-13"><span class="linenos" data-linenos="13 "></span></a>        x = x + c[i]*m[i]*gmpy2.invert(m[i],p[i])
<a id="__codelineno-71-14" name="__codelineno-71-14"></a><a href="#__codelineno-71-14"><span class="linenos" data-linenos="14 "></span></a>    return x % M
<a id="__codelineno-71-15" name="__codelineno-71-15"></a><a href="#__codelineno-71-15"><span class="linenos" data-linenos="15 "></span></a>
<a id="__codelineno-71-16" name="__codelineno-71-16"></a><a href="#__codelineno-71-16"><span class="linenos" data-linenos="16 "></span></a>n1 =  ; c1 = 
<a id="__codelineno-71-17" name="__codelineno-71-17"></a><a href="#__codelineno-71-17"><span class="linenos" data-linenos="17 "></span></a>n2 =  ; c2 = 
<a id="__codelineno-71-18" name="__codelineno-71-18"></a><a href="#__codelineno-71-18"><span class="linenos" data-linenos="18 "></span></a>n3 =  ; c3 = 
<a id="__codelineno-71-19" name="__codelineno-71-19"></a><a href="#__codelineno-71-19"><span class="linenos" data-linenos="19 "></span></a>e = 3
<a id="__codelineno-71-20" name="__codelineno-71-20"></a><a href="#__codelineno-71-20"><span class="linenos" data-linenos="20 "></span></a>
<a id="__codelineno-71-21" name="__codelineno-71-21"></a><a href="#__codelineno-71-21"><span class="linenos" data-linenos="21 "></span></a>n = [n1,n2,n3]
<a id="__codelineno-71-22" name="__codelineno-71-22"></a><a href="#__codelineno-71-22"><span class="linenos" data-linenos="22 "></span></a>c = [c1*2%n1,c2*2%n2,c3*2%n3]
<a id="__codelineno-71-23" name="__codelineno-71-23"></a><a href="#__codelineno-71-23"><span class="linenos" data-linenos="23 "></span></a>M = crtt( c , n )*gmpy2.invert(2,n1*n2*n3)%(n1*n2*n3)
<a id="__codelineno-71-24" name="__codelineno-71-24"></a><a href="#__codelineno-71-24"><span class="linenos" data-linenos="24 "></span></a>m , f = gmpy2.iroot( M , e )
<a id="__codelineno-71-25" name="__codelineno-71-25"></a><a href="#__codelineno-71-25"><span class="linenos" data-linenos="25 "></span></a>result = m
<a id="__codelineno-71-26" name="__codelineno-71-26"></a><a href="#__codelineno-71-26"><span class="linenos" data-linenos="26 "></span></a>print( result )
<a id="__codelineno-71-27" name="__codelineno-71-27"></a><a href="#__codelineno-71-27"><span class="linenos" data-linenos="27 "></span></a>print( long_to_bytes(result) )
</code></pre></div>
<p>flag:<code>flag{D4mn_y0u_h4s74d_wh47_4_b100dy_b4s74rd!}</code></p>
<h3 id="bjdctf2020rsa">[BJDCTF2020]RSA<a class="headerlink" href="#bjdctf2020rsa" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-72-1" name="__codelineno-72-1"></a><a href="#__codelineno-72-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import long_to_bytes,bytes_to_long
<a id="__codelineno-72-2" name="__codelineno-72-2"></a><a href="#__codelineno-72-2"><span class="linenos" data-linenos=" 2 "></span></a>import gmpy2
<a id="__codelineno-72-3" name="__codelineno-72-3"></a><a href="#__codelineno-72-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-72-4" name="__codelineno-72-4"></a><a href="#__codelineno-72-4"><span class="linenos" data-linenos=" 4 "></span></a>def gcd( a , b ):
<a id="__codelineno-72-5" name="__codelineno-72-5"></a><a href="#__codelineno-72-5"><span class="linenos" data-linenos=" 5 "></span></a>    if a &lt; b:
<a id="__codelineno-72-6" name="__codelineno-72-6"></a><a href="#__codelineno-72-6"><span class="linenos" data-linenos=" 6 "></span></a>        a , b = b , a
<a id="__codelineno-72-7" name="__codelineno-72-7"></a><a href="#__codelineno-72-7"><span class="linenos" data-linenos=" 7 "></span></a>    if b == 0:
<a id="__codelineno-72-8" name="__codelineno-72-8"></a><a href="#__codelineno-72-8"><span class="linenos" data-linenos=" 8 "></span></a>        return a
<a id="__codelineno-72-9" name="__codelineno-72-9"></a><a href="#__codelineno-72-9"><span class="linenos" data-linenos=" 9 "></span></a>    return gcd( b , a % b )
<a id="__codelineno-72-10" name="__codelineno-72-10"></a><a href="#__codelineno-72-10"><span class="linenos" data-linenos="10 "></span></a>
<a id="__codelineno-72-11" name="__codelineno-72-11"></a><a href="#__codelineno-72-11"><span class="linenos" data-linenos="11 "></span></a>c1 =  ; n1 = 
<a id="__codelineno-72-12" name="__codelineno-72-12"></a><a href="#__codelineno-72-12"><span class="linenos" data-linenos="12 "></span></a>t  = 
<a id="__codelineno-72-13" name="__codelineno-72-13"></a><a href="#__codelineno-72-13"><span class="linenos" data-linenos="13 "></span></a>c2 =  ; n2 = 
<a id="__codelineno-72-14" name="__codelineno-72-14"></a><a href="#__codelineno-72-14"><span class="linenos" data-linenos="14 "></span></a>m2 = bytes_to_long((&quot;BJD&quot;*32).encode())
<a id="__codelineno-72-15" name="__codelineno-72-15"></a><a href="#__codelineno-72-15"><span class="linenos" data-linenos="15 "></span></a>
<a id="__codelineno-72-16" name="__codelineno-72-16"></a><a href="#__codelineno-72-16"><span class="linenos" data-linenos="16 "></span></a>p = gcd( n1 , n2 )
<a id="__codelineno-72-17" name="__codelineno-72-17"></a><a href="#__codelineno-72-17"><span class="linenos" data-linenos="17 "></span></a>q1 = n1 // p ; q2 = n2 // p
<a id="__codelineno-72-18" name="__codelineno-72-18"></a><a href="#__codelineno-72-18"><span class="linenos" data-linenos="18 "></span></a>phi = ( p - 1 ) * ( q1 - 1 )
<a id="__codelineno-72-19" name="__codelineno-72-19"></a><a href="#__codelineno-72-19"><span class="linenos" data-linenos="19 "></span></a>
<a id="__codelineno-72-20" name="__codelineno-72-20"></a><a href="#__codelineno-72-20"><span class="linenos" data-linenos="20 "></span></a>e = 0
<a id="__codelineno-72-21" name="__codelineno-72-21"></a><a href="#__codelineno-72-21"><span class="linenos" data-linenos="21 "></span></a>for i in range( 100000 ):
<a id="__codelineno-72-22" name="__codelineno-72-22"></a><a href="#__codelineno-72-22"><span class="linenos" data-linenos="22 "></span></a>    if gcd( i , phi ) == 1:
<a id="__codelineno-72-23" name="__codelineno-72-23"></a><a href="#__codelineno-72-23"><span class="linenos" data-linenos="23 "></span></a>        c1_ = pow( 294 , i , n1 )
<a id="__codelineno-72-24" name="__codelineno-72-24"></a><a href="#__codelineno-72-24"><span class="linenos" data-linenos="24 "></span></a>        if t == c1_:
<a id="__codelineno-72-25" name="__codelineno-72-25"></a><a href="#__codelineno-72-25"><span class="linenos" data-linenos="25 "></span></a>            e = i ; break
<a id="__codelineno-72-26" name="__codelineno-72-26"></a><a href="#__codelineno-72-26"><span class="linenos" data-linenos="26 "></span></a>
<a id="__codelineno-72-27" name="__codelineno-72-27"></a><a href="#__codelineno-72-27"><span class="linenos" data-linenos="27 "></span></a>d = gmpy2.invert( e , phi )
<a id="__codelineno-72-28" name="__codelineno-72-28"></a><a href="#__codelineno-72-28"><span class="linenos" data-linenos="28 "></span></a>print( long_to_bytes( pow( c1 , d , n1 ) ) )
</code></pre></div>
<p>flag:<code>flag{p_is_common_divisor}</code></p>
<h3 id="hdctf2019basic-rsa">[HDCTF2019]basic rsa<a class="headerlink" href="#hdctf2019basic-rsa" title="Permanent link">&para;</a></h3>
<p><img alt="" src="asserts\image-20231113083852953.png" /></p>
<p>flag{B4by_Rs4}</p>
<h3 id="buuctfrsa5">[BUUCTF]RSA5<a class="headerlink" href="#buuctfrsa5" title="Permanent link">&para;</a></h3>
<p>给定很多组c和n。因为n存在不互质的数对，所以这道题就是<code>模不互质攻击</code></p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-73-1" name="__codelineno-73-1"></a><a href="#__codelineno-73-1"><span class="linenos" data-linenos="1 "></span></a>for i in range(len(n)):
<a id="__codelineno-73-2" name="__codelineno-73-2"></a><a href="#__codelineno-73-2"><span class="linenos" data-linenos="2 "></span></a>    for j in range(i+1,len(n)):
<a id="__codelineno-73-3" name="__codelineno-73-3"></a><a href="#__codelineno-73-3"><span class="linenos" data-linenos="3 "></span></a>        if(gmpy2.gcd(n[i],n[j])!=1):
<a id="__codelineno-73-4" name="__codelineno-73-4"></a><a href="#__codelineno-73-4"><span class="linenos" data-linenos="4 "></span></a>            print(i,j)
</code></pre></div>
<p>得到n5和n18存在最大公约数</p>
<p>所以，选择n5和n18的n进行gcd操作，即可得到p</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-74-1" name="__codelineno-74-1"></a><a href="#__codelineno-74-1"><span class="linenos" data-linenos=" 1 "></span></a>import gmpy2
<a id="__codelineno-74-2" name="__codelineno-74-2"></a><a href="#__codelineno-74-2"><span class="linenos" data-linenos=" 2 "></span></a>from Crypto.Util.number import long_to_bytes
<a id="__codelineno-74-3" name="__codelineno-74-3"></a><a href="#__codelineno-74-3"><span class="linenos" data-linenos=" 3 "></span></a>e = 65537
<a id="__codelineno-74-4" name="__codelineno-74-4"></a><a href="#__codelineno-74-4"><span class="linenos" data-linenos=" 4 "></span></a>n5 = 
<a id="__codelineno-74-5" name="__codelineno-74-5"></a><a href="#__codelineno-74-5"><span class="linenos" data-linenos=" 5 "></span></a>c5 = 
<a id="__codelineno-74-6" name="__codelineno-74-6"></a><a href="#__codelineno-74-6"><span class="linenos" data-linenos=" 6 "></span></a>n18 = 
<a id="__codelineno-74-7" name="__codelineno-74-7"></a><a href="#__codelineno-74-7"><span class="linenos" data-linenos=" 7 "></span></a>c18 = 
<a id="__codelineno-74-8" name="__codelineno-74-8"></a><a href="#__codelineno-74-8"><span class="linenos" data-linenos=" 8 "></span></a>
<a id="__codelineno-74-9" name="__codelineno-74-9"></a><a href="#__codelineno-74-9"><span class="linenos" data-linenos=" 9 "></span></a>p = gmpy2.gcd( n5 , n18 )
<a id="__codelineno-74-10" name="__codelineno-74-10"></a><a href="#__codelineno-74-10"><span class="linenos" data-linenos="10 "></span></a>q = n5 // p
<a id="__codelineno-74-11" name="__codelineno-74-11"></a><a href="#__codelineno-74-11"><span class="linenos" data-linenos="11 "></span></a>
<a id="__codelineno-74-12" name="__codelineno-74-12"></a><a href="#__codelineno-74-12"><span class="linenos" data-linenos="12 "></span></a>m = pow( c5 , gmpy2.invert(e,(p-1)*(q-1)) , n5 )
<a id="__codelineno-74-13" name="__codelineno-74-13"></a><a href="#__codelineno-74-13"><span class="linenos" data-linenos="13 "></span></a>print( long_to_bytes( m ) )
</code></pre></div>
<p>flag{abdcbe5fd94e23b3de429223ab9c2fdf}</p>
<h3 id="2020-you_raise_me_up">[网鼎杯 2020 青龙组]you_raise_me_up<a class="headerlink" href="#2020-you_raise_me_up" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-75-1" name="__codelineno-75-1"></a><a href="#__codelineno-75-1"><span class="linenos" data-linenos=" 1 "></span></a>#!/usr/bin/env python
<a id="__codelineno-75-2" name="__codelineno-75-2"></a><a href="#__codelineno-75-2"><span class="linenos" data-linenos=" 2 "></span></a># -*- coding: utf-8 -*-
<a id="__codelineno-75-3" name="__codelineno-75-3"></a><a href="#__codelineno-75-3"><span class="linenos" data-linenos=" 3 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-75-4" name="__codelineno-75-4"></a><a href="#__codelineno-75-4"><span class="linenos" data-linenos=" 4 "></span></a>import random
<a id="__codelineno-75-5" name="__codelineno-75-5"></a><a href="#__codelineno-75-5"><span class="linenos" data-linenos=" 5 "></span></a>
<a id="__codelineno-75-6" name="__codelineno-75-6"></a><a href="#__codelineno-75-6"><span class="linenos" data-linenos=" 6 "></span></a>n = 2 ** 512
<a id="__codelineno-75-7" name="__codelineno-75-7"></a><a href="#__codelineno-75-7"><span class="linenos" data-linenos=" 7 "></span></a>m = random.randint(2, n-1) | 1
<a id="__codelineno-75-8" name="__codelineno-75-8"></a><a href="#__codelineno-75-8"><span class="linenos" data-linenos=" 8 "></span></a>c = pow(m, bytes_to_long(flag), n)
<a id="__codelineno-75-9" name="__codelineno-75-9"></a><a href="#__codelineno-75-9"><span class="linenos" data-linenos=" 9 "></span></a>print &#39;m = &#39; + str(m)
<a id="__codelineno-75-10" name="__codelineno-75-10"></a><a href="#__codelineno-75-10"><span class="linenos" data-linenos="10 "></span></a>print &#39;c = &#39; + str(c)
<a id="__codelineno-75-11" name="__codelineno-75-11"></a><a href="#__codelineno-75-11"><span class="linenos" data-linenos="11 "></span></a>
<a id="__codelineno-75-12" name="__codelineno-75-12"></a><a href="#__codelineno-75-12"><span class="linenos" data-linenos="12 "></span></a># m = 391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075
<a id="__codelineno-75-13" name="__codelineno-75-13"></a><a href="#__codelineno-75-13"><span class="linenos" data-linenos="13 "></span></a># c = 6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499
</code></pre></div>
<hr />
<p>python用于解离散对数的快速方法</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-76-1" name="__codelineno-76-1"></a><a href="#__codelineno-76-1"><span class="linenos" data-linenos="1 "></span></a>from sympy.ntheory import *
<a id="__codelineno-76-2" name="__codelineno-76-2"></a><a href="#__codelineno-76-2"><span class="linenos" data-linenos="2 "></span></a>discrete_log(41,15,7)
</code></pre></div>
<p>即解即为 <span class="arithmatex">\(7^x \equiv 15 \ mod \ 41\)</span></p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-77-1" name="__codelineno-77-1"></a><a href="#__codelineno-77-1"><span class="linenos" data-linenos="1 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-77-2" name="__codelineno-77-2"></a><a href="#__codelineno-77-2"><span class="linenos" data-linenos="2 "></span></a>from sympy import *
<a id="__codelineno-77-3" name="__codelineno-77-3"></a><a href="#__codelineno-77-3"><span class="linenos" data-linenos="3 "></span></a>
<a id="__codelineno-77-4" name="__codelineno-77-4"></a><a href="#__codelineno-77-4"><span class="linenos" data-linenos="4 "></span></a>m = 391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075
<a id="__codelineno-77-5" name="__codelineno-77-5"></a><a href="#__codelineno-77-5"><span class="linenos" data-linenos="5 "></span></a>c = 6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499
<a id="__codelineno-77-6" name="__codelineno-77-6"></a><a href="#__codelineno-77-6"><span class="linenos" data-linenos="6 "></span></a>n = 2 ** 512
<a id="__codelineno-77-7" name="__codelineno-77-7"></a><a href="#__codelineno-77-7"><span class="linenos" data-linenos="7 "></span></a>
<a id="__codelineno-77-8" name="__codelineno-77-8"></a><a href="#__codelineno-77-8"><span class="linenos" data-linenos="8 "></span></a>flag = discrete_log( 2**512 , c , m )
<a id="__codelineno-77-9" name="__codelineno-77-9"></a><a href="#__codelineno-77-9"><span class="linenos" data-linenos="9 "></span></a>print( long_to_bytes(flag) )
</code></pre></div>
<p>flag:<code>flag{5f95ca93-1594-762d-ed0b-a9139692cb4a}</code></p>
<h3 id="wustctf2020">[WUSTCTF2020]大数计算<a class="headerlink" href="#wustctf2020" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-78-1" name="__codelineno-78-1"></a><a href="#__codelineno-78-1"><span class="linenos" data-linenos="1 "></span></a>flag等于 wctf2020{Part1-Part2-Part3-Part4} 每一Part都为数的十六进制形式（不需要0x)，并用 &#39;-&#39; 连接
<a id="__codelineno-78-2" name="__codelineno-78-2"></a><a href="#__codelineno-78-2"><span class="linenos" data-linenos="2 "></span></a>Part1 = 2020*2019*2018* ...*3*2*1 的前8位
<a id="__codelineno-78-3" name="__codelineno-78-3"></a><a href="#__codelineno-78-3"><span class="linenos" data-linenos="3 "></span></a>Part2 = 520^1314 + 2333^666 的前8位
<a id="__codelineno-78-4" name="__codelineno-78-4"></a><a href="#__codelineno-78-4"><span class="linenos" data-linenos="4 "></span></a>Part3 = 宇宙终极问题的答案 x,y,z绝对值和的前8位
<a id="__codelineno-78-5" name="__codelineno-78-5"></a><a href="#__codelineno-78-5"><span class="linenos" data-linenos="5 "></span></a>Part4 = 见图片附件，计算结果乘上1314
</code></pre></div>
<p><img src="asserts\image-20240127120401338.png" alt="image-20240127120401338" style="zoom:33%;" /></p>
<hr />
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-79-1" name="__codelineno-79-1"></a><a href="#__codelineno-79-1"><span class="linenos" data-linenos="1 "></span></a>from decimal import *
<a id="__codelineno-79-2" name="__codelineno-79-2"></a><a href="#__codelineno-79-2"><span class="linenos" data-linenos="2 "></span></a>
<a id="__codelineno-79-3" name="__codelineno-79-3"></a><a href="#__codelineno-79-3"><span class="linenos" data-linenos="3 "></span></a>ans = Decimal(1)
<a id="__codelineno-79-4" name="__codelineno-79-4"></a><a href="#__codelineno-79-4"><span class="linenos" data-linenos="4 "></span></a>for i in range( 1 , 2021 ):
<a id="__codelineno-79-5" name="__codelineno-79-5"></a><a href="#__codelineno-79-5"><span class="linenos" data-linenos="5 "></span></a>    ans = ans * Decimal(i)
<a id="__codelineno-79-6" name="__codelineno-79-6"></a><a href="#__codelineno-79-6"><span class="linenos" data-linenos="6 "></span></a>print( ans )
</code></pre></div>
<p>part1:<code>24d231f</code></p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-80-1" name="__codelineno-80-1"></a><a href="#__codelineno-80-1"><span class="linenos" data-linenos="1 "></span></a>from decimal import *
<a id="__codelineno-80-2" name="__codelineno-80-2"></a><a href="#__codelineno-80-2"><span class="linenos" data-linenos="2 "></span></a>
<a id="__codelineno-80-3" name="__codelineno-80-3"></a><a href="#__codelineno-80-3"><span class="linenos" data-linenos="3 "></span></a>ans1 = Decimal(1) ; ans2 = Decimal(1)
<a id="__codelineno-80-4" name="__codelineno-80-4"></a><a href="#__codelineno-80-4"><span class="linenos" data-linenos="4 "></span></a>for i in range( 1 , 1314+1 ):
<a id="__codelineno-80-5" name="__codelineno-80-5"></a><a href="#__codelineno-80-5"><span class="linenos" data-linenos="5 "></span></a>    ans1 = ans1 * Decimal(520)
<a id="__codelineno-80-6" name="__codelineno-80-6"></a><a href="#__codelineno-80-6"><span class="linenos" data-linenos="6 "></span></a>for i in range( 1 , 666+1 ):
<a id="__codelineno-80-7" name="__codelineno-80-7"></a><a href="#__codelineno-80-7"><span class="linenos" data-linenos="7 "></span></a>    ans2 = ans2 * Decimal(2333)
<a id="__codelineno-80-8" name="__codelineno-80-8"></a><a href="#__codelineno-80-8"><span class="linenos" data-linenos="8 "></span></a>print( str(ans1 + ans2)[0]+str(ans1 + ans2)[2:9] )
</code></pre></div>
<p>part2:<code>403cfd3</code></p>
<p><img src="asserts\image-20240127115930751.png" alt="image-20240127115930751" style="zoom:50%;" /></p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-81-1" name="__codelineno-81-1"></a><a href="#__codelineno-81-1"><span class="linenos" data-linenos="1 "></span></a>print( 80538738812075974+80435758145817515+12602123297335631 )
</code></pre></div>
<p>part3:<code>108db5e</code></p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-82-1" name="__codelineno-82-1"></a><a href="#__codelineno-82-1"><span class="linenos" data-linenos="1 "></span></a>def F( x ):
<a id="__codelineno-82-2" name="__codelineno-82-2"></a><a href="#__codelineno-82-2"><span class="linenos" data-linenos="2 "></span></a>    return x*x
<a id="__codelineno-82-3" name="__codelineno-82-3"></a><a href="#__codelineno-82-3"><span class="linenos" data-linenos="3 "></span></a>print( (F(22)-F(0)+36)*1314 )
</code></pre></div>
<p>part4:<code>a6d10</code></p>
<p>flag:<code>flag{24d231f-403cfd3-108db5e-a6d10}</code></p>
<h3 id="npuctf2020ezrsa">[NPUCTF2020]EzRSA<a class="headerlink" href="#npuctf2020ezrsa" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-83-1" name="__codelineno-83-1"></a><a href="#__codelineno-83-1"><span class="linenos" data-linenos=" 1 "></span></a>from gmpy2 import lcm , powmod , invert , gcd , mpz
<a id="__codelineno-83-2" name="__codelineno-83-2"></a><a href="#__codelineno-83-2"><span class="linenos" data-linenos=" 2 "></span></a>from Crypto.Util.number import getPrime
<a id="__codelineno-83-3" name="__codelineno-83-3"></a><a href="#__codelineno-83-3"><span class="linenos" data-linenos=" 3 "></span></a>from sympy import nextprime
<a id="__codelineno-83-4" name="__codelineno-83-4"></a><a href="#__codelineno-83-4"><span class="linenos" data-linenos=" 4 "></span></a>from random import randint
<a id="__codelineno-83-5" name="__codelineno-83-5"></a><a href="#__codelineno-83-5"><span class="linenos" data-linenos=" 5 "></span></a>p = getPrime(1024)
<a id="__codelineno-83-6" name="__codelineno-83-6"></a><a href="#__codelineno-83-6"><span class="linenos" data-linenos=" 6 "></span></a>q = getPrime(1024)
<a id="__codelineno-83-7" name="__codelineno-83-7"></a><a href="#__codelineno-83-7"><span class="linenos" data-linenos=" 7 "></span></a>n = p * q
<a id="__codelineno-83-8" name="__codelineno-83-8"></a><a href="#__codelineno-83-8"><span class="linenos" data-linenos=" 8 "></span></a>gift = lcm(p - 1 , q - 1)
<a id="__codelineno-83-9" name="__codelineno-83-9"></a><a href="#__codelineno-83-9"><span class="linenos" data-linenos=" 9 "></span></a>e = 54722
<a id="__codelineno-83-10" name="__codelineno-83-10"></a><a href="#__codelineno-83-10"><span class="linenos" data-linenos="10 "></span></a>flag = b&#39;NPUCTF{******************}&#39;
<a id="__codelineno-83-11" name="__codelineno-83-11"></a><a href="#__codelineno-83-11"><span class="linenos" data-linenos="11 "></span></a>m = int.from_bytes(flag , &#39;big&#39;)
<a id="__codelineno-83-12" name="__codelineno-83-12"></a><a href="#__codelineno-83-12"><span class="linenos" data-linenos="12 "></span></a>c = powmod(m , e , n)
<a id="__codelineno-83-13" name="__codelineno-83-13"></a><a href="#__codelineno-83-13"><span class="linenos" data-linenos="13 "></span></a>print(&#39;n: &#39; , n)
<a id="__codelineno-83-14" name="__codelineno-83-14"></a><a href="#__codelineno-83-14"><span class="linenos" data-linenos="14 "></span></a>print(&#39;gift: &#39; , gift)
<a id="__codelineno-83-15" name="__codelineno-83-15"></a><a href="#__codelineno-83-15"><span class="linenos" data-linenos="15 "></span></a>print(&#39;c: &#39; , c)
<a id="__codelineno-83-16" name="__codelineno-83-16"></a><a href="#__codelineno-83-16"><span class="linenos" data-linenos="16 "></span></a>
<a id="__codelineno-83-17" name="__codelineno-83-17"></a><a href="#__codelineno-83-17"><span class="linenos" data-linenos="17 "></span></a>#n:  17083941230213489700426636484487738282426471494607098847295335339638177583685457921198569105417734668692072727759139358207667248703952436680183153327606147421932365889983347282046439156176685765143620637107347870401946946501620531665573668068349080410807996582297505889946205052879002028936125315312256470583622913646319779125559691270916064588684997382451412747432722966919513413709987353038375477178385125453567111965259721484997156799355617642131569095810304077131053588483057244340742751804935494087687363416921314041547093118565767609667033859583125275322077617576783247853718516166743858265291135353895239981121
<a id="__codelineno-83-18" name="__codelineno-83-18"></a><a href="#__codelineno-83-18"><span class="linenos" data-linenos="18 "></span></a>#gift:  2135492653776686212553329560560967285303308936825887355911916917454772197960682240149821138177216833586509090969892419775958406087994054585022894165950768427741545736247918410255804894522085720642952579638418483800243368312702566458196708508543635051350999572787188236243275631609875253617015664414032058822919469443284453403064076232765024248435543326597418851751586308514540124571309152787559712950209357825576896132278045112177910266019741013995106579484868768251084453338417115483515132869594712162052362083414163954681306259137057581036657441897428432575924018950961141822554251369262248368899977337886190114104
<a id="__codelineno-83-19" name="__codelineno-83-19"></a><a href="#__codelineno-83-19"><span class="linenos" data-linenos="19 "></span></a>#c:  3738960639194737957667684143565005503596276451617922474669745529299929395507971435311181578387223323429323286927370576955078618335757508161263585164126047545413028829873269342924092339298957635079736446851837414357757312525158356579607212496060244403765822636515347192211817658170822313646743520831977673861869637519843133863288550058359429455052676323196728280408508614527953057214779165450356577820378810467527006377296194102671360302059901897977339728292345132827184227155061326328585640019916328847372295754472832318258636054663091475801235050657401857262960415898483713074139212596685365780269667500271108538319
</code></pre></div>
<hr />
<p><span class="arithmatex">\(e\)</span> 不是质数，因为 $m^e  mod  n = c $ ，所以$m^{2*\frac{e}{2}}  mod  n = c $</p>
<p>使用factor分解即可得到p和q</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-84-1" name="__codelineno-84-1"></a><a href="#__codelineno-84-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-84-2" name="__codelineno-84-2"></a><a href="#__codelineno-84-2"><span class="linenos" data-linenos=" 2 "></span></a>from gmpy2 import *
<a id="__codelineno-84-3" name="__codelineno-84-3"></a><a href="#__codelineno-84-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-84-4" name="__codelineno-84-4"></a><a href="#__codelineno-84-4"><span class="linenos" data-linenos=" 4 "></span></a>n = 17083941230213489700426636484487738282426471494607098847295335339638177583685457921198569105417734668692072727759139358207667248703952436680183153327606147421932365889983347282046439156176685765143620637107347870401946946501620531665573668068349080410807996582297505889946205052879002028936125315312256470583622913646319779125559691270916064588684997382451412747432722966919513413709987353038375477178385125453567111965259721484997156799355617642131569095810304077131053588483057244340742751804935494087687363416921314041547093118565767609667033859583125275322077617576783247853718516166743858265291135353895239981121
<a id="__codelineno-84-5" name="__codelineno-84-5"></a><a href="#__codelineno-84-5"><span class="linenos" data-linenos=" 5 "></span></a>p = 161136651053130509602530659420755324119806487925813087617466818245407407797561810253722204813002837916779909309520498985459703212021249251124954613236122142746302911323565396331355397916764254680629384957057354297855676493062493901977415968666512459829211010720514167083018352796496733697235524845188512914793
<a id="__codelineno-84-6" name="__codelineno-84-6"></a><a href="#__codelineno-84-6"><span class="linenos" data-linenos=" 6 "></span></a>q = 106021448991021391444550749375115277080844281746248845802565680557785009341952320484175568763707424932172033597514861602114171459176440279045761846695231788376075050452154924141266290931413542110639081792550648106240966552406813059396358355737185354885474455248579946190266152416149137616855791805617206153497
<a id="__codelineno-84-7" name="__codelineno-84-7"></a><a href="#__codelineno-84-7"><span class="linenos" data-linenos=" 7 "></span></a>c = 3738960639194737957667684143565005503596276451617922474669745529299929395507971435311181578387223323429323286927370576955078618335757508161263585164126047545413028829873269342924092339298957635079736446851837414357757312525158356579607212496060244403765822636515347192211817658170822313646743520831977673861869637519843133863288550058359429455052676323196728280408508614527953057214779165450356577820378810467527006377296194102671360302059901897977339728292345132827184227155061326328585640019916328847372295754472832318258636054663091475801235050657401857262960415898483713074139212596685365780269667500271108538319
<a id="__codelineno-84-8" name="__codelineno-84-8"></a><a href="#__codelineno-84-8"><span class="linenos" data-linenos=" 8 "></span></a>e = 54722
<a id="__codelineno-84-9" name="__codelineno-84-9"></a><a href="#__codelineno-84-9"><span class="linenos" data-linenos=" 9 "></span></a>phi = (p-1)*(q-1)
<a id="__codelineno-84-10" name="__codelineno-84-10"></a><a href="#__codelineno-84-10"><span class="linenos" data-linenos="10 "></span></a>d = gmpy2.invert( e//2 , phi )
<a id="__codelineno-84-11" name="__codelineno-84-11"></a><a href="#__codelineno-84-11"><span class="linenos" data-linenos="11 "></span></a>flag = iroot(pow( c , d , n ),2)[0]
<a id="__codelineno-84-12" name="__codelineno-84-12"></a><a href="#__codelineno-84-12"><span class="linenos" data-linenos="12 "></span></a>print( long_to_bytes( flag ) )
</code></pre></div>
<p>可能是因为有开根操作，不需要p和q也可以解密，gift就是phi</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-85-1" name="__codelineno-85-1"></a><a href="#__codelineno-85-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-85-2" name="__codelineno-85-2"></a><a href="#__codelineno-85-2"><span class="linenos" data-linenos=" 2 "></span></a>from gmpy2 import *
<a id="__codelineno-85-3" name="__codelineno-85-3"></a><a href="#__codelineno-85-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-85-4" name="__codelineno-85-4"></a><a href="#__codelineno-85-4"><span class="linenos" data-linenos=" 4 "></span></a>n = 17083941230213489700426636484487738282426471494607098847295335339638177583685457921198569105417734668692072727759139358207667248703952436680183153327606147421932365889983347282046439156176685765143620637107347870401946946501620531665573668068349080410807996582297505889946205052879002028936125315312256470583622913646319779125559691270916064588684997382451412747432722966919513413709987353038375477178385125453567111965259721484997156799355617642131569095810304077131053588483057244340742751804935494087687363416921314041547093118565767609667033859583125275322077617576783247853718516166743858265291135353895239981121
<a id="__codelineno-85-5" name="__codelineno-85-5"></a><a href="#__codelineno-85-5"><span class="linenos" data-linenos=" 5 "></span></a>phi = 2135492653776686212553329560560967285303308936825887355911916917454772197960682240149821138177216833586509090969892419775958406087994054585022894165950768427741545736247918410255804894522085720642952579638418483800243368312702566458196708508543635051350999572787188236243275631609875253617015664414032058822919469443284453403064076232765024248435543326597418851751586308514540124571309152787559712950209357825576896132278045112177910266019741013995106579484868768251084453338417115483515132869594712162052362083414163954681306259137057581036657441897428432575924018950961141822554251369262248368899977337886190114104
<a id="__codelineno-85-6" name="__codelineno-85-6"></a><a href="#__codelineno-85-6"><span class="linenos" data-linenos=" 6 "></span></a>c = 3738960639194737957667684143565005503596276451617922474669745529299929395507971435311181578387223323429323286927370576955078618335757508161263585164126047545413028829873269342924092339298957635079736446851837414357757312525158356579607212496060244403765822636515347192211817658170822313646743520831977673861869637519843133863288550058359429455052676323196728280408508614527953057214779165450356577820378810467527006377296194102671360302059901897977339728292345132827184227155061326328585640019916328847372295754472832318258636054663091475801235050657401857262960415898483713074139212596685365780269667500271108538319
<a id="__codelineno-85-7" name="__codelineno-85-7"></a><a href="#__codelineno-85-7"><span class="linenos" data-linenos=" 7 "></span></a>e = 54722
<a id="__codelineno-85-8" name="__codelineno-85-8"></a><a href="#__codelineno-85-8"><span class="linenos" data-linenos=" 8 "></span></a>
<a id="__codelineno-85-9" name="__codelineno-85-9"></a><a href="#__codelineno-85-9"><span class="linenos" data-linenos=" 9 "></span></a>d = gmpy2.invert( e//2 , phi )
<a id="__codelineno-85-10" name="__codelineno-85-10"></a><a href="#__codelineno-85-10"><span class="linenos" data-linenos="10 "></span></a>flag = iroot(pow( c , d , n ),2)[0]
<a id="__codelineno-85-11" name="__codelineno-85-11"></a><a href="#__codelineno-85-11"><span class="linenos" data-linenos="11 "></span></a>print( long_to_bytes( flag ) )
</code></pre></div>
<p>flag:<code>flag{diff1cult_rsa_1s_e@sy}</code></p>
<h3 id="wustctf2020dp_leaking_1s_very_dangerous">[WUSTCTF2020]dp_leaking_1s_very_d@angerous<a class="headerlink" href="#wustctf2020dp_leaking_1s_very_dangerous" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-86-1" name="__codelineno-86-1"></a><a href="#__codelineno-86-1"><span class="linenos" data-linenos="1 "></span></a>e = 65537
<a id="__codelineno-86-2" name="__codelineno-86-2"></a><a href="#__codelineno-86-2"><span class="linenos" data-linenos="2 "></span></a>n = 156808343598578774957375696815188980682166740609302831099696492068246337198792510898818496239166339015207305102101431634283168544492984586566799996471150252382144148257236707247267506165670877506370253127695314163987084076462560095456635833650720606337852199362362120808707925913897956527780930423574343287847
<a id="__codelineno-86-3" name="__codelineno-86-3"></a><a href="#__codelineno-86-3"><span class="linenos" data-linenos="3 "></span></a>c = 108542078809057774666748066235473292495343753790443966020636060807418393737258696352569345621488958094856305865603100885838672591764072157183336139243588435583104423268921439473113244493821692560960443688048994557463526099985303667243623711454841573922233051289561865599722004107134302070301237345400354257869
<a id="__codelineno-86-4" name="__codelineno-86-4"></a><a href="#__codelineno-86-4"><span class="linenos" data-linenos="4 "></span></a>dp = 734763139918837027274765680404546851353356952885439663987181004382601658386317353877499122276686150509151221546249750373865024485652349719427182780275825
</code></pre></div>
<hr />
<p>dp泄露的模板题</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-87-1" name="__codelineno-87-1"></a><a href="#__codelineno-87-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-87-2" name="__codelineno-87-2"></a><a href="#__codelineno-87-2"><span class="linenos" data-linenos=" 2 "></span></a>import gmpy2
<a id="__codelineno-87-3" name="__codelineno-87-3"></a><a href="#__codelineno-87-3"><span class="linenos" data-linenos=" 3 "></span></a>e = 65537
<a id="__codelineno-87-4" name="__codelineno-87-4"></a><a href="#__codelineno-87-4"><span class="linenos" data-linenos=" 4 "></span></a>n = 156808343598578774957375696815188980682166740609302831099696492068246337198792510898818496239166339015207305102101431634283168544492984586566799996471150252382144148257236707247267506165670877506370253127695314163987084076462560095456635833650720606337852199362362120808707925913897956527780930423574343287847
<a id="__codelineno-87-5" name="__codelineno-87-5"></a><a href="#__codelineno-87-5"><span class="linenos" data-linenos=" 5 "></span></a>c = 108542078809057774666748066235473292495343753790443966020636060807418393737258696352569345621488958094856305865603100885838672591764072157183336139243588435583104423268921439473113244493821692560960443688048994557463526099985303667243623711454841573922233051289561865599722004107134302070301237345400354257869
<a id="__codelineno-87-6" name="__codelineno-87-6"></a><a href="#__codelineno-87-6"><span class="linenos" data-linenos=" 6 "></span></a>dp = 734763139918837027274765680404546851353356952885439663987181004382601658386317353877499122276686150509151221546249750373865024485652349719427182780275825
<a id="__codelineno-87-7" name="__codelineno-87-7"></a><a href="#__codelineno-87-7"><span class="linenos" data-linenos=" 7 "></span></a>
<a id="__codelineno-87-8" name="__codelineno-87-8"></a><a href="#__codelineno-87-8"><span class="linenos" data-linenos=" 8 "></span></a>for i in range(1,e):
<a id="__codelineno-87-9" name="__codelineno-87-9"></a><a href="#__codelineno-87-9"><span class="linenos" data-linenos=" 9 "></span></a>    if (dp*e-1)%i==0:
<a id="__codelineno-87-10" name="__codelineno-87-10"></a><a href="#__codelineno-87-10"><span class="linenos" data-linenos="10 "></span></a>        if n%((dp*e-1)//i+1)==0:
<a id="__codelineno-87-11" name="__codelineno-87-11"></a><a href="#__codelineno-87-11"><span class="linenos" data-linenos="11 "></span></a>            p=(dp*e-1)//i+1
<a id="__codelineno-87-12" name="__codelineno-87-12"></a><a href="#__codelineno-87-12"><span class="linenos" data-linenos="12 "></span></a>            q=n//p
<a id="__codelineno-87-13" name="__codelineno-87-13"></a><a href="#__codelineno-87-13"><span class="linenos" data-linenos="13 "></span></a>            phi=(p-1)*(q-1)
<a id="__codelineno-87-14" name="__codelineno-87-14"></a><a href="#__codelineno-87-14"><span class="linenos" data-linenos="14 "></span></a>            d=gmpy2.invert(e,phi)
<a id="__codelineno-87-15" name="__codelineno-87-15"></a><a href="#__codelineno-87-15"><span class="linenos" data-linenos="15 "></span></a>            print(long_to_bytes(gmpy2.powmod(c,d,n)))
<a id="__codelineno-87-16" name="__codelineno-87-16"></a><a href="#__codelineno-87-16"><span class="linenos" data-linenos="16 "></span></a>            break
</code></pre></div>
<p>flag:<code>flag{dp_leaking_1s_very_d@angerous}</code></p>
<h3 id="inshack2017rsa16m">[INSHack2017]rsa16m<a class="headerlink" href="#inshack2017rsa16m" title="Permanent link">&para;</a></h3>
<p>n（很大很大）=  ;  c =   ; e = </p>
<hr />
<p>低密度质数攻击</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-88-1" name="__codelineno-88-1"></a><a href="#__codelineno-88-1"><span class="linenos" data-linenos="1 "></span></a>print( long_to_bytes( iroot( c , e )[0] ) )
</code></pre></div>
<p>flag:<code>flag{(I)NSA_W0uld_bE_pr0uD}</code></p>
<h3 id="rsa-what">RSA &amp; what<a class="headerlink" href="#rsa-what" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-89-1" name="__codelineno-89-1"></a><a href="#__codelineno-89-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import bytes_to_long, getPrime
<a id="__codelineno-89-2" name="__codelineno-89-2"></a><a href="#__codelineno-89-2"><span class="linenos" data-linenos=" 2 "></span></a>from random import randint
<a id="__codelineno-89-3" name="__codelineno-89-3"></a><a href="#__codelineno-89-3"><span class="linenos" data-linenos=" 3 "></span></a>from gmpy2 import powmod
<a id="__codelineno-89-4" name="__codelineno-89-4"></a><a href="#__codelineno-89-4"><span class="linenos" data-linenos=" 4 "></span></a>
<a id="__codelineno-89-5" name="__codelineno-89-5"></a><a href="#__codelineno-89-5"><span class="linenos" data-linenos=" 5 "></span></a>p = getPrime(2048)
<a id="__codelineno-89-6" name="__codelineno-89-6"></a><a href="#__codelineno-89-6"><span class="linenos" data-linenos=" 6 "></span></a>q = getPrime(2048)
<a id="__codelineno-89-7" name="__codelineno-89-7"></a><a href="#__codelineno-89-7"><span class="linenos" data-linenos=" 7 "></span></a>N = p*q
<a id="__codelineno-89-8" name="__codelineno-89-8"></a><a href="#__codelineno-89-8"><span class="linenos" data-linenos=" 8 "></span></a>Phi = (p-1)*(q-1)
<a id="__codelineno-89-9" name="__codelineno-89-9"></a><a href="#__codelineno-89-9"><span class="linenos" data-linenos=" 9 "></span></a>def get_enc_key(N,Phi):
<a id="__codelineno-89-10" name="__codelineno-89-10"></a><a href="#__codelineno-89-10"><span class="linenos" data-linenos="10 "></span></a>    e = getPrime(N)
<a id="__codelineno-89-11" name="__codelineno-89-11"></a><a href="#__codelineno-89-11"><span class="linenos" data-linenos="11 "></span></a>    if Phi % e == 0:
<a id="__codelineno-89-12" name="__codelineno-89-12"></a><a href="#__codelineno-89-12"><span class="linenos" data-linenos="12 "></span></a>        return get_enc_key(N, Phi)
<a id="__codelineno-89-13" name="__codelineno-89-13"></a><a href="#__codelineno-89-13"><span class="linenos" data-linenos="13 "></span></a>    else:
<a id="__codelineno-89-14" name="__codelineno-89-14"></a><a href="#__codelineno-89-14"><span class="linenos" data-linenos="14 "></span></a>        return e
<a id="__codelineno-89-15" name="__codelineno-89-15"></a><a href="#__codelineno-89-15"><span class="linenos" data-linenos="15 "></span></a>e1 = get_enc_key(randint(10, 12), Phi)
<a id="__codelineno-89-16" name="__codelineno-89-16"></a><a href="#__codelineno-89-16"><span class="linenos" data-linenos="16 "></span></a>e2 = get_enc_key(randint(10, 12), Phi)
<a id="__codelineno-89-17" name="__codelineno-89-17"></a><a href="#__codelineno-89-17"><span class="linenos" data-linenos="17 "></span></a>
<a id="__codelineno-89-18" name="__codelineno-89-18"></a><a href="#__codelineno-89-18"><span class="linenos" data-linenos="18 "></span></a>fr = open(r&quot;./base64&quot;, &quot;rb&quot;)#flag is in this file
<a id="__codelineno-89-19" name="__codelineno-89-19"></a><a href="#__codelineno-89-19"><span class="linenos" data-linenos="19 "></span></a>f1 = open(r&quot;./HUB1&quot;, &quot;wb&quot;)
<a id="__codelineno-89-20" name="__codelineno-89-20"></a><a href="#__codelineno-89-20"><span class="linenos" data-linenos="20 "></span></a>f2 = open(r&quot;./HUB2&quot;, &quot;wb&quot;)
<a id="__codelineno-89-21" name="__codelineno-89-21"></a><a href="#__codelineno-89-21"><span class="linenos" data-linenos="21 "></span></a>base64 = fr.read(255)
<a id="__codelineno-89-22" name="__codelineno-89-22"></a><a href="#__codelineno-89-22"><span class="linenos" data-linenos="22 "></span></a>f1.write(&quot;%d\n%d\n&quot; % (N, e1))
<a id="__codelineno-89-23" name="__codelineno-89-23"></a><a href="#__codelineno-89-23"><span class="linenos" data-linenos="23 "></span></a>f2.write(&quot;%d\n%d\n&quot; % (N, e2))
<a id="__codelineno-89-24" name="__codelineno-89-24"></a><a href="#__codelineno-89-24"><span class="linenos" data-linenos="24 "></span></a>while len(base64)&gt;0:
<a id="__codelineno-89-25" name="__codelineno-89-25"></a><a href="#__codelineno-89-25"><span class="linenos" data-linenos="25 "></span></a>    pt = bytes_to_long(base64)
<a id="__codelineno-89-26" name="__codelineno-89-26"></a><a href="#__codelineno-89-26"><span class="linenos" data-linenos="26 "></span></a>    ct1 = powmod(pt, e1, N)
<a id="__codelineno-89-27" name="__codelineno-89-27"></a><a href="#__codelineno-89-27"><span class="linenos" data-linenos="27 "></span></a>    ct2 = powmod(pt, e2, N)
<a id="__codelineno-89-28" name="__codelineno-89-28"></a><a href="#__codelineno-89-28"><span class="linenos" data-linenos="28 "></span></a>    f1.write(&quot;\n%d&quot; % ct1)
<a id="__codelineno-89-29" name="__codelineno-89-29"></a><a href="#__codelineno-89-29"><span class="linenos" data-linenos="29 "></span></a>    f2.write(&quot;\n%d&quot; % ct2)
<a id="__codelineno-89-30" name="__codelineno-89-30"></a><a href="#__codelineno-89-30"><span class="linenos" data-linenos="30 "></span></a>    base64 = fr.read(255)
<a id="__codelineno-89-31" name="__codelineno-89-31"></a><a href="#__codelineno-89-31"><span class="linenos" data-linenos="31 "></span></a>fr.close()
<a id="__codelineno-89-32" name="__codelineno-89-32"></a><a href="#__codelineno-89-32"><span class="linenos" data-linenos="32 "></span></a>f1.close()
<a id="__codelineno-89-33" name="__codelineno-89-33"></a><a href="#__codelineno-89-33"><span class="linenos" data-linenos="33 "></span></a>f2.close()
</code></pre></div>
<hr />
<p>共膜攻击</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-90-1" name="__codelineno-90-1"></a><a href="#__codelineno-90-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-90-2" name="__codelineno-90-2"></a><a href="#__codelineno-90-2"><span class="linenos" data-linenos=" 2 "></span></a>import base64
<a id="__codelineno-90-3" name="__codelineno-90-3"></a><a href="#__codelineno-90-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-90-4" name="__codelineno-90-4"></a><a href="#__codelineno-90-4"><span class="linenos" data-linenos=" 4 "></span></a>def exgcd( a , b ):
<a id="__codelineno-90-5" name="__codelineno-90-5"></a><a href="#__codelineno-90-5"><span class="linenos" data-linenos=" 5 "></span></a>    if a == 0:
<a id="__codelineno-90-6" name="__codelineno-90-6"></a><a href="#__codelineno-90-6"><span class="linenos" data-linenos=" 6 "></span></a>        return ( b , 0 , 1 )
<a id="__codelineno-90-7" name="__codelineno-90-7"></a><a href="#__codelineno-90-7"><span class="linenos" data-linenos=" 7 "></span></a>    else:
<a id="__codelineno-90-8" name="__codelineno-90-8"></a><a href="#__codelineno-90-8"><span class="linenos" data-linenos=" 8 "></span></a>        g , y , x = exgcd( b % a , a )  
<a id="__codelineno-90-9" name="__codelineno-90-9"></a><a href="#__codelineno-90-9"><span class="linenos" data-linenos=" 9 "></span></a>        return ( g , x - (b//a)*y , y )
<a id="__codelineno-90-10" name="__codelineno-90-10"></a><a href="#__codelineno-90-10"><span class="linenos" data-linenos="10 "></span></a>
<a id="__codelineno-90-11" name="__codelineno-90-11"></a><a href="#__codelineno-90-11"><span class="linenos" data-linenos="11 "></span></a>def CMA( n , e1 , e2 , c1 , c2 ):
<a id="__codelineno-90-12" name="__codelineno-90-12"></a><a href="#__codelineno-90-12"><span class="linenos" data-linenos="12 "></span></a>    temp , s1 , s2 = exgcd( e1 , e2 )
<a id="__codelineno-90-13" name="__codelineno-90-13"></a><a href="#__codelineno-90-13"><span class="linenos" data-linenos="13 "></span></a>    if s1 &lt; 0:
<a id="__codelineno-90-14" name="__codelineno-90-14"></a><a href="#__codelineno-90-14"><span class="linenos" data-linenos="14 "></span></a>        s1 = -s1
<a id="__codelineno-90-15" name="__codelineno-90-15"></a><a href="#__codelineno-90-15"><span class="linenos" data-linenos="15 "></span></a>        c1 = inverse( c1 , n )
<a id="__codelineno-90-16" name="__codelineno-90-16"></a><a href="#__codelineno-90-16"><span class="linenos" data-linenos="16 "></span></a>    elif s2 &lt; 0:
<a id="__codelineno-90-17" name="__codelineno-90-17"></a><a href="#__codelineno-90-17"><span class="linenos" data-linenos="17 "></span></a>        s2 = -s2
<a id="__codelineno-90-18" name="__codelineno-90-18"></a><a href="#__codelineno-90-18"><span class="linenos" data-linenos="18 "></span></a>        c2 = inverse( c2 , n )
<a id="__codelineno-90-19" name="__codelineno-90-19"></a><a href="#__codelineno-90-19"><span class="linenos" data-linenos="19 "></span></a>    m = pow( c1 , s1 , n ) * pow( c2 , s2 , n ) % n
<a id="__codelineno-90-20" name="__codelineno-90-20"></a><a href="#__codelineno-90-20"><span class="linenos" data-linenos="20 "></span></a>    return m
<a id="__codelineno-90-21" name="__codelineno-90-21"></a><a href="#__codelineno-90-21"><span class="linenos" data-linenos="21 "></span></a>
<a id="__codelineno-90-22" name="__codelineno-90-22"></a><a href="#__codelineno-90-22"><span class="linenos" data-linenos="22 "></span></a>f1 = open(&quot;HUB1&quot;) ; f2 = open(&quot;HUB2&quot;)
<a id="__codelineno-90-23" name="__codelineno-90-23"></a><a href="#__codelineno-90-23"><span class="linenos" data-linenos="23 "></span></a>
<a id="__codelineno-90-24" name="__codelineno-90-24"></a><a href="#__codelineno-90-24"><span class="linenos" data-linenos="24 "></span></a>N , N = f1.readline() , f2.readline()
<a id="__codelineno-90-25" name="__codelineno-90-25"></a><a href="#__codelineno-90-25"><span class="linenos" data-linenos="25 "></span></a>e1,e2 = f1.readline() , f2.readline()
<a id="__codelineno-90-26" name="__codelineno-90-26"></a><a href="#__codelineno-90-26"><span class="linenos" data-linenos="26 "></span></a>f1.readline() ; f2.readline()
<a id="__codelineno-90-27" name="__codelineno-90-27"></a><a href="#__codelineno-90-27"><span class="linenos" data-linenos="27 "></span></a>c1,c2 = f1.readline() , f2.readline()
<a id="__codelineno-90-28" name="__codelineno-90-28"></a><a href="#__codelineno-90-28"><span class="linenos" data-linenos="28 "></span></a>
<a id="__codelineno-90-29" name="__codelineno-90-29"></a><a href="#__codelineno-90-29"><span class="linenos" data-linenos="29 "></span></a>ans = b&#39;&#39;
<a id="__codelineno-90-30" name="__codelineno-90-30"></a><a href="#__codelineno-90-30"><span class="linenos" data-linenos="30 "></span></a>cnt = 0
<a id="__codelineno-90-31" name="__codelineno-90-31"></a><a href="#__codelineno-90-31"><span class="linenos" data-linenos="31 "></span></a>while( len(c1) ):
<a id="__codelineno-90-32" name="__codelineno-90-32"></a><a href="#__codelineno-90-32"><span class="linenos" data-linenos="32 "></span></a>    cnt += 1
<a id="__codelineno-90-33" name="__codelineno-90-33"></a><a href="#__codelineno-90-33"><span class="linenos" data-linenos="33 "></span></a>    ans += long_to_bytes( CMA(int(N),int(e1),int(e2),int(c1),int(c2)) )
<a id="__codelineno-90-34" name="__codelineno-90-34"></a><a href="#__codelineno-90-34"><span class="linenos" data-linenos="34 "></span></a>    c1 , c2 = f1.readline() , f2.readline()
<a id="__codelineno-90-35" name="__codelineno-90-35"></a><a href="#__codelineno-90-35"><span class="linenos" data-linenos="35 "></span></a>temp = b&#39;&#39;
<a id="__codelineno-90-36" name="__codelineno-90-36"></a><a href="#__codelineno-90-36"><span class="linenos" data-linenos="36 "></span></a>M = b&#39;&#39;
<a id="__codelineno-90-37" name="__codelineno-90-37"></a><a href="#__codelineno-90-37"><span class="linenos" data-linenos="37 "></span></a>print( ans )
<a id="__codelineno-90-38" name="__codelineno-90-38"></a><a href="#__codelineno-90-38"><span class="linenos" data-linenos="38 "></span></a>for i in ans:
<a id="__codelineno-90-39" name="__codelineno-90-39"></a><a href="#__codelineno-90-39"><span class="linenos" data-linenos="39 "></span></a>    k = long_to_bytes(i)
<a id="__codelineno-90-40" name="__codelineno-90-40"></a><a href="#__codelineno-90-40"><span class="linenos" data-linenos="40 "></span></a>    if k == b&#39;\n&#39;:
<a id="__codelineno-90-41" name="__codelineno-90-41"></a><a href="#__codelineno-90-41"><span class="linenos" data-linenos="41 "></span></a>        M += base64.b64decode( temp )
<a id="__codelineno-90-42" name="__codelineno-90-42"></a><a href="#__codelineno-90-42"><span class="linenos" data-linenos="42 "></span></a>        temp = b&#39;&#39;
<a id="__codelineno-90-43" name="__codelineno-90-43"></a><a href="#__codelineno-90-43"><span class="linenos" data-linenos="43 "></span></a>        continue
<a id="__codelineno-90-44" name="__codelineno-90-44"></a><a href="#__codelineno-90-44"><span class="linenos" data-linenos="44 "></span></a>    temp += k
<a id="__codelineno-90-45" name="__codelineno-90-45"></a><a href="#__codelineno-90-45"><span class="linenos" data-linenos="45 "></span></a>print( M )
</code></pre></div>
<p>得到密文</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-91-1" name="__codelineno-91-1"></a><a href="#__codelineno-91-1"><span class="linenos" data-linenos="1 "></span></a>THISFLAGISHIDDEN.CANYOUFINDITOUT?DOYOUKNOWBASE64?YoungCTHINKYOUARENOTTHATFAMILIARWITHBASE64.Base64isagroupofsimilarbinary-to-textencodingschemesthatrepresentbinarydatainanASCIIstringformatbytranslatingitintoaradix-64representation.ThetermBase64originatesfromaspecificMIMEcontenttransferencoding.Theparticularsetof64characterschosentorepresentthe64place-valuesforthebasevariesbetweenimplementations.Thegeneralstrategyistochoose64charactersthatarebothmembersofasubsetcommontomostencodings,andalsoprintable.Thiscombinationleavesthedataunlikelytobemodifiedintransitthroughinformationsystems,suchasE-mail,thatweretraditionallynot8-bitclean.[1]Forexample,MIME&#39;sBase64implementationusesA\xa8CZ,a\xa8Cz,and0\xa8C9forthefirst62values.Othervariationssharethispropertybutdifferinthesymbolschosenforthelasttwovalues;anexampleis
</code></pre></div>
<p>进行base64隐写解密得到</p>
<p>flag:<code>flag{7c86d8f7d6de33a87f7f9d6b005ce640}</code></p>
<h3 id="actf2020crypto-aes">[ACTF新生赛2020]crypto-aes<a class="headerlink" href="#actf2020crypto-aes" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-92-1" name="__codelineno-92-1"></a><a href="#__codelineno-92-1"><span class="linenos" data-linenos=" 1 "></span></a>from Cryptodome.Cipher import AES
<a id="__codelineno-92-2" name="__codelineno-92-2"></a><a href="#__codelineno-92-2"><span class="linenos" data-linenos=" 2 "></span></a>import os
<a id="__codelineno-92-3" name="__codelineno-92-3"></a><a href="#__codelineno-92-3"><span class="linenos" data-linenos=" 3 "></span></a>import gmpy2
<a id="__codelineno-92-4" name="__codelineno-92-4"></a><a href="#__codelineno-92-4"><span class="linenos" data-linenos=" 4 "></span></a>from flag import FLAG
<a id="__codelineno-92-5" name="__codelineno-92-5"></a><a href="#__codelineno-92-5"><span class="linenos" data-linenos=" 5 "></span></a>from Cryptodome.Util.number import *
<a id="__codelineno-92-6" name="__codelineno-92-6"></a><a href="#__codelineno-92-6"><span class="linenos" data-linenos=" 6 "></span></a>
<a id="__codelineno-92-7" name="__codelineno-92-7"></a><a href="#__codelineno-92-7"><span class="linenos" data-linenos=" 7 "></span></a>def main():
<a id="__codelineno-92-8" name="__codelineno-92-8"></a><a href="#__codelineno-92-8"><span class="linenos" data-linenos=" 8 "></span></a>    key=os.urandom(2)*16
<a id="__codelineno-92-9" name="__codelineno-92-9"></a><a href="#__codelineno-92-9"><span class="linenos" data-linenos=" 9 "></span></a>    iv=os.urandom(16)
<a id="__codelineno-92-10" name="__codelineno-92-10"></a><a href="#__codelineno-92-10"><span class="linenos" data-linenos="10 "></span></a>    print(bytes_to_long(key)^bytes_to_long(iv))
<a id="__codelineno-92-11" name="__codelineno-92-11"></a><a href="#__codelineno-92-11"><span class="linenos" data-linenos="11 "></span></a>    aes=AES.new(key,AES.MODE_CBC,iv)
<a id="__codelineno-92-12" name="__codelineno-92-12"></a><a href="#__codelineno-92-12"><span class="linenos" data-linenos="12 "></span></a>    enc_flag = aes.encrypt(FLAG)
<a id="__codelineno-92-13" name="__codelineno-92-13"></a><a href="#__codelineno-92-13"><span class="linenos" data-linenos="13 "></span></a>    print(enc_flag)
<a id="__codelineno-92-14" name="__codelineno-92-14"></a><a href="#__codelineno-92-14"><span class="linenos" data-linenos="14 "></span></a>if __name__==&quot;__main__&quot;:
<a id="__codelineno-92-15" name="__codelineno-92-15"></a><a href="#__codelineno-92-15"><span class="linenos" data-linenos="15 "></span></a>    main()
<a id="__codelineno-92-16" name="__codelineno-92-16"></a><a href="#__codelineno-92-16"><span class="linenos" data-linenos="16 "></span></a>
<a id="__codelineno-92-17" name="__codelineno-92-17"></a><a href="#__codelineno-92-17"><span class="linenos" data-linenos="17 "></span></a>&quot;&quot;&quot;
<a id="__codelineno-92-18" name="__codelineno-92-18"></a><a href="#__codelineno-92-18"><span class="linenos" data-linenos="18 "></span></a>91144196586662942563895769614300232343026691029427747065707381728622849079757
<a id="__codelineno-92-19" name="__codelineno-92-19"></a><a href="#__codelineno-92-19"><span class="linenos" data-linenos="19 "></span></a>b&#39;\x8c-\xcd\xde\xa7\xe9\x7f.b\x8aKs\xf1\xba\xc75\xc4d\x13\x07\xac\xa4&amp;\xd6\x91\xfe\xf3\x14\x10|\xf8p&#39;
<a id="__codelineno-92-20" name="__codelineno-92-20"></a><a href="#__codelineno-92-20"><span class="linenos" data-linenos="20 "></span></a>&quot;&quot;&quot;
</code></pre></div>
<hr />
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-93-1" name="__codelineno-93-1"></a><a href="#__codelineno-93-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Cipher import AES
<a id="__codelineno-93-2" name="__codelineno-93-2"></a><a href="#__codelineno-93-2"><span class="linenos" data-linenos=" 2 "></span></a>import os
<a id="__codelineno-93-3" name="__codelineno-93-3"></a><a href="#__codelineno-93-3"><span class="linenos" data-linenos=" 3 "></span></a>from gmpy2 import *
<a id="__codelineno-93-4" name="__codelineno-93-4"></a><a href="#__codelineno-93-4"><span class="linenos" data-linenos=" 4 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-93-5" name="__codelineno-93-5"></a><a href="#__codelineno-93-5"><span class="linenos" data-linenos=" 5 "></span></a>
<a id="__codelineno-93-6" name="__codelineno-93-6"></a><a href="#__codelineno-93-6"><span class="linenos" data-linenos=" 6 "></span></a>xor = 91144196586662942563895769614300232343026691029427747065707381728622849079757
<a id="__codelineno-93-7" name="__codelineno-93-7"></a><a href="#__codelineno-93-7"><span class="linenos" data-linenos=" 7 "></span></a>enc_flag = b&#39;\x8c-\xcd\xde\xa7\xe9\x7f.b\x8aKs\xf1\xba\xc75\xc4d\x13\x07\xac\xa4&amp;\xd6\x91\xfe\xf3\x14\x10|\xf8p&#39;
<a id="__codelineno-93-8" name="__codelineno-93-8"></a><a href="#__codelineno-93-8"><span class="linenos" data-linenos=" 8 "></span></a>
<a id="__codelineno-93-9" name="__codelineno-93-9"></a><a href="#__codelineno-93-9"><span class="linenos" data-linenos=" 9 "></span></a>out = long_to_bytes( xor )
<a id="__codelineno-93-10" name="__codelineno-93-10"></a><a href="#__codelineno-93-10"><span class="linenos" data-linenos="10 "></span></a>key = out[:16]*2
<a id="__codelineno-93-11" name="__codelineno-93-11"></a><a href="#__codelineno-93-11"><span class="linenos" data-linenos="11 "></span></a>iv = bytes_to_long(key[16:])^bytes_to_long(out[16:])
<a id="__codelineno-93-12" name="__codelineno-93-12"></a><a href="#__codelineno-93-12"><span class="linenos" data-linenos="12 "></span></a>iv = long_to_bytes( iv )
<a id="__codelineno-93-13" name="__codelineno-93-13"></a><a href="#__codelineno-93-13"><span class="linenos" data-linenos="13 "></span></a>
<a id="__codelineno-93-14" name="__codelineno-93-14"></a><a href="#__codelineno-93-14"><span class="linenos" data-linenos="14 "></span></a>aes = AES.new( key , AES.MODE_CBC , iv )
<a id="__codelineno-93-15" name="__codelineno-93-15"></a><a href="#__codelineno-93-15"><span class="linenos" data-linenos="15 "></span></a>print( aes.decrypt( enc_flag ) )
</code></pre></div>
<p>flag:<code>flag{W0W_y0u_can_so1v3_AES_now!}</code></p>
<h3 id="inshack2019yet-another-rsa-challenge-part-1">[INSHack2019]Yet Another RSA Challenge - Part 1<a class="headerlink" href="#inshack2019yet-another-rsa-challenge-part-1" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-94-1" name="__codelineno-94-1"></a><a href="#__codelineno-94-1"><span class="linenos" data-linenos="1 "></span></a>[Buy an encrypted flag, get a (almost intact) prime factor for free !](https://static.ctf.insecurity-insa.fr/595437e42ea3951e8ed4ecda16141f017f3ba36b.tar.gz)
<a id="__codelineno-94-2" name="__codelineno-94-2"></a><a href="#__codelineno-94-2"><span class="linenos" data-linenos="2 "></span></a>
<a id="__codelineno-94-3" name="__codelineno-94-3"></a><a href="#__codelineno-94-3"><span class="linenos" data-linenos="3 "></span></a>You can find a harder version of this challenge in the Programming category.
</code></pre></div>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-95-1" name="__codelineno-95-1"></a><a href="#__codelineno-95-1"><span class="linenos" data-linenos="1 "></span></a>719579745653303119025873098043848913976880838286635817351790189702008424828505522253331968992725441130409959387942238566082746772468987336980704680915524591881919460709921709513741059003955050088052599067720107149755856317364317707629467090624585752920523062378696431510814381603360130752588995217840721808871896469275562085215852034302374902524921137398710508865248881286824902780186249148613287250056380811479959269915786545911048030947364841177976623684660771594747297272818410589981294227084173316280447729440036251406684111603371364957690353449585185893322538541593242187738587675489180722498945337715511212885934126635221601469699184812336984707723198731876940991485904637481371763302337637617744175461566445514603405016576604569057507997291470369704260553992902776099599438704680775883984720946337235834374667842758010444010254965664863296455406931885650448386682827401907759661117637294838753325610213809162253020362015045242003388829769019579522792182295457962911430276020610658073659629786668639126004851910536565721128484604554703970965744790413684836096724064390486888113608024265771815004188203124405817878645103282802994701531113849607969243815078720289912255827700390198089699808626116357304202660642601149742427766381
<a id="__codelineno-95-2" name="__codelineno-95-2"></a><a href="#__codelineno-95-2"><span class="linenos" data-linenos="2 "></span></a>0xDCC5A0BD3A1FC0BEB0DA1C2E8CF6B474481B7C12849B76E03C4C946724DB577D2825D6AA193DB559BC9DBABE1DDE8B5E7805E48749EF002F622F7CDBD7853B200E2A027E87E331AFCFD066ED9900F1E5F5E5196A451A6F9E329EB889D773F08E5FBF45AACB818FD186DD74626180294DCC31805A88D1B71DE5BFEF3ED01F12678D906A833A78EDCE9BDAF22BBE45C0BFB7A82AFE42C1C3B8581C83BF43DFE31BFD81527E507686956458905CC9A660604552A060109DC81D01F229A264AB67C6D7168721AB36DE769CEAFB97F238050193EC942078DDF5329A387F46253A4411A9C8BB71F9AEB11AC9623E41C14FCD2739D76E69283E57DDB11FC531B4611EE3
<a id="__codelineno-95-3" name="__codelineno-95-3"></a><a href="#__codelineno-95-3"><span class="linenos" data-linenos="3 "></span></a>596380963583874022971492302071822444225514552231574984926542429117396590795270181084030717066220888052607057994262255729890598322976783889090993129161030148064314476199052180347747135088933481343974996843632511300255010825580875930722684714290535684951679115573751200980708359500292172387447570080875531002842462002727646367063816531958020271149645805755077133231395881833164790825731218786554806777097126212126561056170733032553159740167058242065879953688453169613384659653035659118823444582576657499974059388261153064772228570460351169216103620379299362366574826080703907036316546232196313193923841110510170689800892941998845140534954264505413254429240789223724066502818922164419890197058252325607667959185100118251170368909192832882776642565026481260424714348087206462283972676596101498123547647078981435969530082351104111747783346230914935599764345176602456069568419879060577771404946743580809330315332836749661503035076868102720709045692483171306425207758972682717326821412843569770615848397477633761506670219845039890098105484693890695897858251238713238301401843678654564558196040100908796513657968507381392735855990706254646471937809011610992016368630851454275478216664521360246605400986428230407975530880206404171034278692756
</code></pre></div>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-96-1" name="__codelineno-96-1"></a><a href="#__codelineno-96-1"><span class="linenos" data-linenos="1 "></span></a>import subprocess
<a id="__codelineno-96-2" name="__codelineno-96-2"></a><a href="#__codelineno-96-2"><span class="linenos" data-linenos="2 "></span></a>p = subprocess.check_output(&#39;openssl prime -generate -bits 2048 -hex&#39;)
<a id="__codelineno-96-3" name="__codelineno-96-3"></a><a href="#__codelineno-96-3"><span class="linenos" data-linenos="3 "></span></a>q = subprocess.check_output(&#39;openssl prime -generate -bits 2048 -hex&#39;)
<a id="__codelineno-96-4" name="__codelineno-96-4"></a><a href="#__codelineno-96-4"><span class="linenos" data-linenos="4 "></span></a>flag = int(&#39;INSA{REDACTED}&#39;.encode(&#39;hex&#39;), 16)
<a id="__codelineno-96-5" name="__codelineno-96-5"></a><a href="#__codelineno-96-5"><span class="linenos" data-linenos="5 "></span></a>
<a id="__codelineno-96-6" name="__codelineno-96-6"></a><a href="#__codelineno-96-6"><span class="linenos" data-linenos="6 "></span></a>N = int(p,16) * int(q,16)
<a id="__codelineno-96-7" name="__codelineno-96-7"></a><a href="#__codelineno-96-7"><span class="linenos" data-linenos="7 "></span></a>print N
<a id="__codelineno-96-8" name="__codelineno-96-8"></a><a href="#__codelineno-96-8"><span class="linenos" data-linenos="8 "></span></a>print &#39;0x&#39;+p.replace(&#39;9F&#39;,&#39;FC&#39;)
<a id="__codelineno-96-9" name="__codelineno-96-9"></a><a href="#__codelineno-96-9"><span class="linenos" data-linenos="9 "></span></a>print pow(flag,65537,N)
</code></pre></div>
<hr />
<p>p 的16进制数被替换了一部分，通过爆破的方式获取 p 的值</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-97-1" name="__codelineno-97-1"></a><a href="#__codelineno-97-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import*
<a id="__codelineno-97-2" name="__codelineno-97-2"></a><a href="#__codelineno-97-2"><span class="linenos" data-linenos=" 2 "></span></a>from gmpy2 import*
<a id="__codelineno-97-3" name="__codelineno-97-3"></a><a href="#__codelineno-97-3"><span class="linenos" data-linenos=" 3 "></span></a>from libnum import*
<a id="__codelineno-97-4" name="__codelineno-97-4"></a><a href="#__codelineno-97-4"><span class="linenos" data-linenos=" 4 "></span></a>N = 719579745653303119025873098043848913976880838286635817351790189702008424828505522253331968992725441130409959387942238566082746772468987336980704680915524591881919460709921709513741059003955050088052599067720107149755856317364317707629467090624585752920523062378696431510814381603360130752588995217840721808871896469275562085215852034302374902524921137398710508865248881286824902780186249148613287250056380811479959269915786545911048030947364841177976623684660771594747297272818410589981294227084173316280447729440036251406684111603371364957690353449585185893322538541593242187738587675489180722498945337715511212885934126635221601469699184812336984707723198731876940991485904637481371763302337637617744175461566445514603405016576604569057507997291470369704260553992902776099599438704680775883984720946337235834374667842758010444010254965664863296455406931885650448386682827401907759661117637294838753325610213809162253020362015045242003388829769019579522792182295457962911430276020610658073659629786668639126004851910536565721128484604554703970965744790413684836096724064390486888113608024265771815004188203124405817878645103282802994701531113849607969243815078720289912255827700390198089699808626116357304202660642601149742427766381
<a id="__codelineno-97-5" name="__codelineno-97-5"></a><a href="#__codelineno-97-5"><span class="linenos" data-linenos=" 5 "></span></a>cipher = 596380963583874022971492302071822444225514552231574984926542429117396590795270181084030717066220888052607057994262255729890598322976783889090993129161030148064314476199052180347747135088933481343974996843632511300255010825580875930722684714290535684951679115573751200980708359500292172387447570080875531002842462002727646367063816531958020271149645805755077133231395881833164790825731218786554806777097126212126561056170733032553159740167058242065879953688453169613384659653035659118823444582576657499974059388261153064772228570460351169216103620379299362366574826080703907036316546232196313193923841110510170689800892941998845140534954264505413254429240789223724066502818922164419890197058252325607667959185100118251170368909192832882776642565026481260424714348087206462283972676596101498123547647078981435969530082351104111747783346230914935599764345176602456069568419879060577771404946743580809330315332836749661503035076868102720709045692483171306425207758972682717326821412843569770615848397477633761506670219845039890098105484693890695897858251238713238301401843678654564558196040100908796513657968507381392735855990706254646471937809011610992016368630851454275478216664521360246605400986428230407975530880206404171034278692756
<a id="__codelineno-97-6" name="__codelineno-97-6"></a><a href="#__codelineno-97-6"><span class="linenos" data-linenos=" 6 "></span></a>plain = [&#39;9F&#39;,&#39;FC&#39;]
<a id="__codelineno-97-7" name="__codelineno-97-7"></a><a href="#__codelineno-97-7"><span class="linenos" data-linenos=" 7 "></span></a>for a in plain:
<a id="__codelineno-97-8" name="__codelineno-97-8"></a><a href="#__codelineno-97-8"><span class="linenos" data-linenos=" 8 "></span></a>    for b in plain:
<a id="__codelineno-97-9" name="__codelineno-97-9"></a><a href="#__codelineno-97-9"><span class="linenos" data-linenos=" 9 "></span></a>        for c in plain:
<a id="__codelineno-97-10" name="__codelineno-97-10"></a><a href="#__codelineno-97-10"><span class="linenos" data-linenos="10 "></span></a>            for d in plain:
<a id="__codelineno-97-11" name="__codelineno-97-11"></a><a href="#__codelineno-97-11"><span class="linenos" data-linenos="11 "></span></a>                p1 = &#39;0xDCC5A0BD3A1&#39; +a+ &#39;0BEB0DA1C2E8CF6B474481B7C12849B76E03C4C946724DB577D2825D6AA193DB559BC9DBABE1DDE8B5E7805E48749EF002F622F7CDBD7853B200E2A027E87E331A&#39; +b+ &#39;FD066ED9900F1E5F5E5196A451A6F9E329EB889D773F08E5FBF45AACB818FD186DD74626180294DCC31805A88D1B71DE5BFEF3ED01F12678D906A833A78EDCE9BDAF22BBE45C0BFB7A82AFE42C1C3B8581C83BF43DFE31BFD81527E507686956458905CC9A660604552A060109DC81D01F229A264AB67C6D7168721AB36DE769CEAFB97F238050193EC942078DDF5329A387F46253A4411A9C8BB71F9AEB11AC9623E41C14&#39; +c+ &#39;D2739D76E69283E57DDB11&#39; +d+ &#39;531B4611EE3&#39;
<a id="__codelineno-97-12" name="__codelineno-97-12"></a><a href="#__codelineno-97-12"><span class="linenos" data-linenos="12 "></span></a>                p = int(p1,16)
<a id="__codelineno-97-13" name="__codelineno-97-13"></a><a href="#__codelineno-97-13"><span class="linenos" data-linenos="13 "></span></a>                if(N%p == 0):
<a id="__codelineno-97-14" name="__codelineno-97-14"></a><a href="#__codelineno-97-14"><span class="linenos" data-linenos="14 "></span></a>                    print(p)
<a id="__codelineno-97-15" name="__codelineno-97-15"></a><a href="#__codelineno-97-15"><span class="linenos" data-linenos="15 "></span></a>p = 27869881035956015184979178092922248885674897320108269064145135676677416930908750101386898785101159450077433625380803555071301130739332256486285289470097290409044426739584302074834857801721989648648799253740641480496433764509396039330395579654527851232078667173592401475356727873045602595552393666889257027478385213547302885118341490346766830846876201911076530008127691612594913799272782226366932754058372641521481522494577124999360890113778202218378165756595787931498460866236502220175258385407478826827807650036729385244897815805427164434537088709092238894902485613707990645011133078730017425033369999448757627854563
<a id="__codelineno-97-16" name="__codelineno-97-16"></a><a href="#__codelineno-97-16"><span class="linenos" data-linenos="16 "></span></a>q = N//p
<a id="__codelineno-97-17" name="__codelineno-97-17"></a><a href="#__codelineno-97-17"><span class="linenos" data-linenos="17 "></span></a>phi = (p-1)*(q-1)
<a id="__codelineno-97-18" name="__codelineno-97-18"></a><a href="#__codelineno-97-18"><span class="linenos" data-linenos="18 "></span></a>e = 65537
<a id="__codelineno-97-19" name="__codelineno-97-19"></a><a href="#__codelineno-97-19"><span class="linenos" data-linenos="19 "></span></a>d = invert(e,phi)
<a id="__codelineno-97-20" name="__codelineno-97-20"></a><a href="#__codelineno-97-20"><span class="linenos" data-linenos="20 "></span></a>m = pow(cipher,d,N)
<a id="__codelineno-97-21" name="__codelineno-97-21"></a><a href="#__codelineno-97-21"><span class="linenos" data-linenos="21 "></span></a>print( long_to_bytes(m) )
</code></pre></div>
<p>flag:<code>flag{I_w1ll_us3_OTp_n3xT_T1M3}</code></p>
<h3 id="npuctf2020">[NPUCTF2020]认清形势，建立信心<a class="headerlink" href="#npuctf2020" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-98-1" name="__codelineno-98-1"></a><a href="#__codelineno-98-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-98-2" name="__codelineno-98-2"></a><a href="#__codelineno-98-2"><span class="linenos" data-linenos=" 2 "></span></a>from gmpy2 import *
<a id="__codelineno-98-3" name="__codelineno-98-3"></a><a href="#__codelineno-98-3"><span class="linenos" data-linenos=" 3 "></span></a>from secret import flag
<a id="__codelineno-98-4" name="__codelineno-98-4"></a><a href="#__codelineno-98-4"><span class="linenos" data-linenos=" 4 "></span></a>
<a id="__codelineno-98-5" name="__codelineno-98-5"></a><a href="#__codelineno-98-5"><span class="linenos" data-linenos=" 5 "></span></a>p = getPrime(25)
<a id="__codelineno-98-6" name="__codelineno-98-6"></a><a href="#__codelineno-98-6"><span class="linenos" data-linenos=" 6 "></span></a>e = # Hidden
<a id="__codelineno-98-7" name="__codelineno-98-7"></a><a href="#__codelineno-98-7"><span class="linenos" data-linenos=" 7 "></span></a>q = getPrime(25)
<a id="__codelineno-98-8" name="__codelineno-98-8"></a><a href="#__codelineno-98-8"><span class="linenos" data-linenos=" 8 "></span></a>n = p * q
<a id="__codelineno-98-9" name="__codelineno-98-9"></a><a href="#__codelineno-98-9"><span class="linenos" data-linenos=" 9 "></span></a>m = bytes_to_long(flag.strip(b&quot;npuctf{&quot;).strip(b&quot;}&quot;))
<a id="__codelineno-98-10" name="__codelineno-98-10"></a><a href="#__codelineno-98-10"><span class="linenos" data-linenos="10 "></span></a>
<a id="__codelineno-98-11" name="__codelineno-98-11"></a><a href="#__codelineno-98-11"><span class="linenos" data-linenos="11 "></span></a>c = pow(m, e, n)
<a id="__codelineno-98-12" name="__codelineno-98-12"></a><a href="#__codelineno-98-12"><span class="linenos" data-linenos="12 "></span></a>print(c)
<a id="__codelineno-98-13" name="__codelineno-98-13"></a><a href="#__codelineno-98-13"><span class="linenos" data-linenos="13 "></span></a>print(pow(2, e, n))
<a id="__codelineno-98-14" name="__codelineno-98-14"></a><a href="#__codelineno-98-14"><span class="linenos" data-linenos="14 "></span></a>print(pow(4, e, n))
<a id="__codelineno-98-15" name="__codelineno-98-15"></a><a href="#__codelineno-98-15"><span class="linenos" data-linenos="15 "></span></a>print(pow(8, e, n))
<a id="__codelineno-98-16" name="__codelineno-98-16"></a><a href="#__codelineno-98-16"><span class="linenos" data-linenos="16 "></span></a>
<a id="__codelineno-98-17" name="__codelineno-98-17"></a><a href="#__codelineno-98-17"><span class="linenos" data-linenos="17 "></span></a>&#39;&#39;&#39;
<a id="__codelineno-98-18" name="__codelineno-98-18"></a><a href="#__codelineno-98-18"><span class="linenos" data-linenos="18 "></span></a>169169912654178
<a id="__codelineno-98-19" name="__codelineno-98-19"></a><a href="#__codelineno-98-19"><span class="linenos" data-linenos="19 "></span></a>128509160179202
<a id="__codelineno-98-20" name="__codelineno-98-20"></a><a href="#__codelineno-98-20"><span class="linenos" data-linenos="20 "></span></a>518818742414340
<a id="__codelineno-98-21" name="__codelineno-98-21"></a><a href="#__codelineno-98-21"><span class="linenos" data-linenos="21 "></span></a>358553002064450
<a id="__codelineno-98-22" name="__codelineno-98-22"></a><a href="#__codelineno-98-22"><span class="linenos" data-linenos="22 "></span></a>&#39;&#39;&#39;
</code></pre></div>
<hr />
<p><span class="arithmatex">\(n = gcd( c_1^2-c_2 , c_1 * c_2 - c_3 )\)</span></p>
<p>使用yafu对n分解</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-99-1" name="__codelineno-99-1"></a><a href="#__codelineno-99-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import*
<a id="__codelineno-99-2" name="__codelineno-99-2"></a><a href="#__codelineno-99-2"><span class="linenos" data-linenos=" 2 "></span></a>from gmpy2 import*
<a id="__codelineno-99-3" name="__codelineno-99-3"></a><a href="#__codelineno-99-3"><span class="linenos" data-linenos=" 3 "></span></a>from sympy import*
<a id="__codelineno-99-4" name="__codelineno-99-4"></a><a href="#__codelineno-99-4"><span class="linenos" data-linenos=" 4 "></span></a>
<a id="__codelineno-99-5" name="__codelineno-99-5"></a><a href="#__codelineno-99-5"><span class="linenos" data-linenos=" 5 "></span></a>c = 169169912654178
<a id="__codelineno-99-6" name="__codelineno-99-6"></a><a href="#__codelineno-99-6"><span class="linenos" data-linenos=" 6 "></span></a>c1 = 128509160179202
<a id="__codelineno-99-7" name="__codelineno-99-7"></a><a href="#__codelineno-99-7"><span class="linenos" data-linenos=" 7 "></span></a>c2 = 518818742414340
<a id="__codelineno-99-8" name="__codelineno-99-8"></a><a href="#__codelineno-99-8"><span class="linenos" data-linenos=" 8 "></span></a>c3 = 358553002064450
<a id="__codelineno-99-9" name="__codelineno-99-9"></a><a href="#__codelineno-99-9"><span class="linenos" data-linenos=" 9 "></span></a>
<a id="__codelineno-99-10" name="__codelineno-99-10"></a><a href="#__codelineno-99-10"><span class="linenos" data-linenos="10 "></span></a>n = gcd(pow(c1,2)-c2,c1*c2-c3)
<a id="__codelineno-99-11" name="__codelineno-99-11"></a><a href="#__codelineno-99-11"><span class="linenos" data-linenos="11 "></span></a>p = 28977097
<a id="__codelineno-99-12" name="__codelineno-99-12"></a><a href="#__codelineno-99-12"><span class="linenos" data-linenos="12 "></span></a>q = 18195301
<a id="__codelineno-99-13" name="__codelineno-99-13"></a><a href="#__codelineno-99-13"><span class="linenos" data-linenos="13 "></span></a>n = p*q
<a id="__codelineno-99-14" name="__codelineno-99-14"></a><a href="#__codelineno-99-14"><span class="linenos" data-linenos="14 "></span></a>e = discrete_log(n,c1,2)
<a id="__codelineno-99-15" name="__codelineno-99-15"></a><a href="#__codelineno-99-15"><span class="linenos" data-linenos="15 "></span></a>print(e)
<a id="__codelineno-99-16" name="__codelineno-99-16"></a><a href="#__codelineno-99-16"><span class="linenos" data-linenos="16 "></span></a>phi = (p-1)*(q-1)
<a id="__codelineno-99-17" name="__codelineno-99-17"></a><a href="#__codelineno-99-17"><span class="linenos" data-linenos="17 "></span></a>d = invert(e,phi)
<a id="__codelineno-99-18" name="__codelineno-99-18"></a><a href="#__codelineno-99-18"><span class="linenos" data-linenos="18 "></span></a>print( long_to_bytes(pow(c,int(d),n)) )
</code></pre></div>
<p>flag:<code>flag{345y!}</code></p>
<h3 id="mrctf2020babyrsa">[MRCTF2020]babyRSA<a class="headerlink" href="#mrctf2020babyrsa" title="Permanent link">&para;</a></h3>
<p>tag: RSA | 普通代码分析</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-100-1" name="__codelineno-100-1"></a><a href="#__codelineno-100-1"><span class="linenos" data-linenos=" 1 "></span></a>import sympy
<a id="__codelineno-100-2" name="__codelineno-100-2"></a><a href="#__codelineno-100-2"><span class="linenos" data-linenos=" 2 "></span></a>import random
<a id="__codelineno-100-3" name="__codelineno-100-3"></a><a href="#__codelineno-100-3"><span class="linenos" data-linenos=" 3 "></span></a>from gmpy2 import gcd, invert
<a id="__codelineno-100-4" name="__codelineno-100-4"></a><a href="#__codelineno-100-4"><span class="linenos" data-linenos=" 4 "></span></a>from Crypto.Util.number import getPrime, isPrime, getRandomNBitInteger, bytes_to_long, long_to_bytes
<a id="__codelineno-100-5" name="__codelineno-100-5"></a><a href="#__codelineno-100-5"><span class="linenos" data-linenos=" 5 "></span></a>from z3 import *
<a id="__codelineno-100-6" name="__codelineno-100-6"></a><a href="#__codelineno-100-6"><span class="linenos" data-linenos=" 6 "></span></a>flag = b&quot;MRCTF{xxxx}&quot;
<a id="__codelineno-100-7" name="__codelineno-100-7"></a><a href="#__codelineno-100-7"><span class="linenos" data-linenos=" 7 "></span></a>base = 65537
<a id="__codelineno-100-8" name="__codelineno-100-8"></a><a href="#__codelineno-100-8"><span class="linenos" data-linenos=" 8 "></span></a>
<a id="__codelineno-100-9" name="__codelineno-100-9"></a><a href="#__codelineno-100-9"><span class="linenos" data-linenos=" 9 "></span></a>
<a id="__codelineno-100-10" name="__codelineno-100-10"></a><a href="#__codelineno-100-10"><span class="linenos" data-linenos="10 "></span></a>def GCD(A):
<a id="__codelineno-100-11" name="__codelineno-100-11"></a><a href="#__codelineno-100-11"><span class="linenos" data-linenos="11 "></span></a>    B = 1
<a id="__codelineno-100-12" name="__codelineno-100-12"></a><a href="#__codelineno-100-12"><span class="linenos" data-linenos="12 "></span></a>    for i in range(1, len(A)):
<a id="__codelineno-100-13" name="__codelineno-100-13"></a><a href="#__codelineno-100-13"><span class="linenos" data-linenos="13 "></span></a>        B = gcd(A[i-1], A[i])
<a id="__codelineno-100-14" name="__codelineno-100-14"></a><a href="#__codelineno-100-14"><span class="linenos" data-linenos="14 "></span></a>    return B
<a id="__codelineno-100-15" name="__codelineno-100-15"></a><a href="#__codelineno-100-15"><span class="linenos" data-linenos="15 "></span></a>
<a id="__codelineno-100-16" name="__codelineno-100-16"></a><a href="#__codelineno-100-16"><span class="linenos" data-linenos="16 "></span></a>
<a id="__codelineno-100-17" name="__codelineno-100-17"></a><a href="#__codelineno-100-17"><span class="linenos" data-linenos="17 "></span></a>def gen_p():
<a id="__codelineno-100-18" name="__codelineno-100-18"></a><a href="#__codelineno-100-18"><span class="linenos" data-linenos="18 "></span></a>    P = [0 for i in range(17)]
<a id="__codelineno-100-19" name="__codelineno-100-19"></a><a href="#__codelineno-100-19"><span class="linenos" data-linenos="19 "></span></a>    P[0] = getPrime(128)
<a id="__codelineno-100-20" name="__codelineno-100-20"></a><a href="#__codelineno-100-20"><span class="linenos" data-linenos="20 "></span></a>    for i in range(1, 17):
<a id="__codelineno-100-21" name="__codelineno-100-21"></a><a href="#__codelineno-100-21"><span class="linenos" data-linenos="21 "></span></a>        P[i] = sympy.nextprime(P[i-1])
<a id="__codelineno-100-22" name="__codelineno-100-22"></a><a href="#__codelineno-100-22"><span class="linenos" data-linenos="22 "></span></a>    print(&quot;P_p :&quot;, P[9])
<a id="__codelineno-100-23" name="__codelineno-100-23"></a><a href="#__codelineno-100-23"><span class="linenos" data-linenos="23 "></span></a>    n = 1
<a id="__codelineno-100-24" name="__codelineno-100-24"></a><a href="#__codelineno-100-24"><span class="linenos" data-linenos="24 "></span></a>    for i in range(17):
<a id="__codelineno-100-25" name="__codelineno-100-25"></a><a href="#__codelineno-100-25"><span class="linenos" data-linenos="25 "></span></a>        n *= P[i]
<a id="__codelineno-100-26" name="__codelineno-100-26"></a><a href="#__codelineno-100-26"><span class="linenos" data-linenos="26 "></span></a>    p = getPrime(1024)
<a id="__codelineno-100-27" name="__codelineno-100-27"></a><a href="#__codelineno-100-27"><span class="linenos" data-linenos="27 "></span></a>    factor = pow(p, base, n)
<a id="__codelineno-100-28" name="__codelineno-100-28"></a><a href="#__codelineno-100-28"><span class="linenos" data-linenos="28 "></span></a>    print(&quot;P_factor :&quot;, factor)
<a id="__codelineno-100-29" name="__codelineno-100-29"></a><a href="#__codelineno-100-29"><span class="linenos" data-linenos="29 "></span></a>    return sympy.nextprime(p)
<a id="__codelineno-100-30" name="__codelineno-100-30"></a><a href="#__codelineno-100-30"><span class="linenos" data-linenos="30 "></span></a>
<a id="__codelineno-100-31" name="__codelineno-100-31"></a><a href="#__codelineno-100-31"><span class="linenos" data-linenos="31 "></span></a>
<a id="__codelineno-100-32" name="__codelineno-100-32"></a><a href="#__codelineno-100-32"><span class="linenos" data-linenos="32 "></span></a>def gen_q():
<a id="__codelineno-100-33" name="__codelineno-100-33"></a><a href="#__codelineno-100-33"><span class="linenos" data-linenos="33 "></span></a>    sub_Q = getPrime(1024)
<a id="__codelineno-100-34" name="__codelineno-100-34"></a><a href="#__codelineno-100-34"><span class="linenos" data-linenos="34 "></span></a>    Q_1 = getPrime(1024)
<a id="__codelineno-100-35" name="__codelineno-100-35"></a><a href="#__codelineno-100-35"><span class="linenos" data-linenos="35 "></span></a>    Q_2 = getPrime(1024)
<a id="__codelineno-100-36" name="__codelineno-100-36"></a><a href="#__codelineno-100-36"><span class="linenos" data-linenos="36 "></span></a>    Q = sub_Q ** Q_2 % Q_1
<a id="__codelineno-100-37" name="__codelineno-100-37"></a><a href="#__codelineno-100-37"><span class="linenos" data-linenos="37 "></span></a>    print(&quot;Q_1: &quot;, Q_1)
<a id="__codelineno-100-38" name="__codelineno-100-38"></a><a href="#__codelineno-100-38"><span class="linenos" data-linenos="38 "></span></a>    print(&quot;Q_2: &quot;, Q_2)
<a id="__codelineno-100-39" name="__codelineno-100-39"></a><a href="#__codelineno-100-39"><span class="linenos" data-linenos="39 "></span></a>    print(&quot;sub_Q: &quot;, sub_Q)
<a id="__codelineno-100-40" name="__codelineno-100-40"></a><a href="#__codelineno-100-40"><span class="linenos" data-linenos="40 "></span></a>    return sympy.nextprime(Q)
<a id="__codelineno-100-41" name="__codelineno-100-41"></a><a href="#__codelineno-100-41"><span class="linenos" data-linenos="41 "></span></a>
<a id="__codelineno-100-42" name="__codelineno-100-42"></a><a href="#__codelineno-100-42"><span class="linenos" data-linenos="42 "></span></a>
<a id="__codelineno-100-43" name="__codelineno-100-43"></a><a href="#__codelineno-100-43"><span class="linenos" data-linenos="43 "></span></a>if __name__ == &quot;__main__&quot;:
<a id="__codelineno-100-44" name="__codelineno-100-44"></a><a href="#__codelineno-100-44"><span class="linenos" data-linenos="44 "></span></a>    _E = base
<a id="__codelineno-100-45" name="__codelineno-100-45"></a><a href="#__codelineno-100-45"><span class="linenos" data-linenos="45 "></span></a>    _P = gen_p()
<a id="__codelineno-100-46" name="__codelineno-100-46"></a><a href="#__codelineno-100-46"><span class="linenos" data-linenos="46 "></span></a>    _Q = gen_q()
<a id="__codelineno-100-47" name="__codelineno-100-47"></a><a href="#__codelineno-100-47"><span class="linenos" data-linenos="47 "></span></a>    assert (gcd(_E, (_P - 1) * (_Q - 1)) == 1)
<a id="__codelineno-100-48" name="__codelineno-100-48"></a><a href="#__codelineno-100-48"><span class="linenos" data-linenos="48 "></span></a>    _M = bytes_to_long(flag)
<a id="__codelineno-100-49" name="__codelineno-100-49"></a><a href="#__codelineno-100-49"><span class="linenos" data-linenos="49 "></span></a>    _C = pow(_M, _E, _P * _Q)
<a id="__codelineno-100-50" name="__codelineno-100-50"></a><a href="#__codelineno-100-50"><span class="linenos" data-linenos="50 "></span></a>    print(&quot;Ciphertext = &quot;, _C)
<a id="__codelineno-100-51" name="__codelineno-100-51"></a><a href="#__codelineno-100-51"><span class="linenos" data-linenos="51 "></span></a>
<a id="__codelineno-100-52" name="__codelineno-100-52"></a><a href="#__codelineno-100-52"><span class="linenos" data-linenos="52 "></span></a>&#39;&#39;&#39;
<a id="__codelineno-100-53" name="__codelineno-100-53"></a><a href="#__codelineno-100-53"><span class="linenos" data-linenos="53 "></span></a>P_p : 206027926847308612719677572554991143421
<a id="__codelineno-100-54" name="__codelineno-100-54"></a><a href="#__codelineno-100-54"><span class="linenos" data-linenos="54 "></span></a>P_factor : 213671742765908980787116579976289600595864704574134469173111790965233629909513884704158446946409910475727584342641848597858942209151114627306286393390259700239698869487469080881267182803062488043469138252786381822646126962323295676431679988602406971858136496624861228526070581338082202663895710929460596143281673761666804565161435963957655012011051936180536581488499059517946308650135300428672486819645279969693519039407892941672784362868653243632727928279698588177694171797254644864554162848696210763681197279758130811723700154618280764123396312330032986093579531909363210692564988076206283296967165522152288770019720928264542910922693728918198338839
<a id="__codelineno-100-55" name="__codelineno-100-55"></a><a href="#__codelineno-100-55"><span class="linenos" data-linenos="55 "></span></a>Q_1:  103766439849465588084625049495793857634556517064563488433148224524638105971161051763127718438062862548184814747601299494052813662851459740127499557785398714481909461631996020048315790167967699932967974484481209879664173009585231469785141628982021847883945871201430155071257803163523612863113967495969578605521
<a id="__codelineno-100-56" name="__codelineno-100-56"></a><a href="#__codelineno-100-56"><span class="linenos" data-linenos="56 "></span></a>Q_2:  151010734276916939790591461278981486442548035032350797306496105136358723586953123484087860176438629843688462671681777513652947555325607414858514566053513243083627810686084890261120641161987614435114887565491866120507844566210561620503961205851409386041194326728437073995372322433035153519757017396063066469743
<a id="__codelineno-100-57" name="__codelineno-100-57"></a><a href="#__codelineno-100-57"><span class="linenos" data-linenos="57 "></span></a>sub_Q:  168992529793593315757895995101430241994953638330919314800130536809801824971112039572562389449584350643924391984800978193707795909956472992631004290479273525116959461856227262232600089176950810729475058260332177626961286009876630340945093629959302803189668904123890991069113826241497783666995751391361028949651
<a id="__codelineno-100-58" name="__codelineno-100-58"></a><a href="#__codelineno-100-58"><span class="linenos" data-linenos="58 "></span></a>Ciphertext =  1709187240516367141460862187749451047644094885791761673574674330840842792189795049968394122216854491757922647656430908587059997070488674220330847871811836724541907666983042376216411561826640060734307013458794925025684062804589439843027290282034999617915124231838524593607080377300985152179828199569474241678651559771763395596697140206072537688129790126472053987391538280007082203006348029125729650207661362371936196789562658458778312533505938858959644541233578654340925901963957980047639114170033936570060250438906130591377904182111622236567507022711176457301476543461600524993045300728432815672077399879668276471832
<a id="__codelineno-100-59" name="__codelineno-100-59"></a><a href="#__codelineno-100-59"><span class="linenos" data-linenos="59 "></span></a>&#39;&#39;&#39;
</code></pre></div>
<hr />
<p>p是连续17个质数的乘积，已经给出第十个<span class="arithmatex">\(p_9\)</span>，易得p的值</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-101-1" name="__codelineno-101-1"></a><a href="#__codelineno-101-1"><span class="linenos" data-linenos=" 1 "></span></a>from gmpy2 import invert
<a id="__codelineno-101-2" name="__codelineno-101-2"></a><a href="#__codelineno-101-2"><span class="linenos" data-linenos=" 2 "></span></a>from Crypto.Util.number import long_to_bytes
<a id="__codelineno-101-3" name="__codelineno-101-3"></a><a href="#__codelineno-101-3"><span class="linenos" data-linenos=" 3 "></span></a>import sympy
<a id="__codelineno-101-4" name="__codelineno-101-4"></a><a href="#__codelineno-101-4"><span class="linenos" data-linenos=" 4 "></span></a>
<a id="__codelineno-101-5" name="__codelineno-101-5"></a><a href="#__codelineno-101-5"><span class="linenos" data-linenos=" 5 "></span></a>P = [0 for i in range(17)]
<a id="__codelineno-101-6" name="__codelineno-101-6"></a><a href="#__codelineno-101-6"><span class="linenos" data-linenos=" 6 "></span></a>P[9] = 206027926847308612719677572554991143421
<a id="__codelineno-101-7" name="__codelineno-101-7"></a><a href="#__codelineno-101-7"><span class="linenos" data-linenos=" 7 "></span></a>for i in range( 8 , -1 , -1 ):
<a id="__codelineno-101-8" name="__codelineno-101-8"></a><a href="#__codelineno-101-8"><span class="linenos" data-linenos=" 8 "></span></a>    P[i] = sympy.prevprime(P[i+1])
<a id="__codelineno-101-9" name="__codelineno-101-9"></a><a href="#__codelineno-101-9"><span class="linenos" data-linenos=" 9 "></span></a>for i in range( 10 , 17 , 1 ):
<a id="__codelineno-101-10" name="__codelineno-101-10"></a><a href="#__codelineno-101-10"><span class="linenos" data-linenos="10 "></span></a>    P[i] = sympy.nextprime(P[i-1])
<a id="__codelineno-101-11" name="__codelineno-101-11"></a><a href="#__codelineno-101-11"><span class="linenos" data-linenos="11 "></span></a>n = 1
<a id="__codelineno-101-12" name="__codelineno-101-12"></a><a href="#__codelineno-101-12"><span class="linenos" data-linenos="12 "></span></a>for i in range( 17 ):
<a id="__codelineno-101-13" name="__codelineno-101-13"></a><a href="#__codelineno-101-13"><span class="linenos" data-linenos="13 "></span></a>    n *= P[i]
<a id="__codelineno-101-14" name="__codelineno-101-14"></a><a href="#__codelineno-101-14"><span class="linenos" data-linenos="14 "></span></a>base = 65537
<a id="__codelineno-101-15" name="__codelineno-101-15"></a><a href="#__codelineno-101-15"><span class="linenos" data-linenos="15 "></span></a>factor = 213671742765908980787116579976289600595864704574134469173111790965233629909513884704158446946409910475727584342641848597858942209151114627306286393390259700239698869487469080881267182803062488043469138252786381822646126962323295676431679988602406971858136496624861228526070581338082202663895710929460596143281673761666804565161435963957655012011051936180536581488499059517946308650135300428672486819645279969693519039407892941672784362868653243632727928279698588177694171797254644864554162848696210763681197279758130811723700154618280764123396312330032986093579531909363210692564988076206283296967165522152288770019720928264542910922693728918198338839
<a id="__codelineno-101-16" name="__codelineno-101-16"></a><a href="#__codelineno-101-16"><span class="linenos" data-linenos="16 "></span></a>
<a id="__codelineno-101-17" name="__codelineno-101-17"></a><a href="#__codelineno-101-17"><span class="linenos" data-linenos="17 "></span></a>phi_n = 1
<a id="__codelineno-101-18" name="__codelineno-101-18"></a><a href="#__codelineno-101-18"><span class="linenos" data-linenos="18 "></span></a>for i in range( 17 ):
<a id="__codelineno-101-19" name="__codelineno-101-19"></a><a href="#__codelineno-101-19"><span class="linenos" data-linenos="19 "></span></a>    phi_n *= ( P[i] - 1 )
<a id="__codelineno-101-20" name="__codelineno-101-20"></a><a href="#__codelineno-101-20"><span class="linenos" data-linenos="20 "></span></a>d = invert( base , phi_n )
<a id="__codelineno-101-21" name="__codelineno-101-21"></a><a href="#__codelineno-101-21"><span class="linenos" data-linenos="21 "></span></a>p = sympy.nextprime( pow( factor , d , n ) )
</code></pre></div>
<p>q由三个数得到，已经给出，故易求出</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-102-1" name="__codelineno-102-1"></a><a href="#__codelineno-102-1"><span class="linenos" data-linenos=" 1 "></span></a>Q_1 = 103766439849465588084625049495793857634556517064563488433148224524638105971161051763127718438062862548184814747601299494052813662851459740127499557785398714481909461631996020048315790167967699932967974484481209879664173009585231469785141628982021847883945871201430155071257803163523612863113967495969578605521
<a id="__codelineno-102-2" name="__codelineno-102-2"></a><a href="#__codelineno-102-2"><span class="linenos" data-linenos=" 2 "></span></a>Q_2 = 151010734276916939790591461278981486442548035032350797306496105136358723586953123484087860176438629843688462671681777513652947555325607414858514566053513243083627810686084890261120641161987614435114887565491866120507844566210561620503961205851409386041194326728437073995372322433035153519757017396063066469743
<a id="__codelineno-102-3" name="__codelineno-102-3"></a><a href="#__codelineno-102-3"><span class="linenos" data-linenos=" 3 "></span></a>sub_Q = 168992529793593315757895995101430241994953638330919314800130536809801824971112039572562389449584350643924391984800978193707795909956472992631004290479273525116959461856227262232600089176950810729475058260332177626961286009876630340945093629959302803189668904123890991069113826241497783666995751391361028949651
<a id="__codelineno-102-4" name="__codelineno-102-4"></a><a href="#__codelineno-102-4"><span class="linenos" data-linenos=" 4 "></span></a>
<a id="__codelineno-102-5" name="__codelineno-102-5"></a><a href="#__codelineno-102-5"><span class="linenos" data-linenos=" 5 "></span></a>q = sympy.nextprime( pow( sub_Q , Q_2 , Q_1 ) )
<a id="__codelineno-102-6" name="__codelineno-102-6"></a><a href="#__codelineno-102-6"><span class="linenos" data-linenos=" 6 "></span></a>
<a id="__codelineno-102-7" name="__codelineno-102-7"></a><a href="#__codelineno-102-7"><span class="linenos" data-linenos=" 7 "></span></a>c = 1709187240516367141460862187749451047644094885791761673574674330840842792189795049968394122216854491757922647656430908587059997070488674220330847871811836724541907666983042376216411561826640060734307013458794925025684062804589439843027290282034999617915124231838524593607080377300985152179828199569474241678651559771763395596697140206072537688129790126472053987391538280007082203006348029125729650207661362371936196789562658458778312533505938858959644541233578654340925901963957980047639114170033936570060250438906130591377904182111622236567507022711176457301476543461600524993045300728432815672077399879668276471832
<a id="__codelineno-102-8" name="__codelineno-102-8"></a><a href="#__codelineno-102-8"><span class="linenos" data-linenos=" 8 "></span></a>
<a id="__codelineno-102-9" name="__codelineno-102-9"></a><a href="#__codelineno-102-9"><span class="linenos" data-linenos=" 9 "></span></a>phi = ( p - 1 ) * ( q - 1 )
<a id="__codelineno-102-10" name="__codelineno-102-10"></a><a href="#__codelineno-102-10"><span class="linenos" data-linenos="10 "></span></a>n = p * q
<a id="__codelineno-102-11" name="__codelineno-102-11"></a><a href="#__codelineno-102-11"><span class="linenos" data-linenos="11 "></span></a>
<a id="__codelineno-102-12" name="__codelineno-102-12"></a><a href="#__codelineno-102-12"><span class="linenos" data-linenos="12 "></span></a>e = base
<a id="__codelineno-102-13" name="__codelineno-102-13"></a><a href="#__codelineno-102-13"><span class="linenos" data-linenos="13 "></span></a>d = invert( e , phi )
<a id="__codelineno-102-14" name="__codelineno-102-14"></a><a href="#__codelineno-102-14"><span class="linenos" data-linenos="14 "></span></a>m = pow( c , d , n )
<a id="__codelineno-102-15" name="__codelineno-102-15"></a><a href="#__codelineno-102-15"><span class="linenos" data-linenos="15 "></span></a>
<a id="__codelineno-102-16" name="__codelineno-102-16"></a><a href="#__codelineno-102-16"><span class="linenos" data-linenos="16 "></span></a>print( long_to_bytes( m ) )
</code></pre></div>
<p>flag:<code>MRCTF{sti11_@_b@by_qu3st10n}</code></p>
<h3 id="mrctf2020easy_rsa">[MRCTF2020]Easy_RSA<a class="headerlink" href="#mrctf2020easy_rsa" title="Permanent link">&para;</a></h3>
<p>tag:RSA | 已知n、phi求p、q |  已知n、e*d求phi</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-103-1" name="__codelineno-103-1"></a><a href="#__codelineno-103-1"><span class="linenos" data-linenos=" 1 "></span></a>import sympy
<a id="__codelineno-103-2" name="__codelineno-103-2"></a><a href="#__codelineno-103-2"><span class="linenos" data-linenos=" 2 "></span></a>from gmpy2 import gcd, invert
<a id="__codelineno-103-3" name="__codelineno-103-3"></a><a href="#__codelineno-103-3"><span class="linenos" data-linenos=" 3 "></span></a>from random import randint
<a id="__codelineno-103-4" name="__codelineno-103-4"></a><a href="#__codelineno-103-4"><span class="linenos" data-linenos=" 4 "></span></a>from Crypto.Util.number import getPrime, isPrime, getRandomNBitInteger, bytes_to_long, long_to_bytes
<a id="__codelineno-103-5" name="__codelineno-103-5"></a><a href="#__codelineno-103-5"><span class="linenos" data-linenos=" 5 "></span></a>import base64
<a id="__codelineno-103-6" name="__codelineno-103-6"></a><a href="#__codelineno-103-6"><span class="linenos" data-linenos=" 6 "></span></a>
<a id="__codelineno-103-7" name="__codelineno-103-7"></a><a href="#__codelineno-103-7"><span class="linenos" data-linenos=" 7 "></span></a>from zlib import *
<a id="__codelineno-103-8" name="__codelineno-103-8"></a><a href="#__codelineno-103-8"><span class="linenos" data-linenos=" 8 "></span></a>flag = b&quot;MRCTF{XXXX}&quot;
<a id="__codelineno-103-9" name="__codelineno-103-9"></a><a href="#__codelineno-103-9"><span class="linenos" data-linenos=" 9 "></span></a>base = 65537
<a id="__codelineno-103-10" name="__codelineno-103-10"></a><a href="#__codelineno-103-10"><span class="linenos" data-linenos="10 "></span></a>
<a id="__codelineno-103-11" name="__codelineno-103-11"></a><a href="#__codelineno-103-11"><span class="linenos" data-linenos="11 "></span></a>def gen_prime(N):
<a id="__codelineno-103-12" name="__codelineno-103-12"></a><a href="#__codelineno-103-12"><span class="linenos" data-linenos="12 "></span></a>    A = 0
<a id="__codelineno-103-13" name="__codelineno-103-13"></a><a href="#__codelineno-103-13"><span class="linenos" data-linenos="13 "></span></a>    while 1:
<a id="__codelineno-103-14" name="__codelineno-103-14"></a><a href="#__codelineno-103-14"><span class="linenos" data-linenos="14 "></span></a>        A = getPrime(N)
<a id="__codelineno-103-15" name="__codelineno-103-15"></a><a href="#__codelineno-103-15"><span class="linenos" data-linenos="15 "></span></a>        if A % 8 == 5:
<a id="__codelineno-103-16" name="__codelineno-103-16"></a><a href="#__codelineno-103-16"><span class="linenos" data-linenos="16 "></span></a>            break
<a id="__codelineno-103-17" name="__codelineno-103-17"></a><a href="#__codelineno-103-17"><span class="linenos" data-linenos="17 "></span></a>    return A
<a id="__codelineno-103-18" name="__codelineno-103-18"></a><a href="#__codelineno-103-18"><span class="linenos" data-linenos="18 "></span></a>
<a id="__codelineno-103-19" name="__codelineno-103-19"></a><a href="#__codelineno-103-19"><span class="linenos" data-linenos="19 "></span></a>def gen_p():
<a id="__codelineno-103-20" name="__codelineno-103-20"></a><a href="#__codelineno-103-20"><span class="linenos" data-linenos="20 "></span></a>    p = getPrime(1024)
<a id="__codelineno-103-21" name="__codelineno-103-21"></a><a href="#__codelineno-103-21"><span class="linenos" data-linenos="21 "></span></a>    q = getPrime(1024)
<a id="__codelineno-103-22" name="__codelineno-103-22"></a><a href="#__codelineno-103-22"><span class="linenos" data-linenos="22 "></span></a>    assert (p &lt; q)
<a id="__codelineno-103-23" name="__codelineno-103-23"></a><a href="#__codelineno-103-23"><span class="linenos" data-linenos="23 "></span></a>    n = p * q
<a id="__codelineno-103-24" name="__codelineno-103-24"></a><a href="#__codelineno-103-24"><span class="linenos" data-linenos="24 "></span></a>    print(&quot;P_n = &quot;, n)
<a id="__codelineno-103-25" name="__codelineno-103-25"></a><a href="#__codelineno-103-25"><span class="linenos" data-linenos="25 "></span></a>    F_n = (p - 1) * (q - 1)
<a id="__codelineno-103-26" name="__codelineno-103-26"></a><a href="#__codelineno-103-26"><span class="linenos" data-linenos="26 "></span></a>    print(&quot;P_F_n = &quot;, F_n)
<a id="__codelineno-103-27" name="__codelineno-103-27"></a><a href="#__codelineno-103-27"><span class="linenos" data-linenos="27 "></span></a>    factor2 = 2021 * p + 2020 * q
<a id="__codelineno-103-28" name="__codelineno-103-28"></a><a href="#__codelineno-103-28"><span class="linenos" data-linenos="28 "></span></a>    if factor2 &lt; 0:
<a id="__codelineno-103-29" name="__codelineno-103-29"></a><a href="#__codelineno-103-29"><span class="linenos" data-linenos="29 "></span></a>        factor2 = (-1) * factor2
<a id="__codelineno-103-30" name="__codelineno-103-30"></a><a href="#__codelineno-103-30"><span class="linenos" data-linenos="30 "></span></a>    return sympy.nextprime(factor2)
<a id="__codelineno-103-31" name="__codelineno-103-31"></a><a href="#__codelineno-103-31"><span class="linenos" data-linenos="31 "></span></a>
<a id="__codelineno-103-32" name="__codelineno-103-32"></a><a href="#__codelineno-103-32"><span class="linenos" data-linenos="32 "></span></a>
<a id="__codelineno-103-33" name="__codelineno-103-33"></a><a href="#__codelineno-103-33"><span class="linenos" data-linenos="33 "></span></a>def gen_q():
<a id="__codelineno-103-34" name="__codelineno-103-34"></a><a href="#__codelineno-103-34"><span class="linenos" data-linenos="34 "></span></a>    p = getPrime(1024)
<a id="__codelineno-103-35" name="__codelineno-103-35"></a><a href="#__codelineno-103-35"><span class="linenos" data-linenos="35 "></span></a>    q = getPrime(1024)
<a id="__codelineno-103-36" name="__codelineno-103-36"></a><a href="#__codelineno-103-36"><span class="linenos" data-linenos="36 "></span></a>    assert (p &lt; q)
<a id="__codelineno-103-37" name="__codelineno-103-37"></a><a href="#__codelineno-103-37"><span class="linenos" data-linenos="37 "></span></a>    n = p * q
<a id="__codelineno-103-38" name="__codelineno-103-38"></a><a href="#__codelineno-103-38"><span class="linenos" data-linenos="38 "></span></a>    print(&quot;Q_n = &quot;, n)
<a id="__codelineno-103-39" name="__codelineno-103-39"></a><a href="#__codelineno-103-39"><span class="linenos" data-linenos="39 "></span></a>    e = getRandomNBitInteger(53)
<a id="__codelineno-103-40" name="__codelineno-103-40"></a><a href="#__codelineno-103-40"><span class="linenos" data-linenos="40 "></span></a>    F_n = (p - 1) * (q - 1)
<a id="__codelineno-103-41" name="__codelineno-103-41"></a><a href="#__codelineno-103-41"><span class="linenos" data-linenos="41 "></span></a>    while gcd(e, F_n) != 1:
<a id="__codelineno-103-42" name="__codelineno-103-42"></a><a href="#__codelineno-103-42"><span class="linenos" data-linenos="42 "></span></a>        e = getRandomNBitInteger(53)
<a id="__codelineno-103-43" name="__codelineno-103-43"></a><a href="#__codelineno-103-43"><span class="linenos" data-linenos="43 "></span></a>    d = invert(e, F_n)
<a id="__codelineno-103-44" name="__codelineno-103-44"></a><a href="#__codelineno-103-44"><span class="linenos" data-linenos="44 "></span></a>    print(&quot;Q_E_D = &quot;, e * d)
<a id="__codelineno-103-45" name="__codelineno-103-45"></a><a href="#__codelineno-103-45"><span class="linenos" data-linenos="45 "></span></a>    factor2 = 2021 * p - 2020 * q
<a id="__codelineno-103-46" name="__codelineno-103-46"></a><a href="#__codelineno-103-46"><span class="linenos" data-linenos="46 "></span></a>    if factor2 &lt; 0:
<a id="__codelineno-103-47" name="__codelineno-103-47"></a><a href="#__codelineno-103-47"><span class="linenos" data-linenos="47 "></span></a>        factor2 = (-1) * factor2
<a id="__codelineno-103-48" name="__codelineno-103-48"></a><a href="#__codelineno-103-48"><span class="linenos" data-linenos="48 "></span></a>    return sympy.nextprime(factor2)
<a id="__codelineno-103-49" name="__codelineno-103-49"></a><a href="#__codelineno-103-49"><span class="linenos" data-linenos="49 "></span></a>
<a id="__codelineno-103-50" name="__codelineno-103-50"></a><a href="#__codelineno-103-50"><span class="linenos" data-linenos="50 "></span></a>
<a id="__codelineno-103-51" name="__codelineno-103-51"></a><a href="#__codelineno-103-51"><span class="linenos" data-linenos="51 "></span></a>if __name__ == &quot;__main__&quot;:
<a id="__codelineno-103-52" name="__codelineno-103-52"></a><a href="#__codelineno-103-52"><span class="linenos" data-linenos="52 "></span></a>    _E = base
<a id="__codelineno-103-53" name="__codelineno-103-53"></a><a href="#__codelineno-103-53"><span class="linenos" data-linenos="53 "></span></a>    _P = gen_p()
<a id="__codelineno-103-54" name="__codelineno-103-54"></a><a href="#__codelineno-103-54"><span class="linenos" data-linenos="54 "></span></a>    _Q = gen_q()
<a id="__codelineno-103-55" name="__codelineno-103-55"></a><a href="#__codelineno-103-55"><span class="linenos" data-linenos="55 "></span></a>    assert (gcd(_E, (_P - 1) * (_Q - 1)) == 1)
<a id="__codelineno-103-56" name="__codelineno-103-56"></a><a href="#__codelineno-103-56"><span class="linenos" data-linenos="56 "></span></a>    _M = bytes_to_long(flag)
<a id="__codelineno-103-57" name="__codelineno-103-57"></a><a href="#__codelineno-103-57"><span class="linenos" data-linenos="57 "></span></a>    _C = pow(_M, _E, _P * _Q)
<a id="__codelineno-103-58" name="__codelineno-103-58"></a><a href="#__codelineno-103-58"><span class="linenos" data-linenos="58 "></span></a>    print(&quot;Ciphertext = &quot;, _C)
<a id="__codelineno-103-59" name="__codelineno-103-59"></a><a href="#__codelineno-103-59"><span class="linenos" data-linenos="59 "></span></a>&#39;&#39;&#39;
<a id="__codelineno-103-60" name="__codelineno-103-60"></a><a href="#__codelineno-103-60"><span class="linenos" data-linenos="60 "></span></a>P_n =  14057332139537395701238463644827948204030576528558543283405966933509944444681257521108769303999679955371474546213196051386802936343092965202519504111238572269823072199039812208100301939365080328518578704076769147484922508482686658959347725753762078590928561862163337382463252361958145933210306431342748775024336556028267742021320891681762543660468484018686865891073110757394154024833552558863671537491089957038648328973790692356014778420333896705595252711514117478072828880198506187667924020260600124717243067420876363980538994101929437978668709128652587073901337310278665778299513763593234951137512120572797739181693
<a id="__codelineno-103-61" name="__codelineno-103-61"></a><a href="#__codelineno-103-61"><span class="linenos" data-linenos="61 "></span></a>P_F_n =  14057332139537395701238463644827948204030576528558543283405966933509944444681257521108769303999679955371474546213196051386802936343092965202519504111238572269823072199039812208100301939365080328518578704076769147484922508482686658959347725753762078590928561862163337382463252361958145933210306431342748775024099427363967321110127562039879018616082926935567951378185280882426903064598376668106616694623540074057210432790309571018778281723710994930151635857933293394780142192586806292968028305922173313521186946635709194350912242693822450297748434301924950358561859804256788098033426537956252964976682327991427626735740
<a id="__codelineno-103-62" name="__codelineno-103-62"></a><a href="#__codelineno-103-62"><span class="linenos" data-linenos="62 "></span></a>Q_n =  20714298338160449749545360743688018842877274054540852096459485283936802341271363766157976112525034004319938054034934880860956966585051684483662535780621673316774842614701726445870630109196016676725183412879870463432277629916669130494040403733295593655306104176367902352484367520262917943100467697540593925707162162616635533550262718808746254599456286578409187895171015796991910123804529825519519278388910483133813330902530160448972926096083990208243274548561238253002789474920730760001104048093295680593033327818821255300893423412192265814418546134015557579236219461780344469127987669565138930308525189944897421753947
<a id="__codelineno-103-63" name="__codelineno-103-63"></a><a href="#__codelineno-103-63"><span class="linenos" data-linenos="63 "></span></a>Q_E_D =  100772079222298134586116156850742817855408127716962891929259868746672572602333918958075582671752493618259518286336122772703330183037221105058298653490794337885098499073583821832532798309513538383175233429533467348390389323225198805294950484802068148590902907221150968539067980432831310376368202773212266320112670699737501054831646286585142281419237572222713975646843555024731855688573834108711874406149540078253774349708158063055754932812675786123700768288048445326199880983717504538825498103789304873682191053050366806825802602658674268440844577955499368404019114913934477160428428662847012289516655310680119638600315228284298935201
<a id="__codelineno-103-64" name="__codelineno-103-64"></a><a href="#__codelineno-103-64"><span class="linenos" data-linenos="64 "></span></a>Ciphertext =  40855937355228438525361161524441274634175356845950884889338630813182607485910094677909779126550263304194796000904384775495000943424070396334435810126536165332565417336797036611773382728344687175253081047586602838685027428292621557914514629024324794275772522013126464926990620140406412999485728750385876868115091735425577555027394033416643032644774339644654011686716639760512353355719065795222201167219831780961308225780478482467294410828543488412258764446494815238766185728454416691898859462532083437213793104823759147317613637881419787581920745151430394526712790608442960106537539121880514269830696341737507717448946962021
<a id="__codelineno-103-65" name="__codelineno-103-65"></a><a href="#__codelineno-103-65"><span class="linenos" data-linenos="65 "></span></a>&#39;&#39;&#39;
</code></pre></div>
<hr />
<p>p的生成是已知n、phi求p、q</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-104-1" name="__codelineno-104-1"></a><a href="#__codelineno-104-1"><span class="linenos" data-linenos="1 "></span></a>pp = ( (P_n-P_F_n+1) + int(gmpy2.iroot( pow(P_n-P_F_n+1,2)-4*P_n,2)[0]) ) // 2
<a id="__codelineno-104-2" name="__codelineno-104-2"></a><a href="#__codelineno-104-2"><span class="linenos" data-linenos="2 "></span></a>pq = ( (P_n-P_F_n+1) - int(gmpy2.iroot( pow(P_n-P_F_n+1,2)-4*P_n,2)[0]) ) // 2
</code></pre></div>
<p>q的生成是已知n、e*d求phi</p>
<p><span class="arithmatex">\(\frac{ed-1}{n} \leq k \leq \frac{ed-1}{2n}\)</span></p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-105-1" name="__codelineno-105-1"></a><a href="#__codelineno-105-1"><span class="linenos" data-linenos="1 "></span></a>k = ( Q_E_D - 1 ) // Q_n + 1
<a id="__codelineno-105-2" name="__codelineno-105-2"></a><a href="#__codelineno-105-2"><span class="linenos" data-linenos="2 "></span></a>Q_F_n = ( Q_E_D - 1 ) // k
</code></pre></div>
<p>完整代码</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-106-1" name="__codelineno-106-1"></a><a href="#__codelineno-106-1"><span class="linenos" data-linenos=" 1 "></span></a>import gmpy2
<a id="__codelineno-106-2" name="__codelineno-106-2"></a><a href="#__codelineno-106-2"><span class="linenos" data-linenos=" 2 "></span></a>from Crypto.Util.number import long_to_bytes
<a id="__codelineno-106-3" name="__codelineno-106-3"></a><a href="#__codelineno-106-3"><span class="linenos" data-linenos=" 3 "></span></a>import sympy
<a id="__codelineno-106-4" name="__codelineno-106-4"></a><a href="#__codelineno-106-4"><span class="linenos" data-linenos=" 4 "></span></a>import math
<a id="__codelineno-106-5" name="__codelineno-106-5"></a><a href="#__codelineno-106-5"><span class="linenos" data-linenos=" 5 "></span></a>
<a id="__codelineno-106-6" name="__codelineno-106-6"></a><a href="#__codelineno-106-6"><span class="linenos" data-linenos=" 6 "></span></a>P_n =  14057332139537395701238463644827948204030576528558543283405966933509944444681257521108769303999679955371474546213196051386802936343092965202519504111238572269823072199039812208100301939365080328518578704076769147484922508482686658959347725753762078590928561862163337382463252361958145933210306431342748775024336556028267742021320891681762543660468484018686865891073110757394154024833552558863671537491089957038648328973790692356014778420333896705595252711514117478072828880198506187667924020260600124717243067420876363980538994101929437978668709128652587073901337310278665778299513763593234951137512120572797739181693
<a id="__codelineno-106-7" name="__codelineno-106-7"></a><a href="#__codelineno-106-7"><span class="linenos" data-linenos=" 7 "></span></a>P_F_n =  14057332139537395701238463644827948204030576528558543283405966933509944444681257521108769303999679955371474546213196051386802936343092965202519504111238572269823072199039812208100301939365080328518578704076769147484922508482686658959347725753762078590928561862163337382463252361958145933210306431342748775024099427363967321110127562039879018616082926935567951378185280882426903064598376668106616694623540074057210432790309571018778281723710994930151635857933293394780142192586806292968028305922173313521186946635709194350912242693822450297748434301924950358561859804256788098033426537956252964976682327991427626735740
<a id="__codelineno-106-8" name="__codelineno-106-8"></a><a href="#__codelineno-106-8"><span class="linenos" data-linenos=" 8 "></span></a>Q_n =  20714298338160449749545360743688018842877274054540852096459485283936802341271363766157976112525034004319938054034934880860956966585051684483662535780621673316774842614701726445870630109196016676725183412879870463432277629916669130494040403733295593655306104176367902352484367520262917943100467697540593925707162162616635533550262718808746254599456286578409187895171015796991910123804529825519519278388910483133813330902530160448972926096083990208243274548561238253002789474920730760001104048093295680593033327818821255300893423412192265814418546134015557579236219461780344469127987669565138930308525189944897421753947
<a id="__codelineno-106-9" name="__codelineno-106-9"></a><a href="#__codelineno-106-9"><span class="linenos" data-linenos=" 9 "></span></a>Q_E_D =  100772079222298134586116156850742817855408127716962891929259868746672572602333918958075582671752493618259518286336122772703330183037221105058298653490794337885098499073583821832532798309513538383175233429533467348390389323225198805294950484802068148590902907221150968539067980432831310376368202773212266320112670699737501054831646286585142281419237572222713975646843555024731855688573834108711874406149540078253774349708158063055754932812675786123700768288048445326199880983717504538825498103789304873682191053050366806825802602658674268440844577955499368404019114913934477160428428662847012289516655310680119638600315228284298935201
<a id="__codelineno-106-10" name="__codelineno-106-10"></a><a href="#__codelineno-106-10"><span class="linenos" data-linenos="10 "></span></a>Ciphertext =  40855937355228438525361161524441274634175356845950884889338630813182607485910094677909779126550263304194796000904384775495000943424070396334435810126536165332565417336797036611773382728344687175253081047586602838685027428292621557914514629024324794275772522013126464926990620140406412999485728750385876868115091735425577555027394033416643032644774339644654011686716639760512353355719065795222201167219831780961308225780478482467294410828543488412258764446494815238766185728454416691898859462532083437213793104823759147317613637881419787581920745151430394526712790608442960106537539121880514269830696341737507717448946962021
<a id="__codelineno-106-11" name="__codelineno-106-11"></a><a href="#__codelineno-106-11"><span class="linenos" data-linenos="11 "></span></a>
<a id="__codelineno-106-12" name="__codelineno-106-12"></a><a href="#__codelineno-106-12"><span class="linenos" data-linenos="12 "></span></a>pp = ( (P_n-P_F_n+1) + int(gmpy2.iroot( pow(P_n-P_F_n+1,2)-4*P_n,2)[0]) ) // 2
<a id="__codelineno-106-13" name="__codelineno-106-13"></a><a href="#__codelineno-106-13"><span class="linenos" data-linenos="13 "></span></a>pq = ( (P_n-P_F_n+1) - int(gmpy2.iroot( pow(P_n-P_F_n+1,2)-4*P_n,2)[0]) ) // 2
<a id="__codelineno-106-14" name="__codelineno-106-14"></a><a href="#__codelineno-106-14"><span class="linenos" data-linenos="14 "></span></a>
<a id="__codelineno-106-15" name="__codelineno-106-15"></a><a href="#__codelineno-106-15"><span class="linenos" data-linenos="15 "></span></a>k = ( Q_E_D - 1 ) // Q_n + 1
<a id="__codelineno-106-16" name="__codelineno-106-16"></a><a href="#__codelineno-106-16"><span class="linenos" data-linenos="16 "></span></a>Q_F_n = ( Q_E_D - 1 ) // k
<a id="__codelineno-106-17" name="__codelineno-106-17"></a><a href="#__codelineno-106-17"><span class="linenos" data-linenos="17 "></span></a>
<a id="__codelineno-106-18" name="__codelineno-106-18"></a><a href="#__codelineno-106-18"><span class="linenos" data-linenos="18 "></span></a>qp = ( (Q_n-Q_F_n+1) + int(gmpy2.iroot( pow(Q_n-Q_F_n+1,2)-4*Q_n,2)[0]) ) // 2
<a id="__codelineno-106-19" name="__codelineno-106-19"></a><a href="#__codelineno-106-19"><span class="linenos" data-linenos="19 "></span></a>qq = ( (Q_n-Q_F_n+1) - int(gmpy2.iroot( pow(Q_n-Q_F_n+1,2)-4*Q_n,2)[0]) ) // 2
<a id="__codelineno-106-20" name="__codelineno-106-20"></a><a href="#__codelineno-106-20"><span class="linenos" data-linenos="20 "></span></a>
<a id="__codelineno-106-21" name="__codelineno-106-21"></a><a href="#__codelineno-106-21"><span class="linenos" data-linenos="21 "></span></a>if pp &gt; pq:
<a id="__codelineno-106-22" name="__codelineno-106-22"></a><a href="#__codelineno-106-22"><span class="linenos" data-linenos="22 "></span></a>    pp , pq = pq , pp
<a id="__codelineno-106-23" name="__codelineno-106-23"></a><a href="#__codelineno-106-23"><span class="linenos" data-linenos="23 "></span></a>if qp &gt; qq:
<a id="__codelineno-106-24" name="__codelineno-106-24"></a><a href="#__codelineno-106-24"><span class="linenos" data-linenos="24 "></span></a>    qp , qq = qq , qp
<a id="__codelineno-106-25" name="__codelineno-106-25"></a><a href="#__codelineno-106-25"><span class="linenos" data-linenos="25 "></span></a>
<a id="__codelineno-106-26" name="__codelineno-106-26"></a><a href="#__codelineno-106-26"><span class="linenos" data-linenos="26 "></span></a>e = 65537
<a id="__codelineno-106-27" name="__codelineno-106-27"></a><a href="#__codelineno-106-27"><span class="linenos" data-linenos="27 "></span></a>p = sympy.nextprime( 2021 * pp + 2020 * pq )
<a id="__codelineno-106-28" name="__codelineno-106-28"></a><a href="#__codelineno-106-28"><span class="linenos" data-linenos="28 "></span></a>q = sympy.nextprime( 2021 * qp - 2020 * qq )
<a id="__codelineno-106-29" name="__codelineno-106-29"></a><a href="#__codelineno-106-29"><span class="linenos" data-linenos="29 "></span></a>
<a id="__codelineno-106-30" name="__codelineno-106-30"></a><a href="#__codelineno-106-30"><span class="linenos" data-linenos="30 "></span></a>c = Ciphertext
<a id="__codelineno-106-31" name="__codelineno-106-31"></a><a href="#__codelineno-106-31"><span class="linenos" data-linenos="31 "></span></a>d = gmpy2.invert( e , (p-1)*(q-1) )
<a id="__codelineno-106-32" name="__codelineno-106-32"></a><a href="#__codelineno-106-32"><span class="linenos" data-linenos="32 "></span></a>print( long_to_bytes( pow( c , d , p*q ) ) )
</code></pre></div>
<p>另一解法：使用factordb对e*d-1进行分解，得到最大的一部分作为phi</p>
<p>flag:<code>MRCTF{Ju3t_@_31mp13_que3t10n}</code></p>
<h3 id="npuctf2020_1">[NPUCTF2020]共 模 攻 击<a class="headerlink" href="#npuctf2020_1" title="Permanent link">&para;</a></h3>
<p>tag: 共膜攻击 | </p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-107-1" name="__codelineno-107-1"></a><a href="#__codelineno-107-1"><span class="linenos" data-linenos=" 1 "></span></a>#task.py
<a id="__codelineno-107-2" name="__codelineno-107-2"></a><a href="#__codelineno-107-2"><span class="linenos" data-linenos=" 2 "></span></a>from gmpy2 import *
<a id="__codelineno-107-3" name="__codelineno-107-3"></a><a href="#__codelineno-107-3"><span class="linenos" data-linenos=" 3 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-107-4" name="__codelineno-107-4"></a><a href="#__codelineno-107-4"><span class="linenos" data-linenos=" 4 "></span></a>from secret import flag
<a id="__codelineno-107-5" name="__codelineno-107-5"></a><a href="#__codelineno-107-5"><span class="linenos" data-linenos=" 5 "></span></a>
<a id="__codelineno-107-6" name="__codelineno-107-6"></a><a href="#__codelineno-107-6"><span class="linenos" data-linenos=" 6 "></span></a>flag = flag.strip(b&quot;npuctf{&quot;).strip(b&quot;}&quot;)
<a id="__codelineno-107-7" name="__codelineno-107-7"></a><a href="#__codelineno-107-7"><span class="linenos" data-linenos=" 7 "></span></a>m = bytes_to_long(flag)
<a id="__codelineno-107-8" name="__codelineno-107-8"></a><a href="#__codelineno-107-8"><span class="linenos" data-linenos=" 8 "></span></a>
<a id="__codelineno-107-9" name="__codelineno-107-9"></a><a href="#__codelineno-107-9"><span class="linenos" data-linenos=" 9 "></span></a>p, q = getPrime(512), getPrime(512)
<a id="__codelineno-107-10" name="__codelineno-107-10"></a><a href="#__codelineno-107-10"><span class="linenos" data-linenos="10 "></span></a>n = p * q
<a id="__codelineno-107-11" name="__codelineno-107-11"></a><a href="#__codelineno-107-11"><span class="linenos" data-linenos="11 "></span></a>e1, e2 = p, q
<a id="__codelineno-107-12" name="__codelineno-107-12"></a><a href="#__codelineno-107-12"><span class="linenos" data-linenos="12 "></span></a>c1, c2 = pow(m, e1, n), pow(m, e2, n)
<a id="__codelineno-107-13" name="__codelineno-107-13"></a><a href="#__codelineno-107-13"><span class="linenos" data-linenos="13 "></span></a>
<a id="__codelineno-107-14" name="__codelineno-107-14"></a><a href="#__codelineno-107-14"><span class="linenos" data-linenos="14 "></span></a>print(n)
<a id="__codelineno-107-15" name="__codelineno-107-15"></a><a href="#__codelineno-107-15"><span class="linenos" data-linenos="15 "></span></a>print(c1)
<a id="__codelineno-107-16" name="__codelineno-107-16"></a><a href="#__codelineno-107-16"><span class="linenos" data-linenos="16 "></span></a>print(c2)
<a id="__codelineno-107-17" name="__codelineno-107-17"></a><a href="#__codelineno-107-17"><span class="linenos" data-linenos="17 "></span></a>
<a id="__codelineno-107-18" name="__codelineno-107-18"></a><a href="#__codelineno-107-18"><span class="linenos" data-linenos="18 "></span></a>&#39;&#39;&#39;
<a id="__codelineno-107-19" name="__codelineno-107-19"></a><a href="#__codelineno-107-19"><span class="linenos" data-linenos="19 "></span></a>128205304743751985889679351195836799434324346996129753896234917982647254577214018524580290192396070591032007818847697193260130051396080104704981594190602854241936777324431673564677900773992273463534717009587530152480725448774018550562603894883079711995434332008363470321069097619786793617099517770260029108149
<a id="__codelineno-107-20" name="__codelineno-107-20"></a><a href="#__codelineno-107-20"><span class="linenos" data-linenos="20 "></span></a>96860654235275202217368130195089839608037558388884522737500611121271571335123981588807994043800468529002147570655597610639680977780779494880330669466389788497046710319213376228391138021976388925171307760030058456934898771589435836261317283743951614505136840364638706914424433566782044926111639955612412134198
<a id="__codelineno-107-21" name="__codelineno-107-21"></a><a href="#__codelineno-107-21"><span class="linenos" data-linenos="21 "></span></a>9566853166416448316408476072940703716510748416699965603380497338943730666656667456274146023583837768495637484138572090891246105018219222267465595710692705776272469703739932909158740030049375350999465338363044226512016686534246611049299981674236577960786526527933966681954486377462298197949323271904405241585
<a id="__codelineno-107-22" name="__codelineno-107-22"></a><a href="#__codelineno-107-22"><span class="linenos" data-linenos="22 "></span></a>&#39;&#39;&#39;
</code></pre></div>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-108-1" name="__codelineno-108-1"></a><a href="#__codelineno-108-1"><span class="linenos" data-linenos=" 1 "></span></a>#hint.py
<a id="__codelineno-108-2" name="__codelineno-108-2"></a><a href="#__codelineno-108-2"><span class="linenos" data-linenos=" 2 "></span></a>from gmpy2 import *
<a id="__codelineno-108-3" name="__codelineno-108-3"></a><a href="#__codelineno-108-3"><span class="linenos" data-linenos=" 3 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-108-4" name="__codelineno-108-4"></a><a href="#__codelineno-108-4"><span class="linenos" data-linenos=" 4 "></span></a>from secret import hint
<a id="__codelineno-108-5" name="__codelineno-108-5"></a><a href="#__codelineno-108-5"><span class="linenos" data-linenos=" 5 "></span></a>
<a id="__codelineno-108-6" name="__codelineno-108-6"></a><a href="#__codelineno-108-6"><span class="linenos" data-linenos=" 6 "></span></a>m = bytes_to_long(hint)
<a id="__codelineno-108-7" name="__codelineno-108-7"></a><a href="#__codelineno-108-7"><span class="linenos" data-linenos=" 7 "></span></a>p = getPrime(256)
<a id="__codelineno-108-8" name="__codelineno-108-8"></a><a href="#__codelineno-108-8"><span class="linenos" data-linenos=" 8 "></span></a>c = pow(m, 256, p)
<a id="__codelineno-108-9" name="__codelineno-108-9"></a><a href="#__codelineno-108-9"><span class="linenos" data-linenos=" 9 "></span></a>print(p)
<a id="__codelineno-108-10" name="__codelineno-108-10"></a><a href="#__codelineno-108-10"><span class="linenos" data-linenos="10 "></span></a>
<a id="__codelineno-108-11" name="__codelineno-108-11"></a><a href="#__codelineno-108-11"><span class="linenos" data-linenos="11 "></span></a>p, q = getPrime(256), getPrime(256)
<a id="__codelineno-108-12" name="__codelineno-108-12"></a><a href="#__codelineno-108-12"><span class="linenos" data-linenos="12 "></span></a>n = p * q
<a id="__codelineno-108-13" name="__codelineno-108-13"></a><a href="#__codelineno-108-13"><span class="linenos" data-linenos="13 "></span></a>e1, e2 = getPrime(32), getPrime(32)
<a id="__codelineno-108-14" name="__codelineno-108-14"></a><a href="#__codelineno-108-14"><span class="linenos" data-linenos="14 "></span></a>c1, c2 = pow(c, e1, n), pow(c, e2, n)
<a id="__codelineno-108-15" name="__codelineno-108-15"></a><a href="#__codelineno-108-15"><span class="linenos" data-linenos="15 "></span></a>print(n)
<a id="__codelineno-108-16" name="__codelineno-108-16"></a><a href="#__codelineno-108-16"><span class="linenos" data-linenos="16 "></span></a>print(e1, c1)
<a id="__codelineno-108-17" name="__codelineno-108-17"></a><a href="#__codelineno-108-17"><span class="linenos" data-linenos="17 "></span></a>print(e2, c2)
<a id="__codelineno-108-18" name="__codelineno-108-18"></a><a href="#__codelineno-108-18"><span class="linenos" data-linenos="18 "></span></a>
<a id="__codelineno-108-19" name="__codelineno-108-19"></a><a href="#__codelineno-108-19"><span class="linenos" data-linenos="19 "></span></a>&#39;&#39;&#39;
<a id="__codelineno-108-20" name="__codelineno-108-20"></a><a href="#__codelineno-108-20"><span class="linenos" data-linenos="20 "></span></a>107316975771284342108362954945096489708900302633734520943905283655283318535709
<a id="__codelineno-108-21" name="__codelineno-108-21"></a><a href="#__codelineno-108-21"><span class="linenos" data-linenos="21 "></span></a>6807492006219935335233722232024809784434293293172317282814978688931711423939629682224374870233587969960713638310068784415474535033780772766171320461281579
<a id="__codelineno-108-22" name="__codelineno-108-22"></a><a href="#__codelineno-108-22"><span class="linenos" data-linenos="22 "></span></a>2303413961 1754421169036191391717309256938035960912941109206872374826444526733030696056821731708193270151759843780894750696642659795452787547355043345348714129217723
<a id="__codelineno-108-23" name="__codelineno-108-23"></a><a href="#__codelineno-108-23"><span class="linenos" data-linenos="23 "></span></a>2622163991 1613454015951555289711148366977297613624544025937559371784736059448454437652633847111272619248126613500028992813732842041018588707201458398726700828844249
<a id="__codelineno-108-24" name="__codelineno-108-24"></a><a href="#__codelineno-108-24"><span class="linenos" data-linenos="24 "></span></a>&#39;&#39;&#39;
</code></pre></div>
<hr />
<p>先解hint.txt，典型的共膜攻击</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-109-1" name="__codelineno-109-1"></a><a href="#__codelineno-109-1"><span class="linenos" data-linenos=" 1 "></span></a>from gmpy2 import*
<a id="__codelineno-109-2" name="__codelineno-109-2"></a><a href="#__codelineno-109-2"><span class="linenos" data-linenos=" 2 "></span></a>from Crypto.Util.number import*
<a id="__codelineno-109-3" name="__codelineno-109-3"></a><a href="#__codelineno-109-3"><span class="linenos" data-linenos=" 3 "></span></a>from sympy import*
<a id="__codelineno-109-4" name="__codelineno-109-4"></a><a href="#__codelineno-109-4"><span class="linenos" data-linenos=" 4 "></span></a>
<a id="__codelineno-109-5" name="__codelineno-109-5"></a><a href="#__codelineno-109-5"><span class="linenos" data-linenos=" 5 "></span></a>p = 107316975771284342108362954945096489708900302633734520943905283655283318535709
<a id="__codelineno-109-6" name="__codelineno-109-6"></a><a href="#__codelineno-109-6"><span class="linenos" data-linenos=" 6 "></span></a>n = 6807492006219935335233722232024809784434293293172317282814978688931711423939629682224374870233587969960713638310068784415474535033780772766171320461281579
<a id="__codelineno-109-7" name="__codelineno-109-7"></a><a href="#__codelineno-109-7"><span class="linenos" data-linenos=" 7 "></span></a>e1 = 2303413961 ; c1 = 1754421169036191391717309256938035960912941109206872374826444526733030696056821731708193270151759843780894750696642659795452787547355043345348714129217723
<a id="__codelineno-109-8" name="__codelineno-109-8"></a><a href="#__codelineno-109-8"><span class="linenos" data-linenos=" 8 "></span></a>e2 = 2622163991 ; c2 = 1613454015951555289711148366977297613624544025937559371784736059448454437652633847111272619248126613500028992813732842041018588707201458398726700828844249
<a id="__codelineno-109-9" name="__codelineno-109-9"></a><a href="#__codelineno-109-9"><span class="linenos" data-linenos=" 9 "></span></a>
<a id="__codelineno-109-10" name="__codelineno-109-10"></a><a href="#__codelineno-109-10"><span class="linenos" data-linenos="10 "></span></a>s = gcdext( e1 , e2 )#拓展欧几里得
<a id="__codelineno-109-11" name="__codelineno-109-11"></a><a href="#__codelineno-109-11"><span class="linenos" data-linenos="11 "></span></a>c = int(powmod( c1 , s[1] , n ) * powmod( c2 , s[2] , n ) % n)
<a id="__codelineno-109-12" name="__codelineno-109-12"></a><a href="#__codelineno-109-12"><span class="linenos" data-linenos="12 "></span></a>
<a id="__codelineno-109-13" name="__codelineno-109-13"></a><a href="#__codelineno-109-13"><span class="linenos" data-linenos="13 "></span></a>print( long_to_bytes( nthroot_mod( c , 256 , p ) ) ) #pow的逆运算（我也不知道为什么能跑，反正确实能跑，而且不慢）
</code></pre></div>
<p>得到hint:<code>m.bit_length() &lt; 400</code></p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-110-1" name="__codelineno-110-1"></a><a href="#__codelineno-110-1"><span class="linenos" data-linenos=" 1 "></span></a>c1=m^p mod n
<a id="__codelineno-110-2" name="__codelineno-110-2"></a><a href="#__codelineno-110-2"><span class="linenos" data-linenos=" 2 "></span></a>c2=m^q mod n
<a id="__codelineno-110-3" name="__codelineno-110-3"></a><a href="#__codelineno-110-3"><span class="linenos" data-linenos=" 3 "></span></a>==&gt;n=p*q
<a id="__codelineno-110-4" name="__codelineno-110-4"></a><a href="#__codelineno-110-4"><span class="linenos" data-linenos=" 4 "></span></a>c1=m^p mod p 
<a id="__codelineno-110-5" name="__codelineno-110-5"></a><a href="#__codelineno-110-5"><span class="linenos" data-linenos=" 5 "></span></a>c2=m^q mod q
<a id="__codelineno-110-6" name="__codelineno-110-6"></a><a href="#__codelineno-110-6"><span class="linenos" data-linenos=" 6 "></span></a>==&gt;由费马小定理可知 a^p=a mod p
<a id="__codelineno-110-7" name="__codelineno-110-7"></a><a href="#__codelineno-110-7"><span class="linenos" data-linenos=" 7 "></span></a>c1=m mod p
<a id="__codelineno-110-8" name="__codelineno-110-8"></a><a href="#__codelineno-110-8"><span class="linenos" data-linenos=" 8 "></span></a>c2=m mod q
<a id="__codelineno-110-9" name="__codelineno-110-9"></a><a href="#__codelineno-110-9"><span class="linenos" data-linenos=" 9 "></span></a>==&gt;c1=m+ip c2=m+jq
<a id="__codelineno-110-10" name="__codelineno-110-10"></a><a href="#__codelineno-110-10"><span class="linenos" data-linenos="10 "></span></a>c1*c2=m^2+(ip+jq)*m+ijn
<a id="__codelineno-110-11" name="__codelineno-110-11"></a><a href="#__codelineno-110-11"><span class="linenos" data-linenos="11 "></span></a>c1+c2=2^m+ip+jq =&gt;(c1+c2)*m=2*m^2+(ip+j1)*m
<a id="__codelineno-110-12" name="__codelineno-110-12"></a><a href="#__codelineno-110-12"><span class="linenos" data-linenos="12 "></span></a>==&gt;m^2-(c1+c2)*m+c1*c2=ijn=0 mod n
</code></pre></div>
<p>使用sage解多项式</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-111-1" name="__codelineno-111-1"></a><a href="#__codelineno-111-1"><span class="linenos" data-linenos="1 "></span></a>#建立环
<a id="__codelineno-111-2" name="__codelineno-111-2"></a><a href="#__codelineno-111-2"><span class="linenos" data-linenos="2 "></span></a>PR.&lt;m&gt; = PolynomialRing(Zmod(n))
<a id="__codelineno-111-3" name="__codelineno-111-3"></a><a href="#__codelineno-111-3"><span class="linenos" data-linenos="3 "></span></a>#定义函数
<a id="__codelineno-111-4" name="__codelineno-111-4"></a><a href="#__codelineno-111-4"><span class="linenos" data-linenos="4 "></span></a>f = m^2-(c1+c2)*m+c1*c2
<a id="__codelineno-111-5" name="__codelineno-111-5"></a><a href="#__codelineno-111-5"><span class="linenos" data-linenos="5 "></span></a>#函数求解
<a id="__codelineno-111-6" name="__codelineno-111-6"></a><a href="#__codelineno-111-6"><span class="linenos" data-linenos="6 "></span></a>x0 = f.small_roots(X=2^400)
<a id="__codelineno-111-7" name="__codelineno-111-7"></a><a href="#__codelineno-111-7"><span class="linenos" data-linenos="7 "></span></a>print(x0)
</code></pre></div>
<p><img alt="" src="asserts\image-20240210211529405.png" />求m，m位数已知，并且c1 = m^p mod n, c2 = m^q mod n</p>
<p>则上限即为解</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-112-1" name="__codelineno-112-1"></a><a href="#__codelineno-112-1"><span class="linenos" data-linenos="1 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-112-2" name="__codelineno-112-2"></a><a href="#__codelineno-112-2"><span class="linenos" data-linenos="2 "></span></a>print(long_to_bytes(4242839043019782000788118887372132807371568279472499477998758466224002905442227156537788110520335652385855))
</code></pre></div>
<p>flag:<code>flag{verrrrrrry_345yyyyyyy_rsaaaaaaa_righttttttt?}</code></p>
<h3 id="xnuca2018warmup">[XNUCA2018]Warmup<a class="headerlink" href="#xnuca2018warmup" title="Permanent link">&para;</a></h3>
<p>tag:共膜攻击 | 流量包分析</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-113-1" name="__codelineno-113-1"></a><a href="#__codelineno-113-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import bytes_to_long, getPrime
<a id="__codelineno-113-2" name="__codelineno-113-2"></a><a href="#__codelineno-113-2"><span class="linenos" data-linenos=" 2 "></span></a>from random import randint
<a id="__codelineno-113-3" name="__codelineno-113-3"></a><a href="#__codelineno-113-3"><span class="linenos" data-linenos=" 3 "></span></a>from gmpy2 import powmod
<a id="__codelineno-113-4" name="__codelineno-113-4"></a><a href="#__codelineno-113-4"><span class="linenos" data-linenos=" 4 "></span></a>import sys
<a id="__codelineno-113-5" name="__codelineno-113-5"></a><a href="#__codelineno-113-5"><span class="linenos" data-linenos=" 5 "></span></a>
<a id="__codelineno-113-6" name="__codelineno-113-6"></a><a href="#__codelineno-113-6"><span class="linenos" data-linenos=" 6 "></span></a>p = getPrime(1024)
<a id="__codelineno-113-7" name="__codelineno-113-7"></a><a href="#__codelineno-113-7"><span class="linenos" data-linenos=" 7 "></span></a>q = getPrime(1024)
<a id="__codelineno-113-8" name="__codelineno-113-8"></a><a href="#__codelineno-113-8"><span class="linenos" data-linenos=" 8 "></span></a>N = p*q
<a id="__codelineno-113-9" name="__codelineno-113-9"></a><a href="#__codelineno-113-9"><span class="linenos" data-linenos=" 9 "></span></a>Phi = (p-1)*(q-1)
<a id="__codelineno-113-10" name="__codelineno-113-10"></a><a href="#__codelineno-113-10"><span class="linenos" data-linenos="10 "></span></a>
<a id="__codelineno-113-11" name="__codelineno-113-11"></a><a href="#__codelineno-113-11"><span class="linenos" data-linenos="11 "></span></a>with open(&quot;flag&quot;, &#39;r&#39;) as fr:
<a id="__codelineno-113-12" name="__codelineno-113-12"></a><a href="#__codelineno-113-12"><span class="linenos" data-linenos="12 "></span></a>    flag = bytes_to_long(fr.read().strip())
<a id="__codelineno-113-13" name="__codelineno-113-13"></a><a href="#__codelineno-113-13"><span class="linenos" data-linenos="13 "></span></a>
<a id="__codelineno-113-14" name="__codelineno-113-14"></a><a href="#__codelineno-113-14"><span class="linenos" data-linenos="14 "></span></a>def get_enc_key(BitLen, Phi):
<a id="__codelineno-113-15" name="__codelineno-113-15"></a><a href="#__codelineno-113-15"><span class="linenos" data-linenos="15 "></span></a>    e = getPrime(BitLen)
<a id="__codelineno-113-16" name="__codelineno-113-16"></a><a href="#__codelineno-113-16"><span class="linenos" data-linenos="16 "></span></a>    if Phi % e == 0:
<a id="__codelineno-113-17" name="__codelineno-113-17"></a><a href="#__codelineno-113-17"><span class="linenos" data-linenos="17 "></span></a>        return get_enc_key(BitLen, Phi)
<a id="__codelineno-113-18" name="__codelineno-113-18"></a><a href="#__codelineno-113-18"><span class="linenos" data-linenos="18 "></span></a>    else:
<a id="__codelineno-113-19" name="__codelineno-113-19"></a><a href="#__codelineno-113-19"><span class="linenos" data-linenos="19 "></span></a>        return e
<a id="__codelineno-113-20" name="__codelineno-113-20"></a><a href="#__codelineno-113-20"><span class="linenos" data-linenos="20 "></span></a>
<a id="__codelineno-113-21" name="__codelineno-113-21"></a><a href="#__codelineno-113-21"><span class="linenos" data-linenos="21 "></span></a>def sprint(message):
<a id="__codelineno-113-22" name="__codelineno-113-22"></a><a href="#__codelineno-113-22"><span class="linenos" data-linenos="22 "></span></a>    print(message)
<a id="__codelineno-113-23" name="__codelineno-113-23"></a><a href="#__codelineno-113-23"><span class="linenos" data-linenos="23 "></span></a>    sys.stdout.flush()
<a id="__codelineno-113-24" name="__codelineno-113-24"></a><a href="#__codelineno-113-24"><span class="linenos" data-linenos="24 "></span></a>
<a id="__codelineno-113-25" name="__codelineno-113-25"></a><a href="#__codelineno-113-25"><span class="linenos" data-linenos="25 "></span></a>def communicate():
<a id="__codelineno-113-26" name="__codelineno-113-26"></a><a href="#__codelineno-113-26"><span class="linenos" data-linenos="26 "></span></a>    sprint(&quot;This is a message distribute system.Please tell me your name: &quot;)
<a id="__codelineno-113-27" name="__codelineno-113-27"></a><a href="#__codelineno-113-27"><span class="linenos" data-linenos="27 "></span></a>    user = raw_input()
<a id="__codelineno-113-28" name="__codelineno-113-28"></a><a href="#__codelineno-113-28"><span class="linenos" data-linenos="28 "></span></a>    bakcdoor(user)
<a id="__codelineno-113-29" name="__codelineno-113-29"></a><a href="#__codelineno-113-29"><span class="linenos" data-linenos="29 "></span></a>    e = get_enc_key(randint(13, 13 + (len(user) % 4)), Phi)
<a id="__codelineno-113-30" name="__codelineno-113-30"></a><a href="#__codelineno-113-30"><span class="linenos" data-linenos="30 "></span></a>    ct = powmod(flag, e, N)
<a id="__codelineno-113-31" name="__codelineno-113-31"></a><a href="#__codelineno-113-31"><span class="linenos" data-linenos="31 "></span></a>    sprint(&quot;Hi %s, your N is: %d\nAnd your exponent is: %d\nLast but not least, your secret is: %d&quot; % (user, N, e, ct))
<a id="__codelineno-113-32" name="__codelineno-113-32"></a><a href="#__codelineno-113-32"><span class="linenos" data-linenos="32 "></span></a>    sprint(&quot;You will know the secret after I give you P,Q.\nSee you next time!&quot;)
<a id="__codelineno-113-33" name="__codelineno-113-33"></a><a href="#__codelineno-113-33"><span class="linenos" data-linenos="33 "></span></a>
<a id="__codelineno-113-34" name="__codelineno-113-34"></a><a href="#__codelineno-113-34"><span class="linenos" data-linenos="34 "></span></a>if __name__ == &quot;__main__&quot;:
<a id="__codelineno-113-35" name="__codelineno-113-35"></a><a href="#__codelineno-113-35"><span class="linenos" data-linenos="35 "></span></a>    communicate()
</code></pre></div>
<p>和一个流量包</p>
<hr />
<p><img src="asserts\image-20240210214406625.png" alt="image-20240210214406625" style="zoom:50%;" /></p>
<p>找到六个有大量数字的包，提取主要数据</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-114-1" name="__codelineno-114-1"></a><a href="#__codelineno-114-1"><span class="linenos" data-linenos="1 "></span></a>n=25118186052801903419891574512806521370646053661385577314262283167479853375867074736882903917202574957661470179148882538361560784362740207649620536746860883395110443930778132343642295247749797041449601967434690280754279589691669366595486824752597992245067619256368446164574344449914827664991591873150416287647528776014468498025993455819767004213726389160036077170973994848480739499052481386539293425983093644799960322581437734560001018025823047877932105216362961838959964371333287407071080250979421489210165485908404019927393053325809061787560294489911475978342741920115134298253806238766543518220987363050115050813263
<a id="__codelineno-114-2" name="__codelineno-114-2"></a><a href="#__codelineno-114-2"><span class="linenos" data-linenos="2 "></span></a>e1=7669
<a id="__codelineno-114-3" name="__codelineno-114-3"></a><a href="#__codelineno-114-3"><span class="linenos" data-linenos="3 "></span></a>c1=22917655888781915689291442748409371798632133107968171254672911561608350738343707972881819762532175014157796940212073777351362314385074785400758102594348355578275080626269137543136225022579321107199602856290254696227966436244618441350564667872879196269074433751811632437228139470723203848006803856868237706401868436321225656126491701750534688966280578771996021459620472731406728379628286405214996461164892486734170662556518782043881759918394674517409304629842710180023814702447187081112856416034885511215626693534876901484105593275741829434329109239483368867518384522955176807332437540578688867077569728548513876841471
<a id="__codelineno-114-4" name="__codelineno-114-4"></a><a href="#__codelineno-114-4"><span class="linenos" data-linenos="4 "></span></a>e2=6947
<a id="__codelineno-114-5" name="__codelineno-114-5"></a><a href="#__codelineno-114-5"><span class="linenos" data-linenos="5 "></span></a>c2=20494665879116666159961016125949070097530413770391893858215547229071116025581822729798313796823204861624912909030975450742122802775879194445232064367771036011021366123393917354134849911675307877324103834871288513274457941036453477034798647182106422619504345055259543675752998330786906376830335403339610903547255965127196315113331300512641046933227008101401416026809256813221480604662012101542846479052832128788279031727880750642499329041780372405567816904384164559191879422615238580181357183882111249939492668328771614509476229785062819586796660370798030562805224704497570446844131650030075004901216141893420140140568
</code></pre></div>
<p>发现n相同</p>
<p>——共膜攻击！</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-115-1" name="__codelineno-115-1"></a><a href="#__codelineno-115-1"><span class="linenos" data-linenos="1 "></span></a>from gmpy2 import*
<a id="__codelineno-115-2" name="__codelineno-115-2"></a><a href="#__codelineno-115-2"><span class="linenos" data-linenos="2 "></span></a>from Crypto.Util.number import*
<a id="__codelineno-115-3" name="__codelineno-115-3"></a><a href="#__codelineno-115-3"><span class="linenos" data-linenos="3 "></span></a>from sympy import*
<a id="__codelineno-115-4" name="__codelineno-115-4"></a><a href="#__codelineno-115-4"><span class="linenos" data-linenos="4 "></span></a>
<a id="__codelineno-115-5" name="__codelineno-115-5"></a><a href="#__codelineno-115-5"><span class="linenos" data-linenos="5 "></span></a>s = gcdext( e1 , e2 )#拓展欧几里得
<a id="__codelineno-115-6" name="__codelineno-115-6"></a><a href="#__codelineno-115-6"><span class="linenos" data-linenos="6 "></span></a>c = int(powmod( c1 , s[1] , n ) * powmod( c2 , s[2] , n ) % n)
<a id="__codelineno-115-7" name="__codelineno-115-7"></a><a href="#__codelineno-115-7"><span class="linenos" data-linenos="7 "></span></a>
<a id="__codelineno-115-8" name="__codelineno-115-8"></a><a href="#__codelineno-115-8"><span class="linenos" data-linenos="8 "></span></a>print( long_to_bytes( c ) ) #pow的逆运算（我也不知道为什么能跑，反正确实能跑，而且不慢）
</code></pre></div>
<p>flag嘎嘣一下子就出来了</p>
<p>flag:<code>FLAG{g00d_Luck_&amp;_Hav3_Fun}</code></p>
<h3 id="afctf2018">[#AFCTF2018]花开藏宝地<a class="headerlink" href="#afctf2018" title="Permanent link">&para;</a></h3>
<p>tag:</p>
<p><img alt="" src="asserts\image-20240211150300214.png" /></p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-116-1" name="__codelineno-116-1"></a><a href="#__codelineno-116-1"><span class="linenos" data-linenos=" 1 "></span></a>第80804238007977405688648566160504278593148666302626415149704905628622876270862865768337953835725801963142685182510812938072115996355782396318303927020705623120652014080032809421180400984242061592520733710243483947230962631945045134540159517488288781666622635328316972979183761952842010806304748313326215619695085380586052550443025074501971925005072999275628549710915357400946408857号藏宝图
<a id="__codelineno-116-2" name="__codelineno-116-2"></a><a href="#__codelineno-116-2"><span class="linenos" data-linenos=" 2 "></span></a>
<a id="__codelineno-116-3" name="__codelineno-116-3"></a><a href="#__codelineno-116-3"><span class="linenos" data-linenos=" 3 "></span></a>我把我的宝藏都藏在了那里！
<a id="__codelineno-116-4" name="__codelineno-116-4"></a><a href="#__codelineno-116-4"><span class="linenos" data-linenos=" 4 "></span></a>那个神秘的地方！
<a id="__codelineno-116-5" name="__codelineno-116-5"></a><a href="#__codelineno-116-5"><span class="linenos" data-linenos=" 5 "></span></a>于是我把藏宝图分成了5份，交给五位贤者让他们帮我妥善保管，并且只要搜集3份就可以获得宝藏的地址。
<a id="__codelineno-116-6" name="__codelineno-116-6"></a><a href="#__codelineno-116-6"><span class="linenos" data-linenos=" 6 "></span></a>
<a id="__codelineno-116-7" name="__codelineno-116-7"></a><a href="#__codelineno-116-7"><span class="linenos" data-linenos=" 7 "></span></a>第一位贤者将藏宝图放进时空门中说道：
<a id="__codelineno-116-8" name="__codelineno-116-8"></a><a href="#__codelineno-116-8"><span class="linenos" data-linenos=" 8 "></span></a>“那么口令就是我的生日吧，那可是个好数字呢。”
<a id="__codelineno-116-9" name="__codelineno-116-9"></a><a href="#__codelineno-116-9"><span class="linenos" data-linenos=" 9 "></span></a>
<a id="__codelineno-116-10" name="__codelineno-116-10"></a><a href="#__codelineno-116-10"><span class="linenos" data-linenos="10 "></span></a>第二位贤者将藏宝图放进宝箱，【小】声念着自己的名字锁上了宝箱。
<a id="__codelineno-116-11" name="__codelineno-116-11"></a><a href="#__codelineno-116-11"><span class="linenos" data-linenos="11 "></span></a>
<a id="__codelineno-116-12" name="__codelineno-116-12"></a><a href="#__codelineno-116-12"><span class="linenos" data-linenos="12 "></span></a>第三位贤者将藏宝图施上咒语丢进大海：“只要【大】声喊出那句咒语就可以把水驱逐！”
<a id="__codelineno-116-13" name="__codelineno-116-13"></a><a href="#__codelineno-116-13"><span class="linenos" data-linenos="13 "></span></a>
<a id="__codelineno-116-14" name="__codelineno-116-14"></a><a href="#__codelineno-116-14"><span class="linenos" data-linenos="14 "></span></a>第四位贤者找了个破锁锁上了宝箱，狡黠地笑着：“谁知道它是坏的呢？”
<a id="__codelineno-116-15" name="__codelineno-116-15"></a><a href="#__codelineno-116-15"><span class="linenos" data-linenos="15 "></span></a>
<a id="__codelineno-116-16" name="__codelineno-116-16"></a><a href="#__codelineno-116-16"><span class="linenos" data-linenos="16 "></span></a>第五位贤者给藏宝图裹上了隐身衣，放入了一个匣子里
<a id="__codelineno-116-17" name="__codelineno-116-17"></a><a href="#__codelineno-116-17"><span class="linenos" data-linenos="17 "></span></a>
<a id="__codelineno-116-18" name="__codelineno-116-18"></a><a href="#__codelineno-116-18"><span class="linenos" data-linenos="18 "></span></a>据说，只有拥有【智慧】与【力量】就可以获得宝藏了呢！~
<a id="__codelineno-116-19" name="__codelineno-116-19"></a><a href="#__codelineno-116-19"><span class="linenos" data-linenos="19 "></span></a>你是这样的勇者吗？
</code></pre></div>
<hr />
<p>除了第五个压缩包，剩下四个压缩包被加密了</p>
<p>点开txt，发现有一串很奇怪的数字</p>
<p>这是什么，好奇怪，转一下</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-117-1" name="__codelineno-117-1"></a><a href="#__codelineno-117-1"><span class="linenos" data-linenos="1 "></span></a>from sympy import*
<a id="__codelineno-117-2" name="__codelineno-117-2"></a><a href="#__codelineno-117-2"><span class="linenos" data-linenos="2 "></span></a>
<a id="__codelineno-117-3" name="__codelineno-117-3"></a><a href="#__codelineno-117-3"><span class="linenos" data-linenos="3 "></span></a>txt = 80804238007977405688648566160504278593148666302626415149704905628622876270862865768337953835725801963142685182510812938072115996355782396318303927020705623120652014080032809421180400984242061592520733710243483947230962631945045134540159517488288781666622635328316972979183761952842010806304748313326215619695085380586052550443025074501971925005072999275628549710915357400946408857
<a id="__codelineno-117-4" name="__codelineno-117-4"></a><a href="#__codelineno-117-4"><span class="linenos" data-linenos="4 "></span></a>
<a id="__codelineno-117-5" name="__codelineno-117-5"></a><a href="#__codelineno-117-5"><span class="linenos" data-linenos="5 "></span></a>print( long_to_bytes( txt ) )
</code></pre></div>
<p>得到一个像是flag的东西</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-118-1" name="__codelineno-118-1"></a><a href="#__codelineno-118-1"><span class="linenos" data-linenos="1 "></span></a>b&quot;A treasure map is a map that marks the location of buried treasure, a lost mine, a valuable secret or a hidden locale.So flag is afctf{1sn&#39;t_s0_int3Resting}\x99&quot;
</code></pre></div>
<p>交一下？对了？？？</p>
<p>那压缩包·······</p>
<h3 id="rsa-what_1">RSA &amp; what<a class="headerlink" href="#rsa-what_1" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-119-1" name="__codelineno-119-1"></a><a href="#__codelineno-119-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import bytes_to_long, getPrime
<a id="__codelineno-119-2" name="__codelineno-119-2"></a><a href="#__codelineno-119-2"><span class="linenos" data-linenos=" 2 "></span></a>from random import randint
<a id="__codelineno-119-3" name="__codelineno-119-3"></a><a href="#__codelineno-119-3"><span class="linenos" data-linenos=" 3 "></span></a>from gmpy2 import powmod
<a id="__codelineno-119-4" name="__codelineno-119-4"></a><a href="#__codelineno-119-4"><span class="linenos" data-linenos=" 4 "></span></a>
<a id="__codelineno-119-5" name="__codelineno-119-5"></a><a href="#__codelineno-119-5"><span class="linenos" data-linenos=" 5 "></span></a>p = getPrime(2048)
<a id="__codelineno-119-6" name="__codelineno-119-6"></a><a href="#__codelineno-119-6"><span class="linenos" data-linenos=" 6 "></span></a>q = getPrime(2048)
<a id="__codelineno-119-7" name="__codelineno-119-7"></a><a href="#__codelineno-119-7"><span class="linenos" data-linenos=" 7 "></span></a>N = p*q
<a id="__codelineno-119-8" name="__codelineno-119-8"></a><a href="#__codelineno-119-8"><span class="linenos" data-linenos=" 8 "></span></a>Phi = (p-1)*(q-1)
<a id="__codelineno-119-9" name="__codelineno-119-9"></a><a href="#__codelineno-119-9"><span class="linenos" data-linenos=" 9 "></span></a>def get_enc_key(N,Phi):
<a id="__codelineno-119-10" name="__codelineno-119-10"></a><a href="#__codelineno-119-10"><span class="linenos" data-linenos="10 "></span></a>    e = getPrime(N)
<a id="__codelineno-119-11" name="__codelineno-119-11"></a><a href="#__codelineno-119-11"><span class="linenos" data-linenos="11 "></span></a>    if Phi % e == 0:
<a id="__codelineno-119-12" name="__codelineno-119-12"></a><a href="#__codelineno-119-12"><span class="linenos" data-linenos="12 "></span></a>        return get_enc_key(N, Phi)
<a id="__codelineno-119-13" name="__codelineno-119-13"></a><a href="#__codelineno-119-13"><span class="linenos" data-linenos="13 "></span></a>    else:
<a id="__codelineno-119-14" name="__codelineno-119-14"></a><a href="#__codelineno-119-14"><span class="linenos" data-linenos="14 "></span></a>        return e
<a id="__codelineno-119-15" name="__codelineno-119-15"></a><a href="#__codelineno-119-15"><span class="linenos" data-linenos="15 "></span></a>e1 = get_enc_key(randint(10, 12), Phi)
<a id="__codelineno-119-16" name="__codelineno-119-16"></a><a href="#__codelineno-119-16"><span class="linenos" data-linenos="16 "></span></a>e2 = get_enc_key(randint(10, 12), Phi)
<a id="__codelineno-119-17" name="__codelineno-119-17"></a><a href="#__codelineno-119-17"><span class="linenos" data-linenos="17 "></span></a>
<a id="__codelineno-119-18" name="__codelineno-119-18"></a><a href="#__codelineno-119-18"><span class="linenos" data-linenos="18 "></span></a>fr = open(r&quot;./base64&quot;, &quot;rb&quot;)#flag is in this file
<a id="__codelineno-119-19" name="__codelineno-119-19"></a><a href="#__codelineno-119-19"><span class="linenos" data-linenos="19 "></span></a>f1 = open(r&quot;./HUB1&quot;, &quot;wb&quot;)
<a id="__codelineno-119-20" name="__codelineno-119-20"></a><a href="#__codelineno-119-20"><span class="linenos" data-linenos="20 "></span></a>f2 = open(r&quot;./HUB2&quot;, &quot;wb&quot;)
<a id="__codelineno-119-21" name="__codelineno-119-21"></a><a href="#__codelineno-119-21"><span class="linenos" data-linenos="21 "></span></a>base64 = fr.read(255)
<a id="__codelineno-119-22" name="__codelineno-119-22"></a><a href="#__codelineno-119-22"><span class="linenos" data-linenos="22 "></span></a>f1.write(&quot;%d\n%d\n&quot; % (N, e1))
<a id="__codelineno-119-23" name="__codelineno-119-23"></a><a href="#__codelineno-119-23"><span class="linenos" data-linenos="23 "></span></a>f2.write(&quot;%d\n%d\n&quot; % (N, e2))
<a id="__codelineno-119-24" name="__codelineno-119-24"></a><a href="#__codelineno-119-24"><span class="linenos" data-linenos="24 "></span></a>while len(base64)&gt;0:
<a id="__codelineno-119-25" name="__codelineno-119-25"></a><a href="#__codelineno-119-25"><span class="linenos" data-linenos="25 "></span></a>    pt = bytes_to_long(base64)
<a id="__codelineno-119-26" name="__codelineno-119-26"></a><a href="#__codelineno-119-26"><span class="linenos" data-linenos="26 "></span></a>    ct1 = powmod(pt, e1, N)
<a id="__codelineno-119-27" name="__codelineno-119-27"></a><a href="#__codelineno-119-27"><span class="linenos" data-linenos="27 "></span></a>    ct2 = powmod(pt, e2, N)
<a id="__codelineno-119-28" name="__codelineno-119-28"></a><a href="#__codelineno-119-28"><span class="linenos" data-linenos="28 "></span></a>    f1.write(&quot;\n%d&quot; % ct1)
<a id="__codelineno-119-29" name="__codelineno-119-29"></a><a href="#__codelineno-119-29"><span class="linenos" data-linenos="29 "></span></a>    f2.write(&quot;\n%d&quot; % ct2)
<a id="__codelineno-119-30" name="__codelineno-119-30"></a><a href="#__codelineno-119-30"><span class="linenos" data-linenos="30 "></span></a>    base64 = fr.read(255)
<a id="__codelineno-119-31" name="__codelineno-119-31"></a><a href="#__codelineno-119-31"><span class="linenos" data-linenos="31 "></span></a>fr.close()
<a id="__codelineno-119-32" name="__codelineno-119-32"></a><a href="#__codelineno-119-32"><span class="linenos" data-linenos="32 "></span></a>f1.close()
<a id="__codelineno-119-33" name="__codelineno-119-33"></a><a href="#__codelineno-119-33"><span class="linenos" data-linenos="33 "></span></a>f2.close()
</code></pre></div>
<hr />
<p>共膜攻击</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-120-1" name="__codelineno-120-1"></a><a href="#__codelineno-120-1"><span class="linenos" data-linenos=" 1 "></span></a>from Crypto.Util.number import *
<a id="__codelineno-120-2" name="__codelineno-120-2"></a><a href="#__codelineno-120-2"><span class="linenos" data-linenos=" 2 "></span></a>import base64
<a id="__codelineno-120-3" name="__codelineno-120-3"></a><a href="#__codelineno-120-3"><span class="linenos" data-linenos=" 3 "></span></a>
<a id="__codelineno-120-4" name="__codelineno-120-4"></a><a href="#__codelineno-120-4"><span class="linenos" data-linenos=" 4 "></span></a>def exgcd( a , b ):
<a id="__codelineno-120-5" name="__codelineno-120-5"></a><a href="#__codelineno-120-5"><span class="linenos" data-linenos=" 5 "></span></a>    if a == 0:
<a id="__codelineno-120-6" name="__codelineno-120-6"></a><a href="#__codelineno-120-6"><span class="linenos" data-linenos=" 6 "></span></a>        return ( b , 0 , 1 )
<a id="__codelineno-120-7" name="__codelineno-120-7"></a><a href="#__codelineno-120-7"><span class="linenos" data-linenos=" 7 "></span></a>    else:
<a id="__codelineno-120-8" name="__codelineno-120-8"></a><a href="#__codelineno-120-8"><span class="linenos" data-linenos=" 8 "></span></a>        g , y , x = exgcd( b % a , a )  
<a id="__codelineno-120-9" name="__codelineno-120-9"></a><a href="#__codelineno-120-9"><span class="linenos" data-linenos=" 9 "></span></a>        return ( g , x - (b//a)*y , y )
<a id="__codelineno-120-10" name="__codelineno-120-10"></a><a href="#__codelineno-120-10"><span class="linenos" data-linenos="10 "></span></a>
<a id="__codelineno-120-11" name="__codelineno-120-11"></a><a href="#__codelineno-120-11"><span class="linenos" data-linenos="11 "></span></a>def CMA( n , e1 , e2 , c1 , c2 ):
<a id="__codelineno-120-12" name="__codelineno-120-12"></a><a href="#__codelineno-120-12"><span class="linenos" data-linenos="12 "></span></a>    temp , s1 , s2 = exgcd( e1 , e2 )
<a id="__codelineno-120-13" name="__codelineno-120-13"></a><a href="#__codelineno-120-13"><span class="linenos" data-linenos="13 "></span></a>    if s1 &lt; 0:
<a id="__codelineno-120-14" name="__codelineno-120-14"></a><a href="#__codelineno-120-14"><span class="linenos" data-linenos="14 "></span></a>        s1 = -s1
<a id="__codelineno-120-15" name="__codelineno-120-15"></a><a href="#__codelineno-120-15"><span class="linenos" data-linenos="15 "></span></a>        c1 = inverse( c1 , n )
<a id="__codelineno-120-16" name="__codelineno-120-16"></a><a href="#__codelineno-120-16"><span class="linenos" data-linenos="16 "></span></a>    elif s2 &lt; 0:
<a id="__codelineno-120-17" name="__codelineno-120-17"></a><a href="#__codelineno-120-17"><span class="linenos" data-linenos="17 "></span></a>        s2 = -s2
<a id="__codelineno-120-18" name="__codelineno-120-18"></a><a href="#__codelineno-120-18"><span class="linenos" data-linenos="18 "></span></a>        c2 = inverse( c2 , n )
<a id="__codelineno-120-19" name="__codelineno-120-19"></a><a href="#__codelineno-120-19"><span class="linenos" data-linenos="19 "></span></a>    m = pow( c1 , s1 , n ) * pow( c2 , s2 , n ) % n
<a id="__codelineno-120-20" name="__codelineno-120-20"></a><a href="#__codelineno-120-20"><span class="linenos" data-linenos="20 "></span></a>    return m
<a id="__codelineno-120-21" name="__codelineno-120-21"></a><a href="#__codelineno-120-21"><span class="linenos" data-linenos="21 "></span></a>
<a id="__codelineno-120-22" name="__codelineno-120-22"></a><a href="#__codelineno-120-22"><span class="linenos" data-linenos="22 "></span></a>f1 = open(&quot;HUB1&quot;) ; f2 = open(&quot;HUB2&quot;)
<a id="__codelineno-120-23" name="__codelineno-120-23"></a><a href="#__codelineno-120-23"><span class="linenos" data-linenos="23 "></span></a>
<a id="__codelineno-120-24" name="__codelineno-120-24"></a><a href="#__codelineno-120-24"><span class="linenos" data-linenos="24 "></span></a>N , N = f1.readline() , f2.readline()
<a id="__codelineno-120-25" name="__codelineno-120-25"></a><a href="#__codelineno-120-25"><span class="linenos" data-linenos="25 "></span></a>e1,e2 = f1.readline() , f2.readline()
<a id="__codelineno-120-26" name="__codelineno-120-26"></a><a href="#__codelineno-120-26"><span class="linenos" data-linenos="26 "></span></a>f1.readline() ; f2.readline()
<a id="__codelineno-120-27" name="__codelineno-120-27"></a><a href="#__codelineno-120-27"><span class="linenos" data-linenos="27 "></span></a>c1,c2 = f1.readline() , f2.readline()
<a id="__codelineno-120-28" name="__codelineno-120-28"></a><a href="#__codelineno-120-28"><span class="linenos" data-linenos="28 "></span></a>
<a id="__codelineno-120-29" name="__codelineno-120-29"></a><a href="#__codelineno-120-29"><span class="linenos" data-linenos="29 "></span></a>ans = b&#39;&#39;
<a id="__codelineno-120-30" name="__codelineno-120-30"></a><a href="#__codelineno-120-30"><span class="linenos" data-linenos="30 "></span></a>cnt = 0
<a id="__codelineno-120-31" name="__codelineno-120-31"></a><a href="#__codelineno-120-31"><span class="linenos" data-linenos="31 "></span></a>while( len(c1) ):
<a id="__codelineno-120-32" name="__codelineno-120-32"></a><a href="#__codelineno-120-32"><span class="linenos" data-linenos="32 "></span></a>    cnt += 1
<a id="__codelineno-120-33" name="__codelineno-120-33"></a><a href="#__codelineno-120-33"><span class="linenos" data-linenos="33 "></span></a>    ans += long_to_bytes( CMA(int(N),int(e1),int(e2),int(c1),int(c2)) )
<a id="__codelineno-120-34" name="__codelineno-120-34"></a><a href="#__codelineno-120-34"><span class="linenos" data-linenos="34 "></span></a>    c1 , c2 = f1.readline() , f2.readline()
<a id="__codelineno-120-35" name="__codelineno-120-35"></a><a href="#__codelineno-120-35"><span class="linenos" data-linenos="35 "></span></a>temp = b&#39;&#39;
<a id="__codelineno-120-36" name="__codelineno-120-36"></a><a href="#__codelineno-120-36"><span class="linenos" data-linenos="36 "></span></a>M = b&#39;&#39;
<a id="__codelineno-120-37" name="__codelineno-120-37"></a><a href="#__codelineno-120-37"><span class="linenos" data-linenos="37 "></span></a>print( ans )
<a id="__codelineno-120-38" name="__codelineno-120-38"></a><a href="#__codelineno-120-38"><span class="linenos" data-linenos="38 "></span></a>for i in ans:
<a id="__codelineno-120-39" name="__codelineno-120-39"></a><a href="#__codelineno-120-39"><span class="linenos" data-linenos="39 "></span></a>    k = long_to_bytes(i)
<a id="__codelineno-120-40" name="__codelineno-120-40"></a><a href="#__codelineno-120-40"><span class="linenos" data-linenos="40 "></span></a>    if k == b&#39;\n&#39;:
<a id="__codelineno-120-41" name="__codelineno-120-41"></a><a href="#__codelineno-120-41"><span class="linenos" data-linenos="41 "></span></a>        M += base64.b64decode( temp )
<a id="__codelineno-120-42" name="__codelineno-120-42"></a><a href="#__codelineno-120-42"><span class="linenos" data-linenos="42 "></span></a>        temp = b&#39;&#39;
<a id="__codelineno-120-43" name="__codelineno-120-43"></a><a href="#__codelineno-120-43"><span class="linenos" data-linenos="43 "></span></a>        continue
<a id="__codelineno-120-44" name="__codelineno-120-44"></a><a href="#__codelineno-120-44"><span class="linenos" data-linenos="44 "></span></a>    temp += k
<a id="__codelineno-120-45" name="__codelineno-120-45"></a><a href="#__codelineno-120-45"><span class="linenos" data-linenos="45 "></span></a>print( M )
</code></pre></div>
<p>得到密文</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><a id="__codelineno-121-1" name="__codelineno-121-1"></a><a href="#__codelineno-121-1"><span class="linenos" data-linenos="1 "></span></a>THISFLAGISHIDDEN.CANYOUFINDITOUT?DOYOUKNOWBASE64?YoungCTHINKYOUARENOTTHATFAMILIARWITHBASE64.Base64isagroupofsimilarbinary-to-textencodingschemesthatrepresentbinarydatainanASCIIstringformatbytranslatingitintoaradix-64representation.ThetermBase64originatesfromaspecificMIMEcontenttransferencoding.Theparticularsetof64characterschosentorepresentthe64place-valuesforthebasevariesbetweenimplementations.Thegeneralstrategyistochoose64charactersthatarebothmembersofasubsetcommontomostencodings,andalsoprintable.Thiscombinationleavesthedataunlikelytobemodifiedintransitthroughinformationsystems,suchasE-mail,thatweretraditionallynot8-bitclean.[1]Forexample,MIME&#39;sBase64implementationusesA\xa8CZ,a\xa8Cz,and0\xa8C9forthefirst62values.Othervariationssharethispropertybutdifferinthesymbolschosenforthelasttwovalues;anexampleis
</code></pre></div>
<p>进行base64隐写解密得到</p>
<p>flag:<code>flag{7c86d8f7d6de33a87f7f9d6b005ce640}</code></p>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="最后更新">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="2025年8月2日 08:25:47 UTC">2025年8月2日</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="创建日期">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="2025年8月2日 08:25:47 UTC">2025年8月2日</span>
  </span>

    
    
    
      
  <span class="md-source-file__fact">
    
      
  <span class="md-icon" title="贡献者">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg>
  </span>
  <span>GitHub</span>

    
    <nav>
      
        <a href="https://github.com/coperlm" class="md-author" title="@coperlm">
          
          <img src="https://avatars.githubusercontent.com/u/76933810?v=4&size=72" alt="coperlm">
        </a>
      
      
      
    </nav>
  </span>

    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="02-%E7%BB%8F%E5%85%B8%E7%8E%B0%E4%BB%A3%E9%9D%9E%E5%AF%B9%E7%A7%B0%E7%AE%97%E6%B3%95.html" class="md-footer__link md-footer__link--prev" aria-label="上一页: 经典现代非对称算法">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                经典现代非对称算法
              </div>
            </div>
          </a>
        
        
          
          <a href="../../05-RE/index.html" class="md-footer__link md-footer__link--next" aria-label="下一页: REVERSE-逆向">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                REVERSE-逆向
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 - Present NISA
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["header.autohide", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.footer", "navigation.prune", "navigation.indexes", "navigation.path", "toc.follow", "navigation.sections"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="../../javascripts/katex.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>